<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>RHEL62-EAL4-Configuration-Guide</TITLE>
<META NAME="description" CONTENT="RHEL62-EAL4-Configuration-Guide">
<META NAME="keywords" CONTENT="RHEL62-EAL4-Configuration-Guide">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">


</HEAD>

<BODY >

<P>
<DIV ALIGN="CENTER">
<IMG
  WIDTH="297" HEIGHT="100" ALIGN="BOTTOM" BORDER="0"
 SRC="./redhat_logo.png"
 ALT="Image redhat_logo">
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR></DIV>
<P>
<DIV ALIGN="CENTER"><BIG CLASS="XXLARGE"><B>EAL4 Evaluated Configuration Guide for Red Hat Enterprise Linux
<BR>
<BR>
<BR></B></BIG>
<BIG CLASS="LARGE">July 6, 2012; v1.3</BIG>

</DIV>

<P>

<P>

<P>
<P>
atsec is a trademark of atsec information security GmbH

<P>
Intel and Pentium are trademarks of Intel Corporation in the United States,
other countries, or both.

<P>
Java and all Java-based products are trademarks of Sun Microsystems, Inc.,
in the United States, other countries, or both.

<P>
Linux is a registered trademark of  Linus Torvalds.

<P>
UNIX is a registered trademark of The Open Group in the United States and
other countries.

<P>
All other trademarks are property of their respective owners.

<P>
This document is provided AS IS with no express or implied warranties.  Use
the information in this document at your own risk.

<P>
This document may be reproduced or distributed in any form without prior
permission provided the copyright notice is retained on all copies.
Modified versions of this document may be freely distributed provided that
they are clearly identified as such, and this copyright is included intact.

<P>
This document is derived from the "MLS EAL4 Evaluated Configuration
Guide for Red Hat Enterprise Linux on IBM hardware" Copyright (c)
2003, 2004, 2005, 2006, 2007 by atsec GmbH, and IBM Corporation or its
wholly owned subsidiaries, and the "Common Criteria EAL4+ Evaluated
Configuration Guide for Red Hat Enterprise Linux 5 on HP Hardware"

<P>
Changes Copyright (c) 2004, 2005, 2006, 2007 by atsec corp.,
Hewlett-Packard Company or its wholly owned subsidiaries.

<P>
Changes Copyright (c) 2005, 2007, 2008 by atsec corp., and Silicon Graphics
Incorporated or its wholly owned subsidiaries.

<P>
Changes Copyright (c) 2009 by atsec corp., and DELL
Incorporated or its wholly owned subsidiaries.

<P>
Changes Copyright (c) 2011 by atsec corp., and Red Hat Incorporated
or its wholly owned subsidiaries.

<P>

<P>
<P>
<BR>

<H2><A NAME="SECTION00100000000000000000">
Contents</A>
</H2>
<!--Table of Contents-->

<UL CLASS="TofC">
<LI><A NAME="tex2html260"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00200000000000000000">1. Introduction</A>
<UL>
<LI><A NAME="tex2html261"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00210000000000000000">1.1 Purpose of this document</A>
<LI><A NAME="tex2html262"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00220000000000000000">1.2 How to use this document</A>
<LI><A NAME="tex2html263"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00230000000000000000">1.3 Requirements and assumptions</A>
<UL>
<LI><A NAME="tex2html264"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00231000000000000000">1.3.1 What is a CC compliant system?</A>
<LI><A NAME="tex2html265"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00232000000000000000">1.3.2 Hardware requirements</A>
<LI><A NAME="tex2html266"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00233000000000000000">1.3.3 Requirements for the system's environment</A>
<LI><A NAME="tex2html267"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00234000000000000000">1.3.4 Requirements for connectivity</A>
<LI><A NAME="tex2html268"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00235000000000000000">1.3.5 Requirements for procedures (MLS mode only)</A>
<LI><A NAME="tex2html269"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00236000000000000000">1.3.6 Requirements for administrators</A>
<LI><A NAME="tex2html270"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00237000000000000000">1.3.7 Requirements for the system's users</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html271"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00300000000000000000">2. Installation</A>
<UL>
<LI><A NAME="tex2html272"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00310000000000000000">2.1 Supported hardware</A>
<LI><A NAME="tex2html273"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00320000000000000000">2.2 Selection of install options and packages</A>
<UL>
<LI><A NAME="tex2html274"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00321000000000000000">2.2.1 Prerequisites for installation</A>
<LI><A NAME="tex2html275"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00322000000000000000">2.2.2 Preparing for installation</A>
<LI><A NAME="tex2html276"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00323000000000000000">2.2.3 Package selection</A>
<LI><A NAME="tex2html277"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00324000000000000000">2.2.4 FIPS 140-2</A>
<LI><A NAME="tex2html278"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00325000000000000000">2.2.5 Customizing the installation</A>
<LI><A NAME="tex2html279"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00326000000000000000">2.2.6 Kickstart</A>
<LI><A NAME="tex2html280"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00327000000000000000">2.2.7 Pre-install configuration</A>
<LI><A NAME="tex2html281"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00328000000000000000">2.2.8 Partitioning</A>
<LI><A NAME="tex2html282"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00329000000000000000">2.2.9 Hard disk encryption</A>
<LI><A NAME="tex2html283"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION003210000000000000000">2.2.10 Post-install configuration</A>
</UL>
<LI><A NAME="tex2html284"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00330000000000000000">2.3 Architecture specific manual configuration steps</A>
<UL>
<LI><A NAME="tex2html285"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00331000000000000000">2.3.1 SGI UV</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html286"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00400000000000000000">3. Secure initial system configuration</A>
<UL>
<LI><A NAME="tex2html287"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00410000000000000000">3.1 Creating additional user accounts for administrators</A>
<LI><A NAME="tex2html288"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00420000000000000000">3.2 Installing required updates</A>
<LI><A NAME="tex2html289"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00430000000000000000">3.3 Automated configuration of the system</A>
<LI><A NAME="tex2html290"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00440000000000000000">3.4 Setting up xinetd</A>
<UL>
<LI><A NAME="tex2html291"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00441000000000000000">3.4.1 xinetd in MLS mode</A>
<LI><A NAME="tex2html292"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00442000000000000000">3.4.2 xinetd in Base mode</A>
</UL>
<LI><A NAME="tex2html293"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00450000000000000000">3.5 Setting up the Cups printing system</A>
<LI><A NAME="tex2html294"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00460000000000000000">3.6 Setting up Postfix (Base mode only)</A>
<LI><A NAME="tex2html295"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00470000000000000000">3.7 Setting up Cron (MLS mode only)</A>
<LI><A NAME="tex2html296"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00480000000000000000">3.8 Configuring polyinstantiation</A>
<LI><A NAME="tex2html297"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00490000000000000000">3.9 Configuring the boot loader</A>
</UL>
<BR>
<LI><A NAME="tex2html298"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00500000000000000000">4. System operation</A>
<UL>
<LI><A NAME="tex2html299"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00510000000000000000">4.1 System startup, shutdown and crash recovery</A>
<LI><A NAME="tex2html300"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00520000000000000000">4.2 Backup and restore</A>
<LI><A NAME="tex2html301"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00530000000000000000">4.3 Gaining administrative access</A>
<UL>
<LI><A NAME="tex2html302"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00531000000000000000">4.3.1 Using su</A>
<LI><A NAME="tex2html303"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00532000000000000000">4.3.2 Using sudo</A>
<LI><A NAME="tex2html304"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00533000000000000000">4.3.3 Administrative users in MLS mode</A>
</UL>
<LI><A NAME="tex2html305"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00540000000000000000">4.4 Installation of additional software</A>
<UL>
<LI><A NAME="tex2html306"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00541000000000000000">4.4.1 Supported software architectures</A>
<LI><A NAME="tex2html307"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00542000000000000000">4.4.2 Security requirements for additional software</A>
</UL>
<LI><A NAME="tex2html308"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00550000000000000000">4.5 Scheduling processes using cron</A>
<LI><A NAME="tex2html309"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00560000000000000000">4.6 Mounting filesystems</A>
<LI><A NAME="tex2html310"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00570000000000000000">4.7 Configuration of kernel cryptographic support</A>
<LI><A NAME="tex2html311"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00580000000000000000">4.8 Encryption of partitions</A>
<LI><A NAME="tex2html312"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00590000000000000000">4.9 Managing user accounts</A>
<UL>
<LI><A NAME="tex2html313"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00591000000000000000">4.9.1 Creating users</A>
<LI><A NAME="tex2html314"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00592000000000000000">4.9.2 Changing user passwords</A>
<LI><A NAME="tex2html315"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00593000000000000000">4.9.3 SSH key-based authentication</A>
<LI><A NAME="tex2html316"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00594000000000000000">4.9.4 Changing user properties</A>
<LI><A NAME="tex2html317"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00595000000000000000">4.9.5 Locking and unlocking user accounts</A>
<LI><A NAME="tex2html318"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00596000000000000000">4.9.6 Removing users</A>
<LI><A NAME="tex2html319"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00597000000000000000">4.9.7 Defining administrative accounts</A>
<LI><A NAME="tex2html320"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00598000000000000000">4.9.8 Defining user roles and MLS levels (MLS mode only)</A>
</UL>
<LI><A NAME="tex2html321"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005100000000000000000">4.10 Using serial terminals</A>
<LI><A NAME="tex2html322"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005110000000000000000">4.11 Managing data objects</A>
<UL>
<LI><A NAME="tex2html323"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005111000000000000000">4.11.1 Revoking access</A>
<LI><A NAME="tex2html324"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005112000000000000000">4.11.2 SYSV shared memory and IPC objects</A>
<LI><A NAME="tex2html325"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005113000000000000000">4.11.3 Posix Message Queues</A>
</UL>
<LI><A NAME="tex2html326"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005120000000000000000">4.12 Configuring object access rights</A>
<LI><A NAME="tex2html327"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005130000000000000000">4.13 Setting the system time and date</A>
<LI><A NAME="tex2html328"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005140000000000000000">4.14 Firewall configuration</A>
<UL>
<LI><A NAME="tex2html329"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005141000000000000000">4.14.1 iptables auditing of packet filter operations</A>
<LI><A NAME="tex2html330"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005142000000000000000">4.14.2 ebtables auditing of packet filter operations</A>
<LI><A NAME="tex2html331"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005143000000000000000">4.14.3 KVM ARP spoofing and poisoning prevention</A>
</UL>
<LI><A NAME="tex2html332"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005150000000000000000">4.15 Screen saver configuration</A>
<LI><A NAME="tex2html333"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005160000000000000000">4.16 OpenSSH configuration</A>
<LI><A NAME="tex2html334"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005170000000000000000">4.17 SELinux configuration</A>
<UL>
<LI><A NAME="tex2html335"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005171000000000000000">4.17.1 General SELinux configuration</A>
<LI><A NAME="tex2html336"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005172000000000000000">4.17.2 MLS mode specific policy module</A>
<LI><A NAME="tex2html337"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005173000000000000000">4.17.3 Creating a custom role (MLS mode only)</A>
<LI><A NAME="tex2html338"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005174000000000000000">4.17.4 Defining hierarchical roles (MLS mode only)</A>
</UL>
<LI><A NAME="tex2html339"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005180000000000000000">4.18 Labeled networking (MLS mode only)</A>
<UL>
<LI><A NAME="tex2html340"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005181000000000000000">4.18.1 IPSec labeled networking</A>
<LI><A NAME="tex2html341"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005182000000000000000">4.18.2 CIPSO labeled networking</A>
<LI><A NAME="tex2html342"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005183000000000000000">4.18.3 xinetd configuration for labeled networking</A>
</UL>
<LI><A NAME="tex2html343"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005190000000000000000">4.19 Remote audit configuration</A>
<UL>
<LI><A NAME="tex2html344"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005191000000000000000">4.19.1 Configuration of sending audit data</A>
<LI><A NAME="tex2html345"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION005192000000000000000">4.19.2 Configuration of receiving audit data</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html346"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00600000000000000000">5. Kernel-based virtual machine (KVM) management</A>
<UL>
<LI><A NAME="tex2html347"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00610000000000000000">5.1 Hardware configuration</A>
<LI><A NAME="tex2html348"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00620000000000000000">5.2 Kernel-based Virtual Machine (KVM) configuration</A>
<UL>
<LI><A NAME="tex2html349"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00621000000000000000">5.2.1 Virtual machines started outside libvirtd</A>
<LI><A NAME="tex2html350"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00622000000000000000">5.2.2 System versus session instances of libvirtd</A>
</UL>
<LI><A NAME="tex2html351"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00630000000000000000">5.3 Separation of virtual machines</A>
<UL>
<LI><A NAME="tex2html352"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00631000000000000000">5.3.1 Unprivileged user and group IDs</A>
<LI><A NAME="tex2html353"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00632000000000000000">5.3.2 SELinux dynamic labeling</A>
<LI><A NAME="tex2html354"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00633000000000000000">5.3.3 SELinux static labeling</A>
</UL>
<LI><A NAME="tex2html355"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00640000000000000000">5.4 Networking considerations</A>
<UL>
<LI><A NAME="tex2html356"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00641000000000000000">5.4.1 Packet filtering</A>
</UL>
<LI><A NAME="tex2html357"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00650000000000000000">5.5 Device assignment</A>
<UL>
<LI><A NAME="tex2html358"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00651000000000000000">5.5.1 PCI device assignment</A>
<LI><A NAME="tex2html359"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00652000000000000000">5.5.2 USB device assignment</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html360"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00700000000000000000">6. Monitoring, Logging &amp; Audit</A>
<UL>
<LI><A NAME="tex2html361"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00710000000000000000">6.1 Reviewing the system configuration</A>
<LI><A NAME="tex2html362"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00720000000000000000">6.2 System logging and accounting</A>
<LI><A NAME="tex2html363"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00730000000000000000">6.3 Configuring the audit subsystem</A>
<UL>
<LI><A NAME="tex2html364"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00731000000000000000">6.3.1 Intended usage of the audit subsystem</A>
<LI><A NAME="tex2html365"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00732000000000000000">6.3.2 Selecting the events to be audited</A>
<LI><A NAME="tex2html366"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00733000000000000000">6.3.3 Reading and searching the audit records</A>
<LI><A NAME="tex2html367"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00734000000000000000">6.3.4 Starting and stopping the audit subsystem</A>
<LI><A NAME="tex2html368"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00735000000000000000">6.3.5 Storage of audit records</A>
<LI><A NAME="tex2html369"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00736000000000000000">6.3.6 Reliability of audit data</A>
</UL>
<LI><A NAME="tex2html370"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00740000000000000000">6.4 System configuration variables in /etc/sysconfig</A>
</UL>
<BR>
<LI><A NAME="tex2html371"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00800000000000000000">7. Security guidelines for users</A>
<UL>
<LI><A NAME="tex2html372"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00810000000000000000">7.1 System Documentation</A>
<LI><A NAME="tex2html373"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00820000000000000000">7.2 Authentication</A>
<LI><A NAME="tex2html374"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00830000000000000000">7.3 Password policy</A>
<LI><A NAME="tex2html375"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00840000000000000000">7.4 SSH key-based authentication</A>
<LI><A NAME="tex2html376"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00850000000000000000">7.5 Access control for files and directories</A>
<UL>
<LI><A NAME="tex2html377"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00851000000000000000">7.5.1 Discretionary Access Control</A>
<LI><A NAME="tex2html378"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00852000000000000000">7.5.2 Multilevel mandatory access control (MLS mode only)</A>
<LI><A NAME="tex2html379"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00853000000000000000">7.5.3 Role-based access control (MLS mode only)</A>
<LI><A NAME="tex2html380"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00854000000000000000">7.5.4 General access control</A>
</UL>
<LI><A NAME="tex2html381"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00860000000000000000">7.6 Data import / export</A>
<LI><A NAME="tex2html382"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00870000000000000000">7.7 Screen saver</A>
<LI><A NAME="tex2html383"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00880000000000000000">7.8 Buffer overflow hardening</A>
<UL>
<LI><A NAME="tex2html384"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00881000000000000000">7.8.1 Full RELRO/PIE</A>
<LI><A NAME="tex2html385"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00882000000000000000">7.8.2 Partial RELRO/PIE</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html386"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00900000000000000000">8. Appendix</A>
<UL>
<LI><A NAME="tex2html387"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00910000000000000000">8.1 Online Documentation</A>
<LI><A NAME="tex2html388"
  HREF="RHEL62-EAL4-Configuration-Guide.html#SECTION00920000000000000000">8.2 Literature</A>
</UL></UL>
<!--End of Table of Contents-->
<P>
<P>

<P>

<P>

<H1><A NAME="SECTION00200000000000000000"></A><A NAME="Introduction"></A><A NAME="22"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>. Introduction
</H1>

<H1><A NAME="SECTION00210000000000000000"></A><A NAME="Purpose_of_this_document"></A><A NAME="24"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">1</SPAN> Purpose of this document
</H1>

<P>
The Red Hat Enterprise Linux (RHEL) distribution is designed to provide
a secure and reliable operating system for a variety of purposes. Because
security requirements obviously depend on the applications and environment,
it is not possible to simply certify that the system is "secure", a more
precise definition is needed.

<P>
The Common Criteria (CC) provides a widely recognized methodology for
security certifications. A CC evaluation is fundamentally a two-step
process, consisting of defining the "security target" which describes the
features that are to be evaluated, and then testing and verifying that the
system actually implements these features with a sufficient level of
assurance.

<P>
This document is a security guide that explains how to set up the evaluated
configuration, and provides information to administrators and ordinary users
to ensure secure operation of the system. It is intended to be
self-contained in addressing the most important issues at a high level, and
refers to other existing documentation where more details are needed.

<P>
The document primarily addresses administrators, but the section
"Security guidelines for users" is intended for ordinary users of the
system as well as administrators.

<P>
Knowledge of the Common Criteria is not required for readers of this
document.

<P>

<H1><A NAME="SECTION00220000000000000000"></A><A NAME="How_to_use_this_document"></A><A NAME="26"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">2</SPAN> How to use this document
</H1>

<P>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119
(http://www.ietf.org/rfc/rfc2119.txt)

<P>
Note that this document avoids the terms "SHOULD" and "SHOULD NOT"
that are defined in RFC 2119.  Requirements are either absolute (and
marked with MUST and equivalent terms), or entirely optional (in the
sense of not affecting required security functions) and marked with
RECOMMENDED, MAY or OPTIONAL.

<P>
If you follow the requirements in this document when setting up and
using the system, your configuration will match the evaluated
configuration.  Certain configuration options are marked as OPTIONAL
and you MAY modify them as needed, but you MUST NOT make other
changes, because they will make the system fail to match the evaluated
configuration.

<P>
Of course, you MUST always use common sense. This document is not a formal
specification, and legitimate reasons can exist to modify the system setup
in ways not described here if that is necessary for the system to fulfill
its intended purpose. Specifically, applying security patches released by
the vendor is strongly RECOMMENDED even though that will cause a deviation
from the evaluated configuration.

<P>
In cases where the requirements and recommendations in this document
conflict with those in other sources (such as the online
documentation), the information in this Configuration Guide has higher
precedence. You MUST follow the steps described here to reach the
evaluated configuration, even if other documentation describes
different methods.

<P>
The evaluated configuration may be set up in two separate ways:

<P>

<UL>
<LI><P>
In <SPAN  CLASS="textbf">Base mode</SPAN>, the system supports the usual discretionary access
control features and a single "root" administrative account.

<P>
</LI>
<LI><P>
In <SPAN  CLASS="textbf">MLS mode</SPAN>, mandatory access control and role-based access
control based on the SELinux MLS policy add restrictions to
the discretionary access control.

<P>
</LI>
</UL>

<P>
The information in this guide generally applies to both modes except
where it specifically refers to "MLS mode" or "Base mode".  All
references to roles (other than "root") or multilevel security (MLS)
always apply only to MLS mode.

<P>
The usual convention is used in this guide when referring to manual
pages that are included in the software distribution. For example, the
notation <SPAN  CLASS="textit">ls</SPAN>(1) means that running the <TT>man -S 1 ls</TT> command will
display the manual page for the <SPAN  CLASS="textit">ls</SPAN> command from section one of the
installed documentation. In most cases, the <TT>-S</TT> flag and the section
number can be omitted from the command, they are only needed if pages
with the same name exist in different sections,

<P>

<H1><A NAME="SECTION00230000000000000000"></A><A NAME="Requirements_and_assumptions"></A><A NAME="36"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN> Requirements and assumptions
</H1>

<H2><A NAME="SECTION00231000000000000000"></A><A NAME="What_is_a_CC_compliant_system_"></A><A NAME="38"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">1</SPAN> What is a CC compliant system?
</H2>

<P>
A system can be considered to be "CC compliant" if it matches an evaluated
and certified configuration. This implies various requirements concerning
hardware and software, as well as requirements concerning the operating
environment, users, and the ongoing operating procedures.

<P>
Strictly speaking, an evaluation according to the CC represents the results
of investigation of the security properties of the target system according
to defined guidelines. It should not be considered as a guarantee for
fitness for any specific purpose, but should provide help in deciding the
suitability of the system considering how well the intended use fits the
described capabilities. It is intended to provide a level of assurance about the
security functions that have been examined by a neutral third party.

<P>
The software MUST match the evaluated configuration. In the case of an
operating system, this also requires that the installed kernel,
system, and application software are the same. The documentation
(including this guide) will specify permitted variations, such as
modifying certain configuration files and settings, and installing
software that does not have the capability to affect the security of
the system (typically those that do not require root
privileges). Please refer to section &#167;<A HREF="#Installation_of_additional_software">4.4</A> "Installation of additional software" of this guide for
more information.

<P>
Stated requirements concerning the operating environment MUST be met.
Typical requirements include a secure location for the hardware (protected
from physical access by unauthorized persons), as well as restrictions
concerning permitted network connections.

<P>
The operation of the system MUST be in agreement with defined organizational
security policies, to ensure that actions by administrators and users do not
undermine the system's security.

<P>

<H2><A NAME="SECTION00232000000000000000"></A><A NAME="Hardware_requirements"></A><A NAME="41"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">2</SPAN> Hardware requirements
</H2>

<P>
The hardware MUST be one of the following hardware systems. This entire
document applies to all hardware systems unless explicitly noted.

<P>
The term "virtualization support" applies to the use of KVM and the support
of guest systems on the respective platform.

<P>
<DL>
<DT><STRONG>RHEL with virtualization support</STRONG></DT>
<DD><DL>
<DT><STRONG>IBM based on x86 64bit Intel Xeon processors</STRONG></DT>
<DD>
<UL>
<LI><P>
IBM System x: x3400 M2, x3400 M3, x3500 M2, x3500 M3, x3550 M2, x3550 M3, x3620 M3, x3630 M3, x3650 M2, x3650 M3

<P>
</LI>
<LI><P>
IBM BladeCenter: HS22 and HS22V

<P>
</LI>
<LI><P>
IBM iDataPlex: dx360 M2, dx360 M3

<P>
</LI>
<LI><P>
IBM X5 systems: x3850 X5, x3950 X5, x3690 X5

<P>
</LI>
</UL>
</DD>
</DL>
<DL>
<DT><STRONG>HP based on x86 64bit Intel Xeon processors</STRONG></DT>
<DD>
<UL>
<LI><P>
HP Proliant ML 100 and 300 series G6 product line

<P>
</LI>
<LI><P>
HP Proliant DL 100 series G6, 300 series G6 and G7, 500 series G7, 900 series G7 product line

<P>
</LI>
<LI><P>
HP ProLiant BL 200 series G6 and G7, 400 series G6 and G7, 600 series G5, 600 series G7 product line

<P>
</LI>
<LI><P>
HP ProLiant SL 100 series G6 product line

<P>
</LI>
</UL>
</DD>
</DL>
<DL>
<DT><STRONG>HP based on AMD Opteron processors</STRONG></DT>
<DD>
<UL>
<LI><P>
HP Proliant DL 100 series G7, 500 series G7, 700 series G6 product line

<P>
</LI>
<LI><P>
HP Proliant DL 385 G7

<P>
</LI>
<LI><P>
HP ProLiant BL 600 series G6 product line

<P>
</LI>
<LI><P>
HP ProLiant SL 100 series G7 product line

<P>
</LI>
</UL>
</DD>
</DL>
<DL>
<DT><STRONG>SGI UV</STRONG></DT>
<DD>
<UL>
<LI><P>
SGI UV 1000

<P>
</LI>
</UL>
</DD>
</DL>
<DL>
<DT><STRONG>Dell based on x86 64bit Intel processors</STRONG></DT>
<DD>
<UL>
<LI><P>
Dell PowerEdge R720, R620, R820, R520, R320, R420

<P>
</LI>
<LI><P>
Dell PowerEdge T620, T420, T320

<P>
</LI>
<LI><P>
Dell PowerEdge M620, M520, M420, M820

<P>
</LI>
</UL>
</DD>
</DL>

<P>
</DD>
<DT><STRONG>RHEL except virtualization support</STRONG></DT>
<DD>
<UL>
<LI><P>
All machines listed for "RHEL with virtualization support"

<P>
</LI>
<LI><P>
IBM System p based on Power 7 processors

<P>
</LI>
<LI><P>
IBM System z based on z/Architecture processors

<P>
</LI>
</UL>
</DD>
</DL>

<P>
These systems must be installed with the 64-bit version of RHEL 6.2.

<P>
Running the certified software on other similar hardware might result in an
equivalent security level, but the certification does not apply if the
hardware is different from that used for the testing processes during the
evaluation.

<P>
Note, the proper operation of all aspects of the software is only ensured
when using the aforementioned hardware systems as several hardware mechanisms
which may not be present in other systems are vital for the security of
the system.

<P>
Please refer to section &#167;<A HREF="#Supported_hardware">2.1</A> "Supported hardware"
for more information about additional hardware supported for use with
the evaluated configuration.

<P>

<H2><A NAME="SECTION00233000000000000000"></A><A NAME="Requirements_for_the_system_s_environment"></A><A NAME="82"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">3</SPAN> Requirements for the system's environment
</H2>

<P>
The security target covers one or more systems running RHEL, networked in a
non-hostile network, with a well-managed and non-hostile user community. It
is not intended to address the needs of an Internet-connected server, or the
case where services are to be provided to potentially hostile users.

<P>
It is assumed that the value of the stored assets merits moderately
intensive penetration or masquerading attacks. It is also assumed that
physical controls in place would alert the system authorities to the
physical presence of attackers within the controlled space.

<P>
You MUST set up the server (or servers) in a physically secure environment,
where they are protected from theft and manipulation by unauthorized
persons.

<P>
You MUST ensure that all connections to peripheral devices and all
network connections are protected against tampering, tapping and other
modifications. Using the secured protocol of SSHv2 is
considered sufficient protection for network connections. All other
connections must remain completely within the physically secure server
environment.

<P>
When using CIPSO-based labeled networking (configured with the
<SPAN  CLASS="textit">netlabel</SPAN> application) in MLS mode, all network connections
need to reside within the controlled access facilities because the
secured protocol of SSHv2 does not protect the label
information. Internal communication paths to access points such as
terminals or other systems are assumed to be adequately protected.

<P>

<H2><A NAME="SECTION00234000000000000000"></A><A NAME="Requirements_for_connectivity"></A><A NAME="85"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">4</SPAN> Requirements for connectivity
</H2>

<P>
All components in the network such as routers, switches, and hubs that
are used for communication are assumed to pass the user data reliably
and without modification. Translations on protocols elements
(such as NAT) are allowed as long as those modifications do not lead to a
situation where information is routed to somebody other than the
intended recipient system. Network and peripheral cabling must be
approved for the transmittal of the most sensitive data held by the system.

<P>
Any other systems with which the system communicates MUST be
under the same management control and operate under the same security
policy constraints. When operating in MLS mode, any data exported from
the TOE to another system either with its sensitivity label or without
the sensitivity label (over a single level connection) MUST
be handled in accordance with its sensitivity label on any system that
imports this data.

<P>
Be aware that information passed to another system leaves the control
of the sending system, and the protection of this information against
unauthorized access needs to be enforced by the receiving system. If
an organization wants to implement a consistent security policy
covering multiple systems on a network, organizational procedures MUST
ensure that all those systems can be trusted and are configured with
compatible security configurations enforcing an organization wide
security policy. How to do this is beyond the scope of this
Configuration Guide. If you set up a communication link to a system
outside your control, please keep in mind that you will not be able to
enforce any security policy for any information you pass to such a
system over the communication link or in other ways (for example, by
using removable storage media). In MLS mode, the system supports
labeled networking which can help ensure consistent handling of data
labels across network connections. You MUST nevertheless ensure that
all systems and networks involved are configured securely.

<P>
Please be also aware that when configuring KVM guest system,
KVM allows physical network adapters to be shared among different
guest systems. The sharing is based on IP addresses where KVM assigns
a unique IP address to each guest. You should consider the configuration
of shared network adapters akin to the use of physical switches in your
network. If you want to achieve a stronger separation between the
virtual machines, each guest domain should be assigned a dedicated
physical network interface.

<P>

<H2><A NAME="SECTION00235000000000000000"></A><A NAME="Requirements_for_procedures_MLS_mode_only_"></A><A NAME="87"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">5</SPAN> Requirements for procedures (MLS mode only)
</H2>

<P>
Procedures MUST exist for granting users authorization for access to
specific security levels.

<P>
Procedures MUST exist for establishing the security level of all
information imported into the system, for establishing the security
level for all peripheral devices (e.g., printers, tape drives, disk
drives) attached to the system, and marking a sensitivity label on all
output generated.

<P>

<H2><A NAME="SECTION00236000000000000000"></A><A NAME="Requirements_for_administrators"></A><A NAME="89"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">6</SPAN> Requirements for administrators
</H2>

<P>
There MUST be one or more competent individuals who are assigned to
manage the system and the security of the information it
contains. These individuals will have sole responsibility for the
following functions: (a) create and maintain roles (b) establish and
maintain relationships among roles (c) Assignment and Revocation of
users to roles. In addition these individuals (as owners of the entire
corporate data), along with object owners will have the ability to
assign and revoke object access rights to roles.

<P>
The system administrative personnel MUST NOT be careless, willfully
negligent, or hostile, and MUST follow and abide by the instructions
provided by the administrator documentation.

<P>
In Base mode, every person that has the ability to perform
administrative actions by switching to root has full control over the
system and could, either by accident or deliberately, undermine
security features of the system and bring it into an insecure
state. In MLS mode, the system can restrict actions of root users,
but it is still REQUIRED that everyone with administrative access to
the system must be a trusted administrator. This Configuration Guide
provides the basic guidance how to set up and operate the system
securely, but is not intended to be the sole information required for
a system administrator to learn how to operate Linux securely.

<P>
It is assumed, within this Configuration Guide, that administrators who
use this guide have a good knowledge and understanding of operating
security principles in general and of Linux administrative commands
and configuration options in particular. We strongly advise that an
organization that wants to operate the system in the evaluated
configuration nevertheless have their administrators trained in
operating system security principles and RHEL security functions,
properties, and configuration.

<P>
Every organization needs to trust their system administrators not to
deliberately undermine the security of the system. Although the
evaluated configuration includes audit functions that can be used to
make users accountable for their actions, an administrator is able to
stop the audit subsystem and reconfigure it such that his actions no
longer get audited. Well trained and trustworthy administrators are a
key element for the secure operation of the system. This Configuration
Guide provides the additional information a system administrator
should obey when installing, configuring and operating the system in
compliance with the requirements defined in the Security Target for the
Common Criteria evaluation.

<P>
The above stated assumptions imply that the DAC and SELinux (if in MLS mode)
permissions of system directories, system binary files and their configuration 
files are left unchanged. Among others, this ensures that only administrators
can add new trusted software into the installation.

<P>
To ensure the integrity of the system, you MUST schedule periodical reviews
of the system operation and system integrity. For example, an
integrity verification using the <TT>rpm</TT> tool may be invoked. Another
possibility of validating the integrity of the system is the use of
<TT>aide</TT>.

<P>
The administrator MUST NOT read the contents
of the file holding the seed information in <SPAN  CLASS="textit">/var/lib/random-seed</SPAN>. This
ensures that if an administrator is relieved from his duties and
therefore the trust relationship is lifted, the administrator is not
able to obtain or apply (partial) knowledge of the state of <SPAN  CLASS="textit">/dev/random</SPAN> or
<SPAN  CLASS="textit">/dev/urandom</SPAN>.

<P>

<H2><A NAME="SECTION00237000000000000000"></A><A NAME="Requirements_for_the_system_s_users"></A><A NAME="96"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">7</SPAN> Requirements for the system's users
</H2>

<P>
The security target addresses the security needs of cooperating users in a
benign environment, who will use the system responsibly to fulfill their
tasks.

<P>
Authorized users possess the necessary authorization to access at
least some of the information managed by the system and are expected
to act in a cooperating manner in a benign environment.

<P>
Note that system availability is <SPAN  CLASS="textit">not</SPAN> addressed in this evaluation, and a
malicious user could disable a server through resource exhaustion or similar
methods.

<P>
The requirements for users specifically include:

<P>

<UL>
<LI><P>
User accounts MUST be assigned only to those users with a need to access the
data protected by the system, and who MUST be sufficiently trustworthy not to
abuse those privileges. For example, the system cannot prevent data from being
intentionally redistributed to unauthorized third parties by an authorized
user.

<P>
</LI>
<LI><P>
Rights for users to gain access and perform operations on information
are based on their membership in one or more roles. These roles are
granted to the users by the administrator. These roles MUST accurately
reflect the users job function, responsibilities, qualifications,
and/or competencies within the enterprise.

<P>
</LI>
<LI><P>
A limited set of users is given the rights to create new data
objects and they become owners for those data objects. The
organization is the owner of the rest of the information under the
control of system.

<P>
</LI>
<LI><P>
Users are trusted to accomplish some task or group of tasks within a
secure IT environment by exercising complete control over their data.

<P>
</LI>
<LI><P>
All users of the system MUST be sufficiently skilled to understand the
security implications of their actions, and MUST understand and follow
the requirements listed in section &#167;<A HREF="#Security_guidelines_for_users">7</A> "Security guidelines for users" of this guide. Appropriate
training MUST be available to ensure this.

<P>
</LI>
</UL>

<P>
It is part of your responsibility as a system administrator to verify that
these requirements are met, and to be available to users if they need your
help in maintaining the security of their data.

<P>

<H1><A NAME="SECTION00300000000000000000"></A><A NAME="Installation"></A><A NAME="102"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>. Installation
</H1>

<P>
The evaluation covers a fresh installation of RHEL Version 6.2 Server,
on one of the supported hardware platforms as defined in
section &#167;<A HREF="#Hardware_requirements">1.3.2</A> "Hardware requirements" of this
guide.

<P>
The evaluated configuration MUST be the only
operating system installed on the server.

<P>

<H1><A NAME="SECTION00310000000000000000"></A><A NAME="Supported_hardware"></A><A NAME="105"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Supported hardware
</H1>

<P>
You MAY attach the following peripherals without invalidating the evaluation
results. Other hardware MUST NOT be installed in or attached to the system.

<P>

<UL>
<LI><P>
Any storage devices and backup devices supported by the operating system
(this includes hard disks, CD-ROM drives, floppy disk drives and tape drives).

<P>
</LI>
<LI><P>
All Ethernet network adapters supported by the operating
system. Modems, ISDN and other WAN adapters are not part of the evaluated
environment.

<P>
</LI>
<LI><P>
PCL 4 or PostScript level 1 compatible printers attached to the system
using a parallel port or USB connection. In Base mode only, you MAY
also use a network printer. Please refer to section &#167;<A HREF="#Setting_up_the_Cups_printing_system">3.5</A> "Setting up the Cups printing system" of this
guide for more information about printing.

<P>
</LI>
<LI><P>
Operator console consisting of a keyboard, video monitor, and
optionally mouse. Additionally, you MAY directly attach supported
serial terminals (see section &#167;<A HREF="#Using_serial_terminals">4.10</A> "Using
serial terminals" of this guide), but <SPAN  CLASS="textit">not</SPAN> modems, ISDN cards, or
other remote access terminals.

<P>
</LI>
</UL>

<P>
USB keyboards and mice MAY be attached.
If a USB keyboard or mouse is used, it MUST be connected
before booting the operating system, and NOT added later to a running
system. Other hot-pluggable hardware that depends on the dynamic
loading of kernel modules MUST NOT be attached. Examples of such
unsupported hardware are USB and IEEE1394/FireWire peripherals other
than mice and keyboards.

<P>

<H1><A NAME="SECTION00320000000000000000"></A><A NAME="Selection_of_install_options_and_packages"></A><A NAME="112"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN> Selection of install options and packages
</H1>

<P>
This section describes the detailed steps to be performed when installing the
RHEL operating system on the target server.

<P>
All settings listed here are REQUIRED unless specifically declared
otherwise.

<P>

<H2><A NAME="SECTION00321000000000000000"></A><A NAME="Prerequisites_for_installation"></A><A NAME="114"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Prerequisites for installation
</H2>

<P>
You will need the following components to install a system in the
evaluated configuration as explained in the following sections:

<P>

<UL>
<LI><P>
The target system that will be installed, refer to section &#167;<A HREF="#Hardware_requirements">1.3.2</A> "Hardware requirements" of this guide for the list of
supported hardware. The target system REQUIRES at least one local hard
drive that will be erased and repartitioned for use by the evaluated
configuration.

<P>
</LI>
<LI><P>
A static IP address if you are intending to attach the target system
to a network; the evaluated configuration does not support DHCP. In
addition, you will need to configure the netmask, gateway, and DNS
server list manually.

<P>
</LI>
<LI><P>
An Internet-connected system equipped with the <SPAN  CLASS="textit">rpm</SPAN> and <SPAN  CLASS="textit">rpm2cpio</SPAN>
package management tools. This system does not need to be in the
evaluated configuration, and no packages will be installed
on it. It is used to download and verify the installation packages.

<P>
</LI>
<LI><P>
A method to transfer the kickstart installation configuration and RPM
packages to the target system. You can use any <SPAN  CLASS="textit">one</SPAN> of the following
choices:

<P>

<UL>
<LI><P>
A CD-R containing the installation files.

<P>
</LI>
<LI><P>
A USB memory stick or USB external hard drive
formatted using either the <SPAN  CLASS="textit">vfat</SPAN> or <SPAN  CLASS="textit">ext2</SPAN> file system.

<P>
</LI>
<LI><P>
A network server configured to provide the installation files via the
HTTP or NFS protocol.

<P>
</LI>
</UL>

<P>
Note that a floppy disk drive is not suitable due to insufficient
capacity.

<P>
</LI>
</UL>
<H2><A NAME="SECTION00322000000000000000"></A><A NAME="Preparing_for_installation"></A><A NAME="126"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN> Preparing for installation
</H2>

<P>
You MUST download the distribution ISO images from the Red Hat
Network on a separate Internet-connected computer, and either burn
CD-Rs from them, or make the contents available on a file server via
NFS or HTTP. The download location
<SPAN  CLASS="textit">https://access.redhat.com/downloads/</SPAN>
contains links to the platform-specific images.

<P>
You MUST use <SPAN  CLASS="textbf">Red Hat Enterprise Linux 6.2</SPAN> <SPAN  CLASS="textbf">Server</SPAN>. Make sure that
you are using the appropriate version for your platform, refer to
section &#167;<A HREF="#Hardware_requirements">1.3.2</A> "Hardware requirements" of this
guide for the list of supported hardware and the corresponding version
needed.

<P>
You MUST verify that the SHA256 checksums of the image files are
correct. The checksums are shown on the RHN web page, please verify
that the web page is encrypted (https:// URL) and has a valid
certificate. Then run <TT>sha256sum *.iso</TT> to view the checksums for the
downloaded images, and compare them with those shown on the web page.

<P>
You MUST download several additional packages not included in the .iso
images to set up the evaluated configuration. The packages are
available at the Red Hat Network search location
<SPAN  CLASS="textit">https://rhn.redhat.com/rhn/channels/software/Search.do</SPAN>.

<P>
You MUST use the search mechanism to obtain the following packages:

<P>
<DL>
<DT><STRONG>Common Criteria RPM</STRONG></DT>
<DD>
<UL>
<LI><P>
cc-eal4-config-rhel62

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHSA-2012:0124</STRONG></DT>
<DD>
<UL>
<LI><P>
kernel 2.6.32-220.4.2.el6

<P>
</LI>
<LI><P>
kernel-firmware 2.6.32-220.4.2.el6

<P>
</LI>
<LI><P>
kernel-headers 2.6.32-220.4.2.el6

<P>
</LI>
<LI><P>
kernel-devel 2.6.32-220.4.2.el6

<P>
</LI>
<LI><P>
kernel-bootwrapper 2.6.32-220.4.2.el6 (PPC64 only)

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0342</STRONG></DT>
<DD>
<UL>
<LI><P>
libvirt 0.9.4-23.el6_2.6 (x86_64 only)

<P>
</LI>
<LI><P>
libvirt-python 0.9.4-23.el6_2.6 (x86_64 only)

<P>
</LI>
<LI><P>
libvirt-client 0.9.4-23.el6_2.6 (x86_64 only)

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0338</STRONG></DT>
<DD>
<UL>
<LI><P>
selinux-policy 3.7.19-126.el6_2.9

<P>
</LI>
<LI><P>
selinux-policy-mls 3.7.19-126.el6_2.9

<P>
</LI>
<LI><P>
selinux-policy-targeted 3.7.19-126.el6_2.9

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHEA-2012:0065</STRONG></DT>
<DD>
<UL>
<LI><P>
openssh-clients 5.3p1-70.el6_2.2

<P>
</LI>
<LI><P>
openssh-server 5.3p1-70.el6_2.2

<P>
</LI>
<LI><P>
openssh 5.3p1-70.el6_2.2

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0134</STRONG></DT>
<DD>
<UL>
<LI><P>
policycoreutils 2.0.83-19.21.el6_2

<P>
</LI>
<LI><P>
policycoreutils-newrole 2.0.83-19.21.el6_2

<P>
</LI>
<LI><P>
policycoreutils-python 2.0.83-19.21.el6_2

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0331</STRONG></DT>
<DD>
<UL>
<LI><P>
dracut 004-256.el6_2.1

<P>
</LI>
<LI><P>
dracut-fips 004-256.el6_2.1

<P>
</LI>
<LI><P>
dracut-kernel 004-256.el6_2.1

<P>
</LI>
<LI><P>
dracut-fips-aesni 004-256.el6_2.1 (This RPM is only relevant if you want to
use the FIPS 140-2 approved mode <SPAN  CLASS="textbf">and</SPAN> your Intel x86 processor provides the
AES-NI instruction set - see the FIPS 140-2 security policy for the kernel
crypto API for more details. <SPAN  CLASS="textbf">WARNING:</SPAN> You MUST NOT install this package
if your CPU does not provide the AES-NI instruction set as the kernel would
crash during boot.)

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHSA-2012:0050</STRONG></DT>
<DD>
<UL>
<LI><P>
qemu-img 0.12.1.2-2.209.el6_2.4 (x86_64 only)

<P>
</LI>
<LI><P>
qemu-kvm 0.12.1.2-2.209.el6_2.4 (x86_64 only)

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0339</STRONG></DT>
<DD>
<UL>
<LI><P>
openswan 2.6.32-10.el6_2

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0337</STRONG></DT>
<DD>
<UL>
<LI><P>
nss-util 3.13.1-3.el6_2

<P>
</LI>
<LI><P>
nspr 4.8.9-3.el6_2

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0344</STRONG></DT>
<DD>
<UL>
<LI><P>
nss 3.13.1-7.el6_2

<P>
</LI>
<LI><P>
nss-sysinit 3.13.1-7.el6_2

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHBA-2012:0360</STRONG></DT>
<DD>
<UL>
<LI><P>
openssl 1.0.0-20.el6_2.2 (the automated installation requires that both word
sizes, i.e. 32 bit and 64 bit, are installed)

<P>
</LI>
<LI><P>
openssl-devel 1.0.0-20.el6_2.2 (the automated installation requires that both word
sizes, i.e. 32 bit and 64 bit, are installed)

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>RHEA-2012:0486</STRONG></DT>
<DD>
<UL>
<LI><P>
libgcrypt 1.4.5-9.el6_2.2 (the automated installation requires that both word
sizes, i.e. 32 bit and 64 bit, are installed)

<P>
</LI>
</UL>
</DD>
</DL>

<P>
The installation script will prompt for the specific files and version
numbers required. Alternatively, search for the variable RPMS_NEEDED
in the kickstart file to see the full list of needed packages.

<P>
The files needed are the <SPAN  CLASS="textit">cc-eal4-config-rhel62</SPAN> RPM, the unpacked
kickstart file (contained within the <SPAN  CLASS="textit">cc-eal4-config-rhel62</SPAN> RPM), and
a specific set of RPM packages containing post-RHEL6.2 updates.

<P>
Download the RPMs using a separate Internet-connected computer. Do
NOT install the downloaded packages yet.

<P>
You MUST have the Red Hat package signing key available to verify the
integrity of the additional RPM packages. It is available at the
following location:

<P>
<PRE>
        https://www.redhat.com/security/650d5882.txt
</PRE>

<P>
On the download system, run the following commands to verify the
package integrity:

<P>
<PRE>
        rpm --import 650d5882.txt
        rpm --checksig cc-eal4-config-rhel62-*.rpm
</PRE>

<P>
This MUST display the status "gpg OK". If it does not, you MUST NOT
proceed with the installation using that file.

<P>
The web page <SPAN  CLASS="textit">https://www.redhat.com/security/team/key/</SPAN> provides
additional information about the usage of package signing keys.

<P>
Next, on the download system, unpack the contents of the
<SPAN  CLASS="textit">cc-eal4-config-rhel62</SPAN> RPM into a temporary directory:

<P>
<PRE>
        mkdir cc-inst
        cd cc-inst
        rpm2cpio ../cc-eal4-config-rhel62-*.rpm | cpio -id
</PRE>

<P>
This will create the following directory structure in the current working directory:

<P>
<PRE>
        # this guide, and supporting documentation
        ./usr/share/doc/cc-eal4-config-rhel62-*/
                GPL.txt
                RHEL62-EAL4-Configuration-Guide.*
</PRE>
<PRE>
        # the kickstart configuration used to automate the installation
        ./usr/share/cc/kickstart/
                ks-x86_64.cfg           # Xeon, AMD Opteron systems
                ks-ppc64.cfg            # IBM Power systems
                ks-s390x.cfg            # IBM System z
                ks-x86_64+SGI.cfg       # SGI x86 system
</PRE>
<PRE>
        # the evaluated configuration reconfiguration script
</PRE>
<PRE>
        ./usr/sbin/
                cc-config
</PRE>
<PRE>
        # configuration files used for the evaluated configuration
        ./usr/share/cc/
                auditd.conf             
                [...]
                xinetd.conf
</PRE>

<P>
Depending on the installation method you choose, do <SPAN  CLASS="textit">one</SPAN> of the following
steps:

<P>

<UL>
<LI><P>
Burn a CD-R containing the kickstart files from
<SPAN  CLASS="textit">./usr/share/cc/kickstart/</SPAN> and the downloaded RPM package(s), with all
files at the top directory level (no subdirectories).

<P>
</LI>
<LI><P>
Copy the kickstart files from <SPAN  CLASS="textit">./usr/share/cc/kickstart/</SPAN> and the
downloaded RPM packages onto a USB memory stick or USB external hard
drive (formatted using either the <SPAN  CLASS="textit">vfat</SPAN> or <SPAN  CLASS="textit">ext2</SPAN> file system).
Put the files at the top directory level (no subdirectories).

<P>
</LI>
<LI><P>
Configure a network server to provide the installation files via the
HTTP or NFS protocol. Put the downloaded RPM package(s) and the
kickstart files from <SPAN  CLASS="textit">./usr/share/cc/kickstart/</SPAN> into a single
directory with no subdirectories.

<P>
</LI>
</UL>
<H2><A NAME="SECTION00323000000000000000"></A><A NAME="Package_selection"></A><A NAME="218"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">3</SPAN> Package selection
</H2>

<P>
The kickstart configuration files contain the package listing which defines
the set of packages applied during the initial installation. That package
listing consists of a number of mandatory as well as optional packages.

<P>
The modification of the package list gives you more freedom to limit the
set of installed packages. You MAY disregard the package listing as the
default set delivered with the kickstart configuration files installs
all packages necessary to cover all functional aspects defined in the
Security Target.

<P>
If you want to modify the package listing, edit the kickstart configuration
file and search for the package listing identified by the string
<SPAN  CLASS="textit">Package listing</SPAN>.

<P>
Before starting the package listing, the kickstart configuration file explains
how to read that listing. It defines different categories of package sets.
You MAY remove packages out of the package list based on the definition
of the categories and the operational mode intended for the newly installed
system.

<P>

<H2><A NAME="SECTION00324000000000000000"></A><A NAME="FIPS_140-2"></A><A NAME="221"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">4</SPAN> FIPS 140-2
</H2>

<P>
RHEL provides a central flag to switch various cryptographic libraries as well
as cryptographic applications into FIPS 140-2 compliant mode. Although the
FIPS 140-2 mode is out of scope for a Common Criteria evaluation, both
modes work well together.

<P>
If you are not concerned with the FIPS 140-2 compliant operation of
cryptographic mechanisms, you MAY skip this section.

<P>
The Security Policy documents of the various FIPS 140-2 modules delivered
with RHEL can be obtained at the NIST web page at
<SPAN  CLASS="textsf">http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140val-all.htm</SPAN>. These
documents provide the guidance for bringing the respective module into the
FIPS 140-2 compliant mode. All Security Policy modules document how
to achieve that mode by configuring RHEL at runtime.

<P>
However, RHEL allows the set up of the following FIPS 140-2 modules including
the generation of cryptographic keys during the initial installation phase
which is not covered in the Security Policy documents:

<P>

<UL>
<LI><P>
OpenSSH sshd server

<P>
</LI>
<LI><P>
dm-crypt partition encryption mechanism

<P>
</LI>
</UL>

<P>
To ensure that the keys are generated using FIPS 140-2 compliant
key-generation mechanisms, you MUST use the <SPAN  CLASS="textit">fips=1</SPAN> boot flag outlined
in section &#167;<A HREF="#Kickstart">2.2.6</A> "Kickstart".

<P>
Using that <SPAN  CLASS="textit">fips=1</SPAN> boot flag ensures the following:

<P>

<UL>
<LI><P>
The kernel is booted with the <SPAN  CLASS="textit">fips=1</SPAN> kernel command line flag as required
by the Security Policy documents for the different FIPS 140-2 modules. When
using these modules during the initial installation time, all operations
are performed compliant to the FIPS 140-2 requirements.

<P>
</LI>
<LI><P>
The kernel command line applied to the newly installed system also contains
the <SPAN  CLASS="textit">fips=1</SPAN> as well as the <SPAN  CLASS="textit">boot=</SPAN> flag as outlined in the Security Policy
documents for the different FIPS 140-2 modules to ensure the newly installed
system is booted in FIPS 140-2 mode.

<P>
</LI>
<LI><P>
The <TT>dracut</TT> boot mechanism contains the <TT>dracut-fips</TT> extension which
ensures that the boot-time self-tests as well as integrity tests for the
kernel are performed.

<P>
</LI>
</UL>

<P>
Therefore, after booting the installation system with the <SPAN  CLASS="textit">fips=1</SPAN> flag,
all system setup configuration steps outlined in the various Security Policy
documents are already covered.

<P>
Note that boot procedures with <SPAN  CLASS="textit">fips=1</SPAN> may take longer and sometimes much
longer than regular boot procedures as the FIPS 140-2 self tests, integrity
tests and random number generator seeding procedures must be performed.

<P>
For more information about the FIPS 140-2 compliant operation of RHEL, please
consult the Security Policy document applicable for the intended cryptographic
module.

<P>

<H2><A NAME="SECTION00325000000000000000"></A><A NAME="Customizing_the_installation"></A><A NAME="238"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">5</SPAN> Customizing the installation
</H2>

<P>
You MAY make changes to specific sections of the kickstart
configuration. You MUST NOT change any settings not explicitly listed
in this section.

<P>
<DL>
<DT><STRONG><TT>keyboard</TT></STRONG></DT>
<DD>

<P>
Default: <TT>us</TT>

<P>
You MAY select a different keyboard mapping.

<P>
</DD>
<DT><STRONG><TT>langsupport</TT></STRONG></DT>
<DD>

<P>
Default: <TT>-default=en_US.UTF-8 en_US.UTF-8</TT>

<P>
You MAY add additional language support, but MUST NOT change the
default language or remove the <TT>en_US</TT> language support. (Users MAY
configure individual language preferences to override the default.)

<P>
</DD>
<DT><STRONG><TT>timezone</TT></STRONG></DT>
<DD>

<P>
Default: <TT>America/Chicago</TT>

<P>
You MAY select a different time zone.

<P>
</DD>
<DT><STRONG><TT>firewall</TT></STRONG></DT>
<DD>

<P>
Default: <TT>-disabled</TT>

<P>
You MAY enable the firewall and modify the firewall settings. Please
refer to section &#167;<A HREF="#Firewall_configuration">4.14</A> "Firewall configuration"
of this guide for more information.

<P>
</DD>
<DT><STRONG><TT>selinux</TT></STRONG></DT>
<DD>

<P>
Default:  <TT>-enforcing</TT>

<P>
For MLS mode, you MUST leave SELinux in enforcing mode.  You MAY
disable SELinux in Base mode.

<P>
</DD>
<DT><STRONG>gen_partitioning()</STRONG></DT>
<DD>

<P>
You MAY modify the default partitioning scheme in this function in the
kickstart file, search for the following comment text:

<P>
<PRE>
        ## Required partitions, resize as appropriate
        ## Optional partitions, (de)activate and resize as appropriate
</PRE>

<P>
Note that you will have an opportunity to modify the partition
settings during the install, please refer to section &#167;<A HREF="#Partitioning">2.2.8</A>
"Partitioning" of this guide for more information. Alternatively, you
MAY use the Logical Volume Manager (LVM) to resize and add partitions
after the installation is complete as documented in the <SPAN  CLASS="textit">lvm</SPAN>(8)
manual page.

<P>
</DD>
</DL>
<H2><A NAME="SECTION00326000000000000000"></A><A NAME="Kickstart"></A><A NAME="265"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">6</SPAN> Kickstart
</H2>

<P>
It is RECOMMENDED that you disconnect all network connections until
the post-install system configuration is finished. You MAY use a
network if required for the installation (for example when using a NFS
or HTTP network server instead of CD-ROMs). If you do use a network,
you MUST ensure that this network is secure.

<P>
Launch the installation boot program contained on the CD-ROM. The
details of how to do this depend on the hardware platform, please
refer to the hardware manuals and the <SPAN  CLASS="textit">Red Hat Enterprise Linux
Installation Guide</SPAN>.  Typically, insert the first CD and boot from
CD-ROM. When obtaining the installation guide via the Internet, 
you should use an SSL-protected HTTP connection to ensure the integrity
and authenticity of the documentation, like
<SPAN  CLASS="textit">https://www.redhat.com/docs/manuals/enterprise/#RHEL6</SPAN>.

<P>
At the boot loader prompt, you MUST initiate the preconfigured
"kickstart" install using a configuration file specific for the
evaluated configuration. The installer supports multiple methods to
locate the kickstart information file.

<P>
You MAY use DHCP to temporarily configure the network during the
installation process, but you MUST assign a static IP address for use
in the evaluated configuration.

<P>
Please refer to the <SPAN  CLASS="textit">Red Hat Enterprise Linux Installation Guide</SPAN> for
more information.

<P>
You MUST use the <TT>ks=</TT> boot parameter that selects a kickstart based
automated installation.

<P>
Choose the appropriate kickstart file for your architecture and
distribution:

<P>
<PRE>
        ks-x86_64.cfg
        ks-ppc64.cfg
        ks-s390x.cfg
        ks-x86_64+SGI.cfg
</PRE>

<P>
The installation process will prompt for all needed information,
alternatively you MAY supply the following command line parameters to
automate the installation:

<P>
<DL>
<DT><STRONG><TT>method</TT></STRONG></DT>
<DD>

<P>
Select one of the supported methods for accessing the distribution media:

<P>
<PRE>
        method=cdrom:
        method=nfs:server.example.com:/path/to/files/
        method=http://server.example.com/path/to/files/
        method=hd://sda1/path/to/files/
</PRE>

<P>
</DD>
<DT><STRONG><TT>ksdevice</TT></STRONG></DT>
<DD>

<P>
Use this network interface for the kickstart installation, default
<TT>eth0</TT>.

<P>
</DD>
<DT><STRONG><TT>ip, netmask, gateway, dns</TT></STRONG></DT>
<DD>

<P>
Configure the network parameters for the installation. See also <TT>ksdevice</TT>.

<P>
</DD>
<DT><STRONG><TT>hostname</TT></STRONG></DT>
<DD>

<P>
Specify the fully qualified host name for the system, for example:

<P>
<PRE>
        hostname=rhel6.example.com
</PRE>

<P>
</DD>
<DT><STRONG><TT>instdisk</TT></STRONG></DT>
<DD>

<P>
Delete all data from the specified disk and partition it for the
evaluated configuration. This will <SPAN  CLASS="textbf">DESTROY</SPAN> the data on this disk
without prompting, use with care. Example:

<P>
<PRE>
        instdisk=sda
</PRE>

<P>
</DD>
<DT><STRONG><TT>console</TT></STRONG></DT>
<DD>

<P>
You MAY use a serial console to control the installation.

<P>
You MAY use a computer using terminal emulation software and a null
modem cable instead of a standalone serial terminal. You MUST ensure
that the serial terminal is secure.

<P>
</DD>
<DT><STRONG><TT>fips</TT></STRONG></DT>
<DD>

<P>
You MAY enable the FIPS 140-2 compliant mode by using the following
boot flag

<P>
<PRE>
        fips=1
</PRE>
</DD>
</DL>

<P>
Examples:

<P>
<PRE>
        # kickstart on USB storage device, install from CD
        ks=hd:sda1:/ks-x86_64.cfg method=cdrom:
</PRE>
<PRE>
        # interactive network install, get IP address via DHCP
        ks=http://example.com/rhel/ks-x86_64.cfg
</PRE>
<PRE>
        # noninteractive network install (all on a single line)
        ip=172.16.2.5 netmask=255.255.255.0 gateway=172.16.2.1 
              dns=172.16.2.1
              ks=http://example.com/rhel/ks-x86_64.cfg 
              method=cdrom:
              hostname=rhel6.example.com 
              instdisk=sda
</PRE>
<PRE>
        # kickstart on USB storage device, install from CD, FIPS 140-2 mode
        ks=hd:sda1:/ks-x86_64.cfg method=cdrom: fips=1
</PRE>
<H2><A NAME="SECTION00327000000000000000"></A><A NAME="Pre-install_configuration"></A><A NAME="308"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">7</SPAN> Pre-install configuration
</H2>

<P>
The following transcript shows an example of the interactions during
the pre-install phase of the configuration:

<P>
<PRE>
 -------------------------------------------------------------------------------
 *** Common Criteria configuration kickstart ***
</PRE>
<PRE>
 Using volume group 'VolGroup01'.
 (Answer '!' at any prompt to get an interactive shell)
</PRE>
<PRE>
 Installation source [cdrom:] ?
</PRE>
<PRE>
 Available destination disks:
 sda 3067.09716797
</PRE>
<PRE>
 Install on which disk(s), comma separated [sda] ?
</PRE>
<PRE>
 Disk encryption uses LUKS key setup with
 FIPS 140-2 compliant 256 bit AES-XTS plain64 IV with SHA-1
 Encrypt all partitions (except /boot) [n] ? y
</PRE>
<PRE>
 Hostname (fully qualified) [rhel.example.com] ?
</PRE>
<PRE>
 Network interface [eth0] ?
</PRE>
<PRE>
 IP address [] ? 172.16.2.5
</PRE>
<PRE>
 Netmask [255.255.255.0] ?
</PRE>
<PRE>
 Gateway [] ? 172.16.2.1
</PRE>
<PRE>
 Nameserver list (comma separated) [] ?
</PRE>
<PRE>
 Manually edit partitioning instructions (y/n) [n] ?
</PRE>
<PRE>
 --- WARNING -------------------------------------------------
 This is your last chance to stop the installation. Continuing
 will erase the destination disk and install non-interactively.
 Answer 'n' if you need to edit your settings.
</PRE>
<PRE>
 Okay to proceed with install on sda (y/n) [n] ? y
 -------------------------------------------------------------------------------
</PRE>

<P>
In case the installation does not show the pre-install configuration
prompts, for example if you see a blank screen only, try using a
different terminal emulator to control the installation.

<P>

<H2><A NAME="SECTION00328000000000000000"></A><A NAME="Partitioning"></A><A NAME="340"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">8</SPAN> Partitioning
</H2>

<P>
You MAY manually edit the partitioning instructions during the
kickstart process. This section describes the partitioning requirements.

<P>
Set up the REQUIRED <SPAN  CLASS="textit">/</SPAN> (root) and <SPAN  CLASS="textit">/var/log</SPAN> partitions, and as
many additional mounted partitions as appropriate. <SPAN  CLASS="textit">/var/log</SPAN>
REQUIRES at least 100 MB of space in order to be able to install and
launch the audit system, but this does not include the additional
space needed for saved audit logs. You MAY use a <SPAN  CLASS="textit">/var/log/audit/</SPAN>
partition separate from <SPAN  CLASS="textit">/var/log/</SPAN> to ensure that audit data is
stored separately from other system logs. Please refer to section
&#167;<A HREF="#Configuring_the_audit_subsystem">6.3</A> "Configuring the audit subsystem"
of this guide for more information.

<P>
Some configurations (recognized automatically by the installation
program) need a separate <SPAN  CLASS="textit">/boot</SPAN> partition formatted as an <SPAN  CLASS="textbf">ext3</SPAN> or <SPAN  CLASS="textbf">ext4</SPAN>
file system. If the installation program warns about the partitioning
being invalid and that it may result in an unbootable system, add the
<SPAN  CLASS="textit">/boot</SPAN> partition.

<P>
It is RECOMMENDED to also use separate partitions for <SPAN  CLASS="textit">/var</SPAN>,
<SPAN  CLASS="textit">/var/log/audit/</SPAN>, <SPAN  CLASS="textit">/home</SPAN> and <SPAN  CLASS="textit">/tmp</SPAN>. The following table shows a
RECOMMENDED partitioning scheme together with minimum sizes for the
partitions. Using more space is RECOMMENDED:

<P>
<PRE>
        /boot          200 MB # if needed by installer
        /             2000 MB
        /tmp           200 MB
        /home          100 MB
        /var           500 MB
        /var/log       500 MB
        /var/log/audit 100 MB # needed for install, &gt;&gt;1GB for use
</PRE>

<P>
All mounted partitions MUST be of type <SPAN  CLASS="textbf">ext3</SPAN>, <SPAN  CLASS="textbf">ext4</SPAN> or <SPAN  CLASS="textbf">swap</SPAN> and
<SPAN  CLASS="textbf">formatted</SPAN>.

<P>
If you want to use disk encryption, please refer to section
&#167;<A HREF="#Hard_disk_encryption">2.2.9</A> "Hard disk encryption".

<P>
In MLS mode, the polyinstantiation mechanism changes the location
that file data is stored. The automated installation process ensures
that a separate partition for <SPAN  CLASS="textit">/tmp</SPAN> will be mounted as <SPAN  CLASS="textit">/tmp-parent</SPAN>
which hosts all temporary file systems. Subdirectories in <SPAN  CLASS="textit">/tmp-parent</SPAN>
will be created and automatically mounted using bind mounts to cover the
locations of <SPAN  CLASS="textit">/tmp</SPAN>, <SPAN  CLASS="textit">/var/tmp</SPAN> and the polyinstantiated <SPAN  CLASS="textit">/tmp</SPAN> directories
for users. Please refer to section &#167;<A HREF="#Configuring_polyinstantiation">3.8</A>
"Configuring polyinstantiation" of this guide for more information.

<P>
Furthermore, when using the KVM functionality, the default location for
file-based disk images for virtual machines are stored in
<SPAN  CLASS="textit">/var/lib/libvirt/images</SPAN> per default. As disk images can potentially be very
large, a separate partition for hosting these images MAY be defined. Note
that <TT>libvirtd</TT> allows the configuration of alternative locations for
these disk images.

<P>
Configuring a swap partition at least as large as the installed RAM is
RECOMMENDED.

<P>

<H2><A NAME="SECTION00329000000000000000"></A><A NAME="Hard_disk_encryption"></A><A NAME="372"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">9</SPAN> Hard disk encryption
</H2>

<P>
During the initial installation phase you MAY encrypt the hard disk
using the dm-crypt partition encryption mechanism. The installation process
allows you to encrypt either the entire hard disk (except <SPAN  CLASS="textit">/boot</SPAN>) or
partitions chosen by you.

<P>
If you chose the option of full disk encryption outlined in section
&#167;<A HREF="#Pre-install_configuration">2.2.7</A> "Pre-install configuration", the installer
asks you to provide a number of key strokes. These key strokes are vital
to ensure the system has enough entropy to produce a strong cryptographic
key. As advertised by the installer you MUST NOT simply press one key
and hold it down, but randomly typing some keys.

<P>
The following hints about disk encryption are only valid if you chose
a manual partitioning as outlined in section &#167;<A HREF="#Partitioning">2.2.8</A> "Partitioning".
If you chose the option of full disk encryption outlined in section
&#167;<A HREF="#Pre-install_configuration">2.2.7</A> "Pre-install configuration", you MAY skip
this section.

<P>
You MUST NOT encrypt <SPAN  CLASS="textit">/boot</SPAN> as this would impair the ability to boot
the system. You MUST configure a separate <SPAN  CLASS="textit">/boot</SPAN> partition if you
intend to configure partition encryption for the root partition of <SPAN  CLASS="textit">/</SPAN>.

<P>
When you manually edit the partitioning schema, you MAY append the option
<SPAN  CLASS="textit">-encrypt</SPAN> to the respective partition definition. In this case, the
partition will be encrypted using dm-crypt. If you apply <SPAN  CLASS="textit">-encrypt</SPAN> to
more than one partition, all such marked partitions will be encrypted using
the same cryptographic key protected with the same passphrase. The installer
will ask you for a passphrase that will be used to protect the key.

<P>
Before you close the editor for manual partitioning, you MUST ensure that
you typed at least 256 key strokes to ensure sufficient entropy is present
for generating a strong key. <SPAN  CLASS="textbf">WARNING:</SPAN> You MUST perform this operation on the
local console as the operation is intended to cause interrupts which fill the
entropy pool of the Linux kernel. Only with sufficient entropy, the master
key for the disk encryption schema is sufficiently strong. If you access
the installation system remotely, e.g. via serial console or via network,
you must log in locally at this point and type in 256 key strokes. The key
strokes on the remote system do not update the entropy pool on the local
system.

<P>

<H2><A NAME="SECTION003210000000000000000"></A><A NAME="Post-install_configuration"></A><A NAME="384"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">10</SPAN> Post-install configuration
</H2>

<P>
The system will run the <SPAN  CLASS="textit">cc-config</SPAN> script to
automatically configure the initial system settings, then prompt to
reboot.

<P>
The following transcript shows an example of the interactions during
the post-install phase of the configuration (the exact version numbers
and package lists may differ in the final version). Note that this transcript
shows that the administrator performs an NFS mount to access the RPM
packages from an NFS server instead of fetching them from a web server.

<P>
<PRE>
 -------------------------------------------------------------------------------
 *** Common Criteria configuration kickstart ***
</PRE>
<PRE>
 Operational mode (base or mls) [base] ? mls
</PRE>
<PRE>
 Please verify the system time and date:                                 
     Local time:           Wed Apr 25 00:28:16 CDT 2011                  
     Universal time (UTC): Wed Apr 25 05:28:16 UTC 2011
</PRE>
<PRE>
 If the time or time zone is wrong, please correct it now using          
 tools such as 'date', 'hwclock', or 'tzselect' as appropriate.
</PRE>
<PRE>
 Is the time correct (y/n) [y] ? 
 Bringing up loopback interface:  [  OK  ]
 Bringing up interface eth0:  [  OK  ]
</PRE>
<PRE>
 Need to install the certification RPM and updated RPM packages:
</PRE>
<PRE>
 cc-eal4-config-rhel62-0.10-1.noarch.rpm
 [...]
</PRE>
<PRE>
 Supply a web URL or a local (absolute) directory name.
</PRE>
<PRE>
 If you need to mount a device containing the files,
 enter '!' and RETURN to get a shell prompt.
</PRE>
<PRE>
 Location [http://local.install.web.server/RHEL62/addtl_RPMs/] ? !
</PRE>
<PRE>
 Starting interactive shell, type 'exit' when done
 sh-3.1# mount -o nolock 172.16.2.1:/home/export /mnt
 sh-3.1# exit
 exit
</PRE>
<PRE>
 Location [http://local.install.web.server/RHEL62/addtl_RPMs/] ? /mnt/rpms/
 `/mnt/rpms/acl-2.2.39-2.1.el5.i386.rpm' -&gt; `./acl-2.2.39-2.1.el5.i386.rpm'
 [...]
 `/mnt/rpms//vixie-cron-4.1-68.el5.i386.rpm' -&gt; `./vixie-cron-4.1-68.el5.i386.rpm'
</PRE>
<PRE>
 Preparing...                ########################################### [100%]
    1:audit-libs             ########################################### [  3%]
 [...]
   31:vixie-cron             ########################################### [100%]
</PRE>
<PRE>
 Switching SELinux to MLS mode...
 Fixing file labels...
 /sbin/setfiles:  labeling files under /
 ***************************************************
</PRE>
<PRE>
 Please enter the password for the root account.
 Changing password for user root.
 New UNIX password: 
 Retype new UNIX password: 
 passwd: all authentication tokens updated successfully.
</PRE>
<PRE>
 Create an administrative user account.
</PRE>
<PRE>
 Real name (First Last) [] ? John Doe
</PRE>
<PRE>
 Userid [jdoe] ? 
 Changing password for user jdoe.
 New UNIX password: 
 Retype new UNIX password: 
 passwd: all authentication tokens updated successfully.
</PRE>
<PRE>
 Add more administrative users (y/n) [n] ? 
  --- Wed Apr 25 00:34:47 CDT 2009 script running: /usr/sbin/cc-config args -a --base
 ###  Configure mount options in /etc/fstab
 [...]
 ### System reboot
</PRE>
<PRE>
 Reconfiguration successful.
 It is now necessary to reboot the system.
 After the reboot, your system configuration will match the evaluated configuration
 *** Reboot the system? (y/n) [y]: y
 rebooting the system now. Sleeping for 10 seconds...
 +sync
 +sleep 10
 Exiting.
 -------------------------------------------------------------------------------
</PRE>

<P>
Warning messages indicating duplicate configuration files at this
stage are harmless and can be ignored, for example:

<P>
<PRE>
  warning: /etc/pam.d/system-auth created as /etc/pam.d/system-auth.rpmnew
</PRE>

<P>
The output of the <SPAN  CLASS="textit">cc-config</SPAN> script is stored in the
<SPAN  CLASS="textit">/var/log/cc-config.log</SPAN> file.

<P>

<H1><A NAME="SECTION00330000000000000000"></A><A NAME="Architecture_specific_manual_configuration_steps"></A><A NAME="431"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">3</SPAN> Architecture specific manual configuration steps
</H1>

<P>
The following sections provide manual configuration steps required for
specific hardware systems. If you install the system on one of the mentioned
hardware, you MUST perform the outlined steps.

<P>

<H2><A NAME="SECTION00331000000000000000"></A><A NAME="SGI_UV"></A><A NAME="433"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">1</SPAN> SGI UV
</H2>

<P>
The SGI UV system requires additional kernel command line flags. These
flags have to be added to the kernel command line specified in the boot
loader configuration file <SPAN  CLASS="textit">/boot/efi/EFI/redhat/grub.conf</SPAN>.

<P>
The boot loader configuration file contains the kernel command line in the line
started with "kernel". For example, the following shortened line may be present

<P>
<PRE>
 kernel /vmlinuz-2.6.32-220.2.1.el6.x86_64 ro root=/dev/mapper/VolGroup01-root...
</PRE>

<P>
You MUST append the following parameters on that line. Note, all parameters
MUST be added on the same line.

<P>
<PRE>
        add_efi_memmap
        log_buf_len=8M
        nmi_watchdog=0
        nohz=off
        nortsched
        processor.max_cstate=1
        earlyprintk=ttyS0,115200n8
</PRE>

<P>
In addition, you MUST append the following option. In case the option is already
present in the kernel command line but just with a different value, you MUST
replace the existing value with the new value.

<P>
<PRE>
        crashkernel=512M
</PRE>
<H1><A NAME="SECTION00400000000000000000"></A><A NAME="Secure_initial_system_configuration"></A><A NAME="442"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>. Secure initial system configuration
</H1>

<P>
After the initial installation using the procedure described in the
previous chapter, the operating system is in the evaluated
configuration if you have selected a Base mode installation.

<P>
In MLS mode, you MUST appropriately configure CIPSO or IPSEC labeled
networking as described in section &#167;<A HREF="#Labeled_networking_MLS_mode_only_">4.18</A> "Labeled networking (MLS mode only)" of this guide, as there
is no universally applicable default for this. Your system will be in
the evaluated configuration once labeled networking is activated.

<P>
The system does not define audit rules as there is no universally
applicable default for this. Please refer to section &#167;<A HREF="#Configuring_the_audit_subsystem">6.3</A> "Configuring the audit subsystem" of this guide
for more information.

<P>
The steps described in this chapter were done automatically if the
kickstart install has completed successfully. You MAY skip ahead to
section &#167;<A HREF="#System_operation">4</A> "System operation" of this guide.

<P>
The information in this section provides background information about
how this configuration was achieved, and mentions some changes you MAY
make to the installed system while still remaining within the
evaluated configuration. It is not intended to be a complete listing
of the changes made to the system. Following the instructions in
section &#167;<A HREF="#Installation">2</A> "Installation" of this guide is the only
supported method to set up the evaluated configuration.

<P>
After software upgrades or installation of additional packages, you
MUST ensure that the configuration remains secure. Please refer to
sections &#167;<A HREF="#How_to_use_this_document">1.2</A> "How to use this document" and
&#167;<A HREF="#Installation_of_additional_software">4.4</A> "Installation of additional
software" of this guide for additional information. You MAY re-run the
<SPAN  CLASS="textit">cc-config</SPAN> script, but this does not guarantee that you will
be in the evaluated configuration if you have added, deleted,
modified, or replaced system components.

<P>

<H1><A NAME="SECTION00410000000000000000"></A><A NAME="Creating_additional_user_accounts_for_administrators"></A><A NAME="451"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">1</SPAN> Creating additional user accounts for administrators
</H1>

<P>
The evaluated configuration disables direct root login over the
network. All system administrators MUST log in using a non-root
individual user ID, then use the <SPAN  CLASS="textit">su</SPAN>(8) command to gain superuser
privileges for administrative tasks. This requires membership in the
'wheel' group of trusted users.

<P>
You MUST define at least one non-root user account with the
<SPAN  CLASS="textit">useradd</SPAN>(8) command, and add this user account to the 'wheel'
group. Note that the enhanced password quality checking mechanisms and
the password expiry settings of the evaluated configuration are not
active yet. You must manually set the password properties in
accordance with the password policy.

<P>
Please refer to section &#167;<A HREF="#Defining_administrative_accounts">4.9.7</A>
"Defining administrative accounts" of this guide for more information
about creating administrative accounts.  The administrative accounts
created during the initial install (&#167;<A HREF="#Post-install_configuration">2.2.10</A>
"Post-install configuration") are <SPAN  CLASS="textit">staff_u</SPAN> users as described in
that section.

<P>
Please refer to sections &#167;<A HREF="#Managing_user_accounts">4.9</A> "Managing user
accounts" and &#167;<A HREF="#Password_policy">7.3</A> "Password policy" of this guide for
more information on creating user accounts.

<P>

<H1><A NAME="SECTION00420000000000000000"></A><A NAME="Installing_required_updates"></A><A NAME="460"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">2</SPAN> Installing required updates
</H1>

<P>
Several packages shipped on the installation media MUST be replaced
with more recent versions to fix bugs or add additional features
required for the evaluated configuration.

<P>
The kickstart script automatically installs the required updates in
the postinstall section.

<P>

<H1><A NAME="SECTION00430000000000000000"></A><A NAME="Automated_configuration_of_the_system"></A><A NAME="462"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">3</SPAN> Automated configuration of the system
</H1>

<P>
The kickstart script installs the <TT>cc-eal4-config-rhel62</TT> RPM package
and runs the <SPAN  CLASS="textit">cc-config</SPAN> script contained within that RPM
package non-interactively.

<P>
You MAY run the <SPAN  CLASS="textit">cc-config</SPAN> script interactively after
installation is complete to verify and reset configuration settings to
appropriate values for the evaluated configuration.

<P>
The <SPAN  CLASS="textit">cc-eal4-config-rhel62</SPAN> package contains configuration files and
the script <SPAN  CLASS="textit">cc-config</SPAN> that sets up the evaluated
configuration.

<P>
Run the following command to view a summary of the supported options:

<P>
<PRE>
        cc-config -h
</PRE>

<P>
You MAY use the <TT>-a</TT> flag to automate the install and have it run
without prompting. This is intended for people who are familiar with
the process; if running it for the first time you SHOULD let it run
interactively and verify the actions as described in this guide.

<P>
You MUST answer all questions asked by the script that are not marked
as "optional" with <TT>y</TT> to achieve the evaluated configuration.

<P>
<SPAN  CLASS="textbf">WARNING</SPAN>: The <SPAN  CLASS="textit">cc-config</SPAN> script will reboot the system as
the final step in the process. Remember to remove any
CD-ROM from the drive and/or configure the system to boot from hard
disk only.

<P>

<H1><A NAME="SECTION00440000000000000000"></A><A NAME="Setting_up_xinetd"></A><A NAME="475"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">4</SPAN> Setting up xinetd
</H1>

<H2><A NAME="SECTION00441000000000000000"></A><A NAME="xinetd_in_MLS_mode"></A><A NAME="477"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN> xinetd in MLS mode
</H2>

<P>
In MLS mode, the <SPAN  CLASS="textit">xinetd</SPAN> super server is used in the evaluated
configuration to integrate <SPAN  CLASS="textit">sshd</SPAN> and labeled networking.

<P>
Please refer to sections &#167;<A HREF="#Labeled_networking_MLS_mode_only_">4.18</A>
"Labeled networking (MLS mode only)" and &#167;<A HREF="#Multilevel_mandatory_access_control_MLS_mode_only_">7.5.2</A> "Multilevel mandatory access control
(MLS mode only)" of this guide for more information about using
<SPAN  CLASS="textit">ssh</SPAN> in MLS mode.

<P>

<H2><A NAME="SECTION00442000000000000000"></A><A NAME="xinetd_in_Base_mode"></A><A NAME="484"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN> xinetd in Base mode
</H2>

<P>
In Base mode, <SPAN  CLASS="textit">xinetd</SPAN> is not used in the evaluated configuration,
but MAY be used to start non-root network processes. The file
<SPAN  CLASS="textit">/etc/xinetd.conf</SPAN> contains default settings, these can be overridden
by service-specific entry files stored in the directory
<SPAN  CLASS="textit">/etc/xinetd.d/</SPAN>.

<P>

<H1><A NAME="SECTION00450000000000000000"></A><A NAME="Setting_up_the_Cups_printing_system"></A><A NAME="489"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">5</SPAN> Setting up the Cups printing system
</H1>

<P>
Use of the Cups printing system is OPTIONAL, if the service is
active you MUST configure the settings described in this section.

<P>
You MAY attach a PCL 4 or PostScript level 1 compatible printer to the
system using a parallel port or USB connection.

<P>
In Base mode only, you MAY also use a network printer. Network
printers MUST NOT be used in MLS mode since they cannot meet the
requirements for data export.

<P>
Verify that the printer daemon is able to access your printer devices
with the configured permissions. You MAY need to reconfigure the printer
device access rights to match, for example by setting the device owner
for the <SPAN  CLASS="textit">/dev/lp*</SPAN> devices to the <SPAN  CLASS="textit">lp</SPAN> user in the
<SPAN  CLASS="textit">/etc/udev/permissions.d/50-udev.permissions</SPAN> file.

<P>
In MLS mode, you MUST use the <SPAN  CLASS="textit">chcon -l</SPAN> command to assign
appropriate MLS levels to the printer device. This MUST be done while
the printer queue is disabled. For example:

<P>
<PRE>
        cupsdisable
        chcon -t printer_device_t -l SystemLow-SystemHigh /dev/lp1
        cupsenable
</PRE>

<P>
In MLS mode, you MUST ensure that the printer cannot be accessed
directly by non-administrative users who try to bypass the operating
system print queue. For parallel port and USB connections, the DAC
restrictions on the printer device will restrict access to
administrators which is sufficient protection.

<P>
In MLS mode, note that the printer name is visible for all users,
even for users who do not have sufficient clearance to use the
printer. The human readable printer name MUST NOT in itself contain
sensitive information.

<P>
Please refer to the <SPAN  CLASS="textit">cupsd.conf</SPAN>(5), <SPAN  CLASS="textit">cupsdisable</SPAN>(8),
<SPAN  CLASS="textit">cupsenable</SPAN>(8), <SPAN  CLASS="textit">chcon</SPAN>(8) and <SPAN  CLASS="textit">cupsd</SPAN>(8) man pages for more
information.

<P>

<H1><A NAME="SECTION00460000000000000000"></A><A NAME="Setting_up_Postfix_Base_mode_only_"></A><A NAME="502"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">6</SPAN> Setting up Postfix (Base mode only)
</H1>

<P>
Postfix is NOT supported in MLS mode. You do not need to specifically
disable it but it is unlikely to work as expected since it does not
contain any support for multilevel security or polyinstantiation.

<P>
Use of the Postfix mail transport is OPTIONAL, but it is strongly
suggested to configure a mail transport agent (MTA) to receive
cron job reports. if the service is
active you MUST configure the settings described in this section.

<P>
An alias MUST be set up for root in <SPAN  CLASS="textit">/etc/aliases</SPAN>, as postfix will
not deliver mail while running with UID 0. Specify one or more user
names of administrators to whom mail addressed to root will be
forwarded, for example with this entry in the <SPAN  CLASS="textit">/etc/aliases</SPAN> file:

<P>
<PRE>
        root: jdoe, jsmith
</PRE>

<P>
You MUST disable the execution of programs in the <SPAN  CLASS="textit">$HOME/.forward</SPAN>
files of individual users. Add the following line to the
<SPAN  CLASS="textit">/etc/postfix/main.cf</SPAN> file:

<P>
<PRE>
        allow_mail_to_commands = alias
</PRE>

<P>
Please see <SPAN  CLASS="textit">postfix</SPAN>(1), <SPAN  CLASS="textit">master</SPAN>(8), <SPAN  CLASS="textit">local</SPAN>(8), and the documentation in
<SPAN  CLASS="textit">/usr/share/doc/postfix*/</SPAN> for details.

<P>

<H1><A NAME="SECTION00470000000000000000"></A><A NAME="Setting_up_Cron_MLS_mode_only_"></A><A NAME="516"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">7</SPAN> Setting up Cron (MLS mode only)
</H1>

<P>
In MLS mode, Cron MUST be configured to disable sending mail. Edit
the <SPAN  CLASS="textit">/etc/sysconfig/crond</SPAN> file to use the following setting:

<P>
<PRE>
        CRONDARGS="-m /bin/true"
</PRE>

<P>
All output from commands run via the cron system will be silently
discarded.

<P>
Please refer to section &#167;<A HREF="#Scheduling_processes_using_cron">4.5</A>
"Scheduling processes using cron" of this guide for more information.

<P>

<H1><A NAME="SECTION00480000000000000000"></A><A NAME="Configuring_polyinstantiation"></A><A NAME="522"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">8</SPAN> Configuring polyinstantiation
</H1>

<P>
The <SPAN  CLASS="textit">pam_namespace.so</SPAN> module ensures that user sessions running at
multiple MLS levels each have their private copy of the home directory
and temporary directories. The module is configured using the
<SPAN  CLASS="textit">/etc/security/namespace.conf</SPAN> file.

<P>
You MUST retain the polyinstantiated directory configuration provided
with the initial installation as these directories are intended to hold
data from users with different labels.

<P>
You MAY modify the polyinstantiation parent directories (second
column) or add additional lines as appropriate. Please refer to the
<SPAN  CLASS="textit">pam_namespace</SPAN>(8) and <SPAN  CLASS="textit">namespace.conf</SPAN>(5) man pages for more
information. To comply with the MLS requirements, all directories that
are writable by unprivileged users belonging to different labels MUST be
polyinstantiated.

<P>

<H1><A NAME="SECTION00490000000000000000"></A><A NAME="Configuring_the_boot_loader"></A><A NAME="528"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">9</SPAN> Configuring the boot loader
</H1>

<P>
You MUST set up the server in a secure location where it is protected
from unauthorized access. Even though that is sufficient to protect
the boot process, it is RECOMMENDED to configure the following
additional protection mechanisms:

<P>

<UL>
<LI><P>
Ensure that the installed system boots exclusively from the disk
partition containing RHEL, and not from floppy disks, USB drives,
CD-ROMs, network adapters, or other devices.

<P>
</LI>
<LI><P>
Ensure that this setting cannot be modified, for example by using a
BootProm/BIOS password to protect access to the configuration.

<P>
</LI>
</UL>
<H1><A NAME="SECTION00500000000000000000"></A><A NAME="System_operation"></A><A NAME="532"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>. System operation
</H1>

<P>
To ensure that the systems remains in a secure state, special care MUST be
taken during system operation.

<P>

<H1><A NAME="SECTION00510000000000000000"></A><A NAME="System_startup_shutdown_and_crash_recovery"></A><A NAME="534"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN> System startup, shutdown and crash recovery
</H1>

<P>
Use the <SPAN  CLASS="textit">shutdown</SPAN>(8), <SPAN  CLASS="textit">halt</SPAN>(8), <SPAN  CLASS="textit">poweroff</SPAN>(8), or <SPAN  CLASS="textit">reboot</SPAN>(8) programs
as needed to shut down or reboot the system.

<P>
When powered on (or on initial program load of the logical partition on
a host system), the system will boot into the RHEL operating
system. If necessary (for example after a crash), a filesystem check will be
performed automatically. In rare cases manual intervention is
necessary, please refer to the <SPAN  CLASS="textit">e2fsck</SPAN>(8) and <SPAN  CLASS="textit">debugfs</SPAN>(8)
documentation for details in this case.

<P>
In case a nonstandard boot process is needed (such as booting from
floppy disk or CD-ROM to replace a defective hard drive), interaction
with the boot loader and/or the host's management system can be used
to modify the boot procedure for recovery.

<P>
For example, you can use the following grub commands to
launch a shell directly from the kernel, bypassing the normal
init/login mechanism:

<P>
<PRE>
        # view the current grub configuration
        grub&gt; cat (hd0,1)/boot/grub/menu.lst
</PRE>
<PRE>
        # manually enter the modified settings
        grub&gt; kernel (hd0,1)/boot/vmlinuz root=/dev/sda1 init=/bin/sh
        grub&gt; initrd (hd0,1)/boot/initrd
        grub&gt; boot
</PRE>

<P>
Please refer to the relevant documentation of the boot loader, as well
as the RHEL administrator guide, for more information.

<P>

<H1><A NAME="SECTION00520000000000000000"></A><A NAME="Backup_and_restore"></A><A NAME="546"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN> Backup and restore
</H1>

<P>
Whenever you make changes to security-critical files, you MAY need to be able
to track the changes made and revert to previous versions, but this is not
required for compliance with the evaluated configuration.

<P>
The <SPAN  CLASS="textit">tar</SPAN>(1) archiver is RECOMMENDED for backups of complete
directory contents, please refer to section &#167;<A HREF="#Data_import_export">7.6</A> "Data import / export" of this guide. Regular backups of the following
files and directories (on removable media such as tapes or CD-R, or on a
separate host) are RECOMMENDED:

<P>
<PRE>
        /etc/
        /var/spool/cron/
</PRE>

<P>
You MUST use the <TT>-acls</TT> option for <SPAN  CLASS="textit">tar</SPAN> if you intend to save or
restore ACLs. Similarly, you MUST use the <TT>-selinux</TT> option for <SPAN  CLASS="textit">tar</SPAN> if
you want to save or restore SELinux labels holding the MLS labels.
You MAY omit these options if you only intend to save
or restore file contents without security metadata.

<P>
Depending on your site's audit requirements, also include the contents
of <SPAN  CLASS="textit">/var/log/</SPAN> in the backup plan. In that case, the automatic daily
log file rotation needs to be disabled or synchronized with the backup
mechanism, refer to sections &#167;<A HREF="#System_logging_and_accounting">6.2</A>
"System logging and accounting" and &#167;<A HREF="#Configuring_the_audit_subsystem">6.3</A> "Configuring the audit subsystem" of this guide for more
information.

<P>
You MUST protect the backup media from unauthorized access, because
the copied data does not have the access control mechanisms of the
original file system. Among other critical data, it contains the
secret keys used by the <SPAN  CLASS="textit">SSH</SPAN> server, as well as the
<SPAN  CLASS="textit">/etc/shadow</SPAN> password database. Store the backup media at least as
securely as the server itself.

<P>
A RECOMMENDED method to track changes is to use a version control system. RCS
is easy to set up because it does not require setting up a central repository
for the changes, and you can use shell scripting to automate the change
tracking. RCS is not included in the evaluated configuration, see
<SPAN  CLASS="textit">rcsintro</SPAN>(1) in the rcs RPM package for more information. Alternatively, you
can create manually create backup copies of the files and/or copy them to
other servers using <SPAN  CLASS="textit">scp</SPAN>(1).

<P>

<H1><A NAME="SECTION00530000000000000000"></A><A NAME="Gaining_administrative_access"></A><A NAME="563"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">3</SPAN> Gaining administrative access
</H1>

<P>
System administration tasks require superuser (root) privileges. In
Base mode, superuser rights are also sufficient for administrative
actions. In MLS mode, superuser rights are a prerequisite for
administrative rights, but in addition you need to select an
administrative role with appropriate privileges.

<P>
Directly logging on over the network as user root is disabled. To gain
superuser rights, you MUST first authenticate using an unprivileged
user ID, and then use either the <TT>su</TT> or the <TT>sudo</TT>
command to switch identities. Note
that you MUST NOT use the root rights for anything other than those
administrative tasks that require these privileges, all other tasks
MUST be done using your normal (non-root) user ID.

<P>

<H2><A NAME="SECTION00531000000000000000"></A><A NAME="Using_su"></A><A NAME="567"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">1</SPAN> Using su
</H2>

<P>
The <TT>su</TT> command allows a permanent switch of the user ID for the current
session.

<P>
You MUST use exactly the following <SPAN  CLASS="textit">su</SPAN>(1) command line to gain
superuser access:

<P>
<PRE>
        /bin/su -
</PRE>

<P>
This ensures that the correct binary is executed irrespective of PATH
settings or shell aliases, and that the root shell starts with a clean
environment not contaminated with the starting user's settings. This is
necessary because the <SPAN  CLASS="textit">.profile</SPAN> shell configuration and other similar
files are writable for the unprivileged ID, which would allow an attacker
to easily elevate privileges to root if able to subvert these settings.

<P>
Administrators MUST NOT add any directory to the root user's PATH that
are writable for anyone other than root, and similarly MUST NOT use or
execute any scripts, binaries or configuration files that are writable for
anyone other than root, or where any containing directory is writable
for a user other than root.

<P>

<H2><A NAME="SECTION00532000000000000000"></A><A NAME="Using_sudo"></A><A NAME="574"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">2</SPAN> Using sudo
</H2>

<P>
The <TT>sudo</TT> command allows invoking of a command with a configured user ID,
including the root user ID. The switch to the target user ID only remains for
the duration of the execution time of the specified command.

<P>
The default configuration of <TT>sudo</TT> does not allow any unprivileged users
to invoke privileged commands. Depending on your requirements, the following
examples may be used as a guide to configure <TT>sudo</TT>. More information
may be obtained from the <SPAN  CLASS="textit">sudoers</SPAN>(5) man page.

<P>
The following configuration allows all users associated with the <SPAN  CLASS="textit">wheel</SPAN>
group to use all commands with privileges:

<P>
<PRE>
        %wheel        ALL=(ALL)       ALL
</PRE>

<P>
The <TT>sudo</TT> configuration allows specification of the target SELinux
type and role the application will be invoked with. The following example
defines that <SPAN  CLASS="textit">userA</SPAN> may invoke all commands with the root user ID and
the sysadm_r/sysadm_t SELinux role/type:

<P>
<PRE>
        userA ALL=(ALL) ROLE=sysadm_r TYPE=sysadm_t ALL
</PRE>

<P>
The last example allows a user to only invoke one specific command. With
this configuration, delegation of specific duties may be configured. Note,
<TT>sudo</TT> even allows specification of command line options that may be used
together with the given command.

<P>
<PRE>
        userA ALL=(ALL) ROLE=sysadm_r TYPE=sysadm_t /usr/sbin/useradd
</PRE>
<H2><A NAME="SECTION00533000000000000000"></A><A NAME="Administrative_users_in_MLS_mode"></A><A NAME="590"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">3</SPAN> Administrative users in MLS mode
</H2>

<P>
In MLS mode, the system supports several administrative roles:

<P>
<DL>
<DT><STRONG>system_r</STRONG></DT>
<DD>

<P>
The operating system supports multiple roles for noninteractive system
processes such as daemons. All non-interactive roles are considered to
be subdivisions of a conceptual "system" role. The additional
restrictions enforced on system services are beyond the scope of this
document. The definition of system roles allows separating
those from users.

<P>
</DD>
<DT><STRONG>sysadm_r</STRONG></DT>
<DD>

<P>
This is a role defined for general system administration tasks,
including setting or modifying security contexts, and changing the
sensitivity label of a subject or object.

<P>
</DD>
<DT><STRONG>secadm_r</STRONG></DT>
<DD>

<P>
This is a role defined for administration of security-related configuration
items. For example, the configuration of SELinux, including the re-loading
of the SELinux policy is only possible using the secadm_r role.

<P>
</DD>
<DT><STRONG>auditadm_r</STRONG></DT>
<DD>

<P>
This is a role for the management of the audit configuration and
evaluation of the audit records.

<P>
</DD>
</DL>

<P>
In addition, the system provides the following non-administrative
roles by default:

<P>
<DL>
<DT><STRONG>staff_r</STRONG></DT>
<DD>

<P>
This is a role for users that are allowed use the newrole command to transition to administrative roles.

<P>
</DD>
<DT><STRONG>user_r</STRONG></DT>
<DD>

<P>
This is a generic role for all users other than "staff".

<P>
</DD>
</DL>

<P>
In MLS mode, you MUST select one of the administrative roles after
running "su" to perform administrative actions, for example:

<P>
<PRE>
        /bin/su -
        newrole -r sysadm_r
        newrole -r auditadm_r
</PRE>

<P>
You MUST use the <SPAN  CLASS="textit">SystemLow</SPAN> level for system administration. This is
necessary to avoid accidentally upgrading system files to
inappropriately high MLS levels, which would make them unreadable for
processes running at lower levels.

<P>
Please refer to the <SPAN  CLASS="textit">newrole</SPAN>(1) man page and section &#167;<A HREF="#Role-based_access_control_MLS_mode_only_">7.5.3</A> "Role-based access control (MLS
mode only)" of this guide for more information.

<P>
In MLS mode, you MAY also select a MLS level for administrative
actions, usually one of <SPAN  CLASS="textit">SystemLow</SPAN> or <SPAN  CLASS="textit">SystemHigh</SPAN>. Please refer to
section &#167;<A HREF="#Multilevel_mandatory_access_control_MLS_mode_only_">7.5.2</A>
"Multilevel mandatory access control (MLS mode only)" of this guide
for more information.

<P>

<H1><A NAME="SECTION00540000000000000000"></A><A NAME="Installation_of_additional_software"></A><A NAME="616"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">4</SPAN> Installation of additional software
</H1>

<P>
Additional software packages MAY be installed as needed,
provided that they do not conflict with the security requirements.

<P>

<H2><A NAME="SECTION00541000000000000000"></A><A NAME="Supported_software_architectures"></A><A NAME="618"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN> Supported software architectures
</H2>

<P>
You MUST use the default kernel (which is SMP capable even on
uniprocessor systems) from the package <SPAN  CLASS="textit">kernel-2.6.*.rpm</SPAN> on all
systems. You MUST NOT use a different kernel flavor such as the PAE
kernel.

<P>
You MUST select the appropriate RPM packages for your architecture.
The 64bit architectures support execution of both 64bit and 32bit
binaries.

<P>
<DL>
<DT><STRONG>x86_64 (Intel EM64T, AMD Opteron)</STRONG></DT>
<DD>

<P>
These systems use a 64bit kernel and 64bit userspace programs and also
supports running 32bit programs. Use the <SPAN  CLASS="textbf">*.x86_64.rpm</SPAN> or
<SPAN  CLASS="textbf">*.noarch.rpm</SPAN> variants of packages. You can OPTIONALLY install the
<SPAN  CLASS="textbf">*.i386.rpm</SPAN> or <SPAN  CLASS="textbf">*.i686.rpm</SPAN> variants of libraries (package names
containing <SPAN  CLASS="textit">-libs</SPAN> or <SPAN  CLASS="textit">-devel</SPAN>) in addition to the 64bit versions.

<P>
</DD>
<DT><STRONG>System p (ppc/ppc64)</STRONG></DT>
<DD>

<P>
These systems use a 64bit kernel, but the installed userspace programs are
the 32bit variants. They support running 64bit programs as well. Use the
*.ppc64.rpm kernel for System p. Use the *.ppc.rpm or *.noarch.rpm
packages for all packages other than the kernel. You can OPTIONALLY
install the *.ppc64.rpm variants of libraries (package names containing
-libs or -devel) in addition to the 32bit versions.

<P>
</DD>
<DT><STRONG>System z (s390x)</STRONG></DT>
<DD>

<P>
The evaluated conguration uses a 64bit kernel running 64bit userspace
programs. Use the *.s390x.rpm or *.noarch.rpm variants of packages.
You can OPTIONALLY install the 32bit *.s390.rpm variants of libraries
(package names containing -libs or -devel) in addition to the 64bit versions.

<P>
</DD>
</DL>
<H2><A NAME="SECTION00542000000000000000"></A><A NAME="Security_requirements_for_additional_software"></A><A NAME="635"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN> Security requirements for additional software
</H2>

<P>
Any additional software added is not intended to be used with superuser
privileges. The administrator MUST use only those programs that are part of the
original evaluated configuration for administration tasks, except if the
administrator has independently ensured that use of the additional software is
not a security risk.

<P>
Administrators MAY add scripts to automate tasks as long as those only depend
on and run programs that are part of the evaluated configuration.

<P>
The security requirements for additional software are:

<P>

<UL>
<LI><P>
Kernel modules other than those provided as part of the evaluated
configuration MUST NOT be installed or loaded. You MUST NOT load the
<SPAN  CLASS="textit">tux</SPAN> kernel module (the in-kernel web server is not supported). You
MUST NOT add support for non-ELF binary formats or foreign binary
format emulation that circumvents system call auditing. You MUST NOT
activate knfsd or export NFS file systems.

<P>
</LI>
<LI><P>
Device special nodes MUST NOT be manually added to the system.

<P>
</LI>
<LI><P>
SUID root or SGID root programs MUST NOT be added to the system.
Programs which use the SUID or SGID bits to run with identities other than
root MAY be added if the numerical SUID and SGID values are not
less than 500 as defined with the values <SPAN  CLASS="textit">UID_MIN</SPAN> and <SPAN  CLASS="textit">GID_MIN</SPAN> in the
configuration file of <SPAN  CLASS="textit">/etc/login.defs</SPAN>.  This restriction is necessary
to avoid conflict with system user and group IDs such as the "disk" group.

<P>
</LI>
<LI><P>
The content, permissions, and ownership of all existing filesystem objects
(including directories and device nodes) that are part of the evaluated
configuration MUST NOT be modified. Files and directories MAY be added to
existing directories provided that this does not violate any other
requirement.

<P>
</LI>
<LI><P>
The rules for the <TT>udev</TT> framework provided in <SPAN  CLASS="textit">/lib/udev/rules.d</SPAN> must
be left unchanged. Also, no new rules must be added to the <TT>udev</TT> framework.

<P>
</LI>
<LI><P>
Programs automatically launched with root privileges MUST NOT be added to the
system. Exception: processes that <SPAN  CLASS="textit">immediately</SPAN> and <SPAN  CLASS="textit">permanently</SPAN> switch to a
non-privileged identity on launch are permitted, for example by using
<TT>su USERID -c LAUNCH_COMMAND</TT> in the startup file, or alternatively by using
the <SPAN  CLASS="textit">setgroups</SPAN>(2), <SPAN  CLASS="textit">setgid</SPAN>(2) and <SPAN  CLASS="textit">setuid</SPAN>(2) system calls in a binary.
(<SPAN  CLASS="textit">seteuid</SPAN>(2) etc. are insufficient.)

<P>
Automatic launch mechanisms are:

<P>

<UL>
<LI><P>
Entries in <SPAN  CLASS="textit">/etc/inittab</SPAN>

<P>
</LI>
<LI><P>
Executable files or links in <SPAN  CLASS="textit">/etc/rc.d/init.d/</SPAN> and its subdirectories

<P>
</LI>
<LI><P>
Entries in <SPAN  CLASS="textit">/etc/xinetd.conf</SPAN>

<P>
</LI>
<LI><P>
Scheduled jobs using <TT>cron</TT> (including entries in <SPAN  CLASS="textit">/etc/cron*</SPAN> files)

<P>
</LI>
<LI><P>
Applications started using the system DBUS which is configured via
<SPAN  CLASS="textit">/etc/dbus-1/system.d/</SPAN>.

<P>
</LI>
<LI><P>
Applications specified in <SPAN  CLASS="textit">/etc/sudoers</SPAN> or with rules located in a file
in the directory <SPAN  CLASS="textit">/etc/sudoers.d</SPAN>. Note, that file may contain the
keyword <SPAN  CLASS="textit">ALL</SPAN> as a placeholder for a command. In this case, the user
allowed to execute all commands with that rule using the root user ID MUST
ensure that additional applications are not executed using <TT>sudo</TT>. This
requirement can only be met with operational procedures.

<P>
</LI>
<LI><P>
Applications spawned via <TT>udev</TT> where the rules are added to
<SPAN  CLASS="textit">/lib/udev/rules.d</SPAN>.

<P>
</LI>
</UL>
</LI>
</UL>

<P>
Examples of programs that usually do not conflict with these requirements
and MAY be installed are compilers, interpreters, network services
running with non-root rights, and similar programs. The requirements listed
above MUST be verified in each specific case.

<P>
Some system programs are configured to automatically change their
SELinux context when executed. This uses the type transitioning
facilities of the SELinux policy, and can add or remove privileges
from programs. Type transitioning programs can be recognized by the
file context (as shown with the <TT>ls -Z</TT> command) containing the
<SPAN  CLASS="textit">exec_t</SPAN> suffix, for example <SPAN  CLASS="textit">/bin/passwd</SPAN> with the <SPAN  CLASS="textit">passwd_exec_t</SPAN>
type. You MUST NOT assign type transitions with predefined system
types to additional programs. Automatic type transitions are not safe
for use with script files, and MUST NOT be used for adding privileges
to scripts, only for voluntarily removing them.

<P>

<H1><A NAME="SECTION00550000000000000000"></A><A NAME="Scheduling_processes_using_cron"></A><A NAME="671"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">5</SPAN> Scheduling processes using cron
</H1>

<P>
The <SPAN  CLASS="textit">cron</SPAN> facility is available for scheduling processes. The legacy
<SPAN  CLASS="textit">at</SPAN> service is not supported in the evaluated configuration.

<P>
The <SPAN  CLASS="textit">cron</SPAN>(8) program schedules programs for execution at regular intervals.
Entries can be modified using the <SPAN  CLASS="textit">crontab</SPAN>(1) program - the file format is
documented in the <SPAN  CLASS="textit">crontab</SPAN>(5) manual page.

<P>
In MLS mode, users MAY use the MLS_LEVEL environment variable to
select an MLS level for the job to execute. This is documented in the
<SPAN  CLASS="textit">crontab</SPAN>(5) manual page.

<P>
In MLS mode, cron will NOT send mail containing job output to users.
You MAY use output redirection in crontab entries to save output in
files at the appropriate MLS level.

<P>
You MUST follow the rules specified for installation of additional programs
for all entries that will be executed by the root user. Use non-root
crontab entries in all cases where root privileges are not absolutely
necessary.

<P>
Errors in the non interactive jobs executed by <TT>cron</TT> are
reported in the system log files in <SPAN  CLASS="textit">/var/log/</SPAN>, and, in Base mode,
additionally via e-mail to the user who scheduled it.

<P>
Permission for users to schedule jobs with <TT>cron</TT> 
through the following <SPAN  CLASS="textit">allow</SPAN> and <SPAN  CLASS="textit">deny</SPAN> files:

<P>
<PRE>
        /etc/cron.allow
        /etc/cron.deny
</PRE>

<P>
The <SPAN  CLASS="textit">allow</SPAN> file has precedence if it exists, then only those users
whose usernames are listed in it are permitted to use the service. If
it does not exist, the <SPAN  CLASS="textit">deny</SPAN> file is used instead and all users who
are <SPAN  CLASS="textit">not</SPAN> listed in that file can use the service. Note that the
contents of these files are only relevant when the scheduling commands
are executed, and changes have no effect on already scheduled
commands.

<P>
In the RHEL distribution, the <SPAN  CLASS="textit">allow</SPAN> files do not exist, and <SPAN  CLASS="textit">deny</SPAN>
files are used to prevent system-internal IDs and/or guest users from
using these services. By default, the evaluated configuration permits
everybody to use <SPAN  CLASS="textit">cron</SPAN>.

<P>
It is RECOMMENDED to restrict the use of <SPAN  CLASS="textit">cron</SPAN> to human
users and disallow system accounts from using these mechanisms. For
example, the following commands add all system accounts other than
root to the <SPAN  CLASS="textit">deny</SPAN> files:

<P>
<PRE>
  awk -F: '{if ($3&gt;0 &amp;&amp; $3&lt;100) print $1}' /etc/passwd &gt;/etc/cron.deny
  chmod 600 /etc/cron.deny
</PRE>

<P>
Administrators MAY schedule jobs that will be run with the privileges
of a specified user by editing the file <SPAN  CLASS="textit">/etc/crontab</SPAN> with an
appropriate username in the sixth field. Entries in <SPAN  CLASS="textit">/etc/crontab</SPAN>
are not restricted by the contents of the <SPAN  CLASS="textit">allow</SPAN> and <SPAN  CLASS="textit">deny</SPAN> files.

<P>
You MAY create a <SPAN  CLASS="textit">/etc/cron.allow</SPAN> file to explicitly list users who
are permitted to use this service. If you do create this file, it MUST
be owned by the user root and have file permissions 0600 (no access
for group or others).

<P>
Note, the login ID is not retained for the following special case:

<P>

<OL>
<LI><P>
User A logs into the system.

<P>
</LI>
<LI><P>
User A uses su to change to user B.

<P>
</LI>
<LI><P>
User B now edits the cron or at job queue to add new jobs. This operation
is appropriately audited with the proper login ID.

<P>
</LI>
<LI><P>
Now when the new jobs are executed as user B, the system does not provide
the audit information that the jobs are created by user A.

<P>
</LI>
</OL>
<H1><A NAME="SECTION00560000000000000000"></A><A NAME="Mounting_filesystems"></A><A NAME="703"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">6</SPAN> Mounting filesystems
</H1>

<P>
If any filesystems need to be mounted in addition to those set up at
installation time, appropriate mount options MUST be used to ensure
that mounting the filesystem does not introduce capabilities that
could violate the security policy.

<P>
The special-purpose <SPAN  CLASS="textit">proc</SPAN>, <SPAN  CLASS="textit">sysfs</SPAN>, <SPAN  CLASS="textit">devpts</SPAN>, <SPAN  CLASS="textit">selinuxfs</SPAN>,
<SPAN  CLASS="textit">binfmt_misc</SPAN>, <SPAN  CLASS="textit">devtmpfs</SPAN>, <SPAN  CLASS="textit">mqueue</SPAN> and <SPAN  CLASS="textit">tmpfs</SPAN> filesystems are part of
the evaluated
configuration. These are virtual filesystems with no underlying
physical storage, and represent data structures in kernel
memory. Access to contents in these special filesystems is protected
by the normal discretionary access control policy and additional
permission checks.

<P>
Note that changing ownership or permissions of virtual files and
directories is generally NOT supported for the <SPAN  CLASS="textit">proc</SPAN> and <SPAN  CLASS="textit">sysfs</SPAN>
filesystems (corresponding to directories <SPAN  CLASS="textit">/proc/</SPAN> and <SPAN  CLASS="textit">/sys/</SPAN> ), and
attempts to do so will be ignored or result in error messages.

<P>
A new filesystem can be integrated as part of the evaluated
configuration, for example by installing an additional hard disk,
under the following conditions:

<P>

<UL>
<LI><P>
The device is protected against theft or manipulation in the same way
as the server itself, for example by being installed inside the server.

<P>
</LI>
<LI><P>
One or more new, empty, file systems with the file system formats
listed in section &#167;<A HREF="#Partitioning">2.2.8</A> "Partitioning" are created on it.

<P>
</LI>
<LI><P>
The file systems are mounted using the <TT>acl</TT> option, for example with
the following setting in the <SPAN  CLASS="textit">/etc/fstab</SPAN> file:

<P>
<PRE>
        /dev/sdc1 /home2 ext3 acl 1 2
</PRE>

<P>
Existing files and directories MAY then be moved onto the new file systems.

<P>
</LI>
<LI><P>
If a device containing a file system is ever removed from the system,
the device MUST be stored within the secure server facility, or
alternatively MUST be destroyed in a way that the data on it is
reliably erased.

<P>
</LI>
</UL>

<P>
Alternatively, media MAY be accessed without integrating them into the
evaluated configuration, for example CD-ROMs or DVDs.

<P>
CD/DVD devices MUST be accessed using the <SPAN  CLASS="textit">iso9660</SPAN> filesystem
type. Using an automounter is NOT permitted in the evaluated
configuration.

<P>
The following mount options MUST be used if the filesystems contain
data that is not part of the evaluated configuration:

<P>
<PRE>
        nodev,nosuid
</PRE>

<P>
Adding the <SPAN  CLASS="textit">noexec</SPAN> mount option to avoid accidental execution of
files or scripts on additional mounted filesystems is RECOMMENDED.

<P>
In MLS mode, be aware that <SPAN  CLASS="textit">iso9660</SPAN> filesystems do not support MLS
labels on individual objects. You MAY use the <TT>context=</TT> mount option
to specify an SELinux context including MLS level for the entire
filesystem. It is RECOMMENDED that you use <SPAN  CLASS="textit">iso9660</SPAN> filesystems only
for world readable data that does not need read protection.

<P>
Be aware that data written to removable media is not reliably
protected by the DAC permission mechanism, and should be considered
accessible to anyone with physical access to the media.  It is
RECOMMENDED to add the <SPAN  CLASS="textit">ro</SPAN> option to mount the file system
read-only.

<P>
Note that these settings do not completely protect against malicious
code and data, you MUST also verify that the data originates from a
trustworthy source and does not compromise the server's
security. Specifically, be aware of the following issues:

<P>

<UL>
<LI><P>
Even unprivileged programs and scripts can contain malicious code that
uses the calling user's rights in unintended ways, such as corrupting
the user's data, introducing Trojan horses in the system, attacking
other machines on the network, revealing confidential documents,
or sending unsolicited commercial e-mail ("Spam").

<P>
</LI>
<LI><P>
Data on the additional filesystem MUST have appropriate access rights
to prevent disclosure to or modification by unauthorized users. Be
aware that imported data could have been created using user names and
permissions that do not match your system's security policies.

<P>
</LI>
<LI><P>
You MUST NOT write data on removable file systems such as floppy
disks, since it cannot be adequately protected by the system's access
control mechanisms after being removed from the system. Please refer
to section &#167;<A HREF="#Backup_and_restore">4.2</A> "Backup and restore" of this guide
for more information regarding non-filesystem-based backup.

<P>
</LI>
</UL>

<P>
Each new file system MUST be mounted on an empty directory that is not used for
any other purpose. It is RECOMMENDED using subdirectories of <SPAN  CLASS="textit">/mnt</SPAN> for temporary
disk and removable storage media mounts.

<P>
For example:

<P>
<PRE>
  # mount /dev/cdrom /mnt/cdrom -t iso9660 -o ro,nodev,nosuid,noexec
</PRE>

<P>
You MAY also add an equivalent configuration to <SPAN  CLASS="textit">/etc/fstab</SPAN>, for example:

<P>
<PRE>
  /dev/cdrom /mnt/cdrom iso9660 ro,noauto,nodev,nosuid,noexec 0 0
</PRE>

<P>
You MUST NOT include the <SPAN  CLASS="textit">user</SPAN> flag, ordinary users are not permitted to
mount filesystems. This is also enforced by the deletion of the SUID bit on
the <SPAN  CLASS="textit">mount</SPAN> command.

<P>

<H1><A NAME="SECTION00570000000000000000"></A><A NAME="Configuration_of_kernel_cryptographic_support"></A><A NAME="743"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">7</SPAN> Configuration of kernel cryptographic support
</H1>

<P>
The evaluated configuration blacklists the Intel AES-NI support kernel
module. This blacklisting ensures that the AES-NI support is not
loaded automatically.

<P>
You MUST NOT load this kernel module manually.

<P>

<H1><A NAME="SECTION00580000000000000000"></A><A NAME="Encryption_of_partitions"></A><A NAME="745"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">8</SPAN> Encryption of partitions
</H1>

<P>
RHEL provides the dm-crypt mechanism for setting up partitions where all
data stored on those partitions are encrypted on the fly. When data is read
from those partitions, the data is decrypted without any intervention by
any user.

<P>
As the block device of the partition is subject to the cryptographic operation,
there is no restriction which filesystem is used together with the encrypted
block device. If you selected a full disk encryption or configured
encryption for different partitions during the initial installation time
as outlined in section &#167;<A HREF="#Hard_disk_encryption">2.2.9</A> "Hard disk encryption",
you already store data on dm-crypt protected hard disks.

<P>
You MAY configure yet unused or newly added hard disks or partitions using
dm-crypt before creating a filesystem on them. The setup of a dm-crypt
protected partition is performed using the <TT>cryptsetup</TT> application.
Please refer to the <SPAN  CLASS="textit">cryptsetup</SPAN>(8) man page for instructions on using
dm-crypt.

<P>
When using cryptsetup manually, you MUST use the LUKS extension and therefore
the LUKS commands specified in <SPAN  CLASS="textit">cryptsetup</SPAN>(8).

<P>
The setup of a dm-crypt protected partition is performed with the
<SPAN  CLASS="textit">luksFormat</SPAN> command to the <TT>cryptsetup</TT> application. You MAY use
the <SPAN  CLASS="textit">luksFormat</SPAN> command with the option <SPAN  CLASS="textit">-with-random</SPAN> if your system
is not in FIPS 140-2 mode of operation to ensure that the session key used
to encrypt the data is derived from <SPAN  CLASS="textit">/dev/random</SPAN> to ensure a very high
quality of the key material:

<P>
<PRE>
        cryptsetup luksFormat --with-random /dev/sdd1
</PRE>

<P>
This option ensures that <TT>cryptsetup</TT> generates the key used for the
cryptographic operations out of <SPAN  CLASS="textit">/dev/random</SPAN> to ensure cryptographically
strong keys. In FIPS 140-2 mode, this option is not necessary as
<TT>cryptsetup</TT> uses the <SPAN  CLASS="textit">libgcrypt</SPAN> shared library for any cryptographic
operation. The key material is generated out of an ANSI X9.31 DRNG which
is seeded by using the device file linked to by <SPAN  CLASS="textit">/etc/gcrypt/rngseed</SPAN>.

<P>
When you do not want to use the default cipher with <SPAN  CLASS="textit">luksFormat</SPAN>
(see <TT>cryptsetup -help</TT> for the default), you MUST ensure that the following
requirements are met when specifying the cipher:

<P>
<DL>
<DT><STRONG>Allowed ciphers:</STRONG></DT>
<DD>
<UL>
<LI><P>
AES (128 bits, 192 bits, 256 bits)

<P>
</LI>
<LI><P>
Serpent (128 bits, 192 bits, 256 bits)

<P>
</LI>
<LI><P>
Twofish (128 bits, 192 bits, 256 bits)

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>Allowed block chaining modes:</STRONG></DT>
<DD>
<UL>
<LI><P>
CBC

<P>
</LI>
<LI><P>
GCM

<P>
</LI>
<LI><P>
XTS

<P>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>Allowed IV-handling mechanisms:</STRONG></DT>
<DD>
<UL>
<LI><P>
GCM, XTS: plain

<P>
</LI>
<LI><P>
GCM, XTS: plain64

<P>
</LI>
<LI><P>
CBC: ESSIV

<P>
</LI>
<LI><P>
GCM, XTS: benbi

<P>
</LI>
</UL>
</DD>
</DL>

<P>
After formatting, the <SPAN  CLASS="textit">luksOpen</SPAN> command has to be used to set up the
encryption mechanism, i.e. to inform the kernel that any read and write
operation is encrypted and decrypted on the fly. The device file created
with the <SPAN  CLASS="textit">luksOpen</SPAN> command can now be used to create a file system which
then can also be mounted.

<P>
For a regular operation, the <SPAN  CLASS="textit">luksOpen</SPAN> command has be used followed by
a <TT>mount</TT> command with the device file created by <SPAN  CLASS="textit">luksOpen</SPAN>.

<P>
Please note that when the system was booted in FIPS 140-2 mode, the kernel
does not allow the use of ciphers as well as hash mechanisms that are not
FIPS 140-2 approved. Therefore, errors will occur when specifying non-approved
ciphers or hashes.

<P>

<H1><A NAME="SECTION00590000000000000000"></A><A NAME="Managing_user_accounts"></A><A NAME="784"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN> Managing user accounts
</H1>

<H2><A NAME="SECTION00591000000000000000"></A><A NAME="Creating_users"></A><A NAME="786"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">1</SPAN> Creating users
</H2>

<P>
Use the <SPAN  CLASS="textit">useradd</SPAN>(8) command to create new user accounts, then use
the <SPAN  CLASS="textit">passwd</SPAN>(1) command to assign an initial password for the
user. Alternatively, if the user is present when the account is
created, permit them to choose their own password. Refer to the manual
pages for <SPAN  CLASS="textit">useradd</SPAN>(8) and <SPAN  CLASS="textit">passwd</SPAN>(1) for more information.

<P>
If you assign an initial password for a new user, you MUST transfer
this initial password in a secure way to the user, ensuring that no
third party gets the information. For example, you can tell the
password to a user personally known to you. If this is not possible,
you MAY send the password in written form in a sealed letter. This
applies also when you set a new password for a user in case the user
has forgotten the password or it has expired. You need to advise the
user that he MUST change this initial password when he first logs into
the system and select his own password in accordance with the rules
defined in section &#167;<A HREF="#Password_policy">7.3</A> "Password policy" of this
guide.

<P>
You MUST NOT use the <TT>-p</TT> option to <SPAN  CLASS="textit">useradd</SPAN>(8), specifying a
password in that way would bypass the password quality checking
mechanism. In addition, specifying a password on the command line
makes this password temporarily visible to all users.

<P>
The temporary password set by the administrator MUST be changed by the
user as soon as possible. Use the <SPAN  CLASS="textit">chage</SPAN>(8) command with the <TT>-d</TT>
option to set the last password change date to a value where the user
will be reminded to change the password. The RECOMMENDED value is
based on the settings in <SPAN  CLASS="textit">/etc/login.defs</SPAN> and is equivalent to
today's date plus PASS_WARN_AGE minus PASS_MAX_DAYS.

<P>
Example:

<P>
<PRE>
        useradd -m -c "John Doe" jdoe
        passwd jdoe
        chage -d $(date +%F -d "53 days ago") jdoe
</PRE>

<P>
The <TT>-m</TT> option to <SPAN  CLASS="textit">useradd</SPAN>(8) creates a home directory for the
user based on a copy of the contents of the <SPAN  CLASS="textit">/etc/skel/</SPAN>
directory. Note that you MAY modify some default configuration settings for
users, such as the default <SPAN  CLASS="textit">umask</SPAN>(2) setting or time zone, by
editing the corresponding global configuration files:

<P>
<PRE>
        /etc/profile
        /etc/bashrc
        /etc/csh.cshrc
</PRE>

<P>
The optional setting of labels and roles is discussed in &#167;<A HREF="#Defining_user_roles_and_MLS_levels_MLS_mode_only_">4.9.8</A> Defining user roles and MLS levels
(MLS mode only).

<P>

<H2><A NAME="SECTION00592000000000000000"></A><A NAME="Changing_user_passwords"></A><A NAME="807"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">2</SPAN> Changing user passwords
</H2>

<P>
If necessary, you MAY reset the user's password to a known value using
<TT>passwd <SPAN  CLASS="textit">USER</SPAN></TT>, and entering the new password. You cannot recover the
previously used password, since the hash function used is not reversible.

<P>

<H2><A NAME="SECTION00593000000000000000"></A><A NAME="SSH_key-based_authentication"></A><A NAME="810"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">3</SPAN> SSH key-based authentication
</H2>

<P>
The TOE allows the configuration of key-based authentication for SSH. Key-based
authentication is configured on a per-user basis by managing the file
<SPAN  CLASS="textit">.ssh/authorized_keys</SPAN> in the home directory of a user. For information
on how to use that file, see sshd(8).

<P>
To generate DSA or RSA keys that can be used for key-based authentication,
the tool <SPAN  CLASS="textit">ssh-keygen</SPAN>(8) is provided. As the SSH daemon only accepts SSH 
protocol version 2, only the protocol 2 keys are supported with the SSH daemon.
Therefore, you MUST only use the option <TT>-t rsa</TT> or <TT>-t dsa</TT> when
generating a key with <SPAN  CLASS="textit">ssh-keygen</SPAN>.

<P>
Please note that account locking does not prevent users to log onto the
system with SSH key-based authentication.

<P>

<H2><A NAME="SECTION00594000000000000000"></A><A NAME="Changing_user_properties"></A><A NAME="817"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">4</SPAN> Changing user properties
</H2>

<P>
You MAY use the <SPAN  CLASS="textit">usermod</SPAN>(8) command to change a user's properties.

<P>

<H2><A NAME="SECTION00595000000000000000"></A><A NAME="Locking_and_unlocking_user_accounts"></A><A NAME="820"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">5</SPAN> Locking and unlocking user accounts
</H2>

<P>
Users MAY be locked out (disabled) using <TT>passwd -l <SPAN  CLASS="textit">USER</SPAN></TT>, and re-enabled
using <TT>passwd -u <SPAN  CLASS="textit">USER</SPAN></TT>. Note that this locking only prevents password-based
authentication attempts. SSH key-based authentication is unaffected by using
<TT>passwd -l</TT>. To prevent SSH key-based logins, the file <SPAN  CLASS="textit">.ssh/authorized_keys</SPAN>
located in the home directory of the user MUST be removed.

<P>
The <SPAN  CLASS="textit">pam_faillock.so</SPAN> PAM module enforces automatic lockout after
excessive failed authentication attempts.
Use the program <SPAN  CLASS="textit">faillock</SPAN> to view and reset the counter if
necessary, as documented in the man page <SPAN  CLASS="textit">faillock</SPAN>(8).
Note that the <SPAN  CLASS="textit">pam_faillock</SPAN> mechanism does not <SPAN  CLASS="textit">prevent</SPAN> password
guessing attacks, it only prevents <SPAN  CLASS="textit">use</SPAN> of the account after such an
attack has been detected. Therefore, you MUST assign a new password for
the user before reactivating an account. For example:

<P>
<PRE>
        # view the current counter value
        faillock --user jdoe
</PRE>
<PRE>
        # set new password, and reset the counter
        passwd jdoe
        faillock --user jdoe --reset
</PRE>

<P>
The <SPAN  CLASS="textit">chage</SPAN>(1) utility MAY be used to view and modify the expiry settings for
user accounts. Unprivileged users are able to view but not modify their own
expiry settings.

<P>

<H2><A NAME="SECTION00596000000000000000"></A><A NAME="Removing_users"></A><A NAME="837"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">6</SPAN> Removing users
</H2>

<P>
The <SPAN  CLASS="textit">userdel</SPAN>(8) utility removes the user account from the system, but does
not remove files outside the home directory (and the mail spool file), or
kill processes belonging to this user.  Use <TT>kill</TT> (or reboot the system)
and <TT>find</TT> to do so manually if necessary, for example:

<P>
<PRE>
        # Which user to delete?
        U=jdoe
</PRE>
<PRE>
        # Lock user account, but don't remove it yet
        passwd -l $U
</PRE>
<PRE>
        # Kill all user processes, repeat if needed (or reboot)
        killall -u $U
</PRE>
<PRE>
        # Recursively remove all files and directories belonging to user
        # (Careful - this may delete files belonging to others if they
        # are stored in a directory owned by this user.)
        # Use the applicable file system type for your system.
        find / -depth \( ! -fstype ext3 -prune -false \) \
                -o -user $U -exec rm -rf {} \;
</PRE>
<PRE>
        # Remove cron jobs
        crontab -u $U -r
</PRE>
<PRE>
        # Now delete the account
        userdel $U
</PRE>

<P>
Please note that similar concerns apply when a group is removed. The
administrator MUST ensure that the files associated with the group are
reassigned to other groups or deleted. In addition, the administrator
MUST handle the processes currently executing with the deleted group.

<P>
In addition, the administrator should consider that the user ID or group ID
may be used in ACLs where these ACLs should be checked for their validity.

<P>
If you need to create additional groups or modify or delete existing
groups, use the <SPAN  CLASS="textit">groupadd</SPAN>(8), <SPAN  CLASS="textit">groupmod</SPAN>(8) and <SPAN  CLASS="textit">groupdel</SPAN>(8)
commands.

<P>
You MAY assign group passwords and allow use of the <SPAN  CLASS="textit">newgrp</SPAN>(8)
program to change groups. Note that the <SPAN  CLASS="textit">gpasswd</SPAN>(1) program will
only work when run at <SPAN  CLASS="textit">SystemLow</SPAN> level.

<P>

<H2><A NAME="SECTION00597000000000000000"></A><A NAME="Defining_administrative_accounts"></A><A NAME="860"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">7</SPAN> Defining administrative accounts
</H2>

<P>
Administrative users MUST be member of the <SPAN  CLASS="textit">wheel</SPAN> group. Specify the
<TT>-G wheel</TT> option for the <SPAN  CLASS="textit">useradd</SPAN>(8) command when creating
administrative users.

<P>
You MAY also use the <SPAN  CLASS="textit">usermod</SPAN>(8) command to change group membership.
For example, if you want to add the user 'jdoe' to the <SPAN  CLASS="textit">wheel</SPAN> group,
you could use the following:

<P>
<PRE>
        # List the groups the user is currently a member of:
        groups jdoe
</PRE>
<PRE>
        # Add the additional group
        usermod -G $(groups jdoe | sed 's/.*: //; s/ /,/g'),wheel jdoe
</PRE>

<P>
In MLS mode, administrative users MUST also be assigned to the
<SPAN  CLASS="textit">staff_u</SPAN> user class, and MUST be assigned to one or more
administrative roles. The <SPAN  CLASS="textit">staff_u</SPAN> user class gives permission to
use the <SPAN  CLASS="textit">sysadm_r</SPAN>, <SPAN  CLASS="textit">secadm_r</SPAN>, and <SPAN  CLASS="textit">auditadm_r</SPAN> roles in addition
to the default <SPAN  CLASS="textit">staff_r</SPAN> role. Use the following steps to define an
administrative user in MLS mode:

<P>
<PRE>
        useradd -m -c "John Doe" -G wheel jdoe
        passwd jdoe
        chage -m 1 -M 60 -W 7 jdoe
        semanage login -a -s staff_u -r SystemLow-SystemHigh jdoe
        restorecon -r /home/jdoe
</PRE>
<H2><A NAME="SECTION00598000000000000000"></A><A NAME="Defining_user_roles_and_MLS_levels_MLS_mode_only_"></A><A NAME="879"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN>.<SPAN CLASS="arabic">8</SPAN> Defining user roles and MLS levels (MLS mode only)
</H2>

<P>
In MLS mode, use the <SPAN  CLASS="textit">semanage</SPAN>(8) program to assign SELinux user
classes, roles, and MLS levels to users.

<P>
Here is an example of creating a nonadministrative user class with
permission to access a range of MLS levels, then creating two users
and assigning different clearances within that range to these users:

<P>
<PRE>
        semanage user -a -R user_r -r s0-s4:c100.c299 -P user op_u
</PRE>
<PRE>
        useradd -m op1
        useradd -m op2
        passwd op1
        passwd op2
        chage -m 1 -M 60 -W 7 op1
        chage -m 1 -M 60 -W 7 op2
</PRE>
<PRE>
        semanage login -a -s op_u -r s0-s2:c150.c159 op1
        semanage login -a -s op_u -r s0-s3:c130.c249 op2
</PRE>

<P>
Please refer to the <SPAN  CLASS="textit">semanage</SPAN>(8) man page for more information about this program.

<P>
Section &#167;<A HREF="#Creating_a_custom_role_MLS_mode_only_">4.17.3</A> "Creating a
custom role (MLS mode only)" of this guide contains a more detailed
example which includes defining a custom role and associated rights.

<P>

<H1><A NAME="SECTION005100000000000000000"></A><A NAME="Using_serial_terminals"></A><A NAME="890"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">10</SPAN> Using serial terminals
</H1>

<P>
You MAY attach serial terminals to the system for use by system
administrators.

<P>
Serial terminals are activated by adding an entry in the file
<SPAN  CLASS="textit">/etc/inittab</SPAN> for each serial terminal that causes <SPAN  CLASS="textit">init</SPAN>(8) to
launch an <SPAN  CLASS="textit">agetty</SPAN>(8) process to monitor the serial line. <SPAN  CLASS="textit">agetty</SPAN>
runs <SPAN  CLASS="textit">login</SPAN>(1) to handle user authentication and set up the user's
session.

<P>
If you use serial terminals and require the MLS-compliant fail-safe
audit mode, you MUST ensure that the file <SPAN  CLASS="textit">/etc/pam.d/login</SPAN> is
configured to use the <SPAN  CLASS="textit">require_auditd</SPAN> option for the
<SPAN  CLASS="textit">pam_loginuid.so</SPAN> module in the <TT>session</TT> stack.

<P>
For example, adding the following line to <SPAN  CLASS="textit">/etc/inittab</SPAN> activates a
VT102-compatible serial terminal on serial port /dev/ttyS1,
communicating at 19200 bits/s:

<P>
<PRE>
        S1:3:respawn:/sbin/agetty 19200 ttyS1 vt102
</PRE>

<P>
The first field MUST be an unique identifier for the entry (typically
the last characters of the device name). Please refer to the
<SPAN  CLASS="textit">agetty</SPAN>(8) and <SPAN  CLASS="textit">inittab</SPAN>(5) man pages for further information about
the format of entries.

<P>
You MUST reinitialize the <SPAN  CLASS="textit">init</SPAN> daemon after any changes to
<SPAN  CLASS="textit">/etc/inittab</SPAN> by running the following command:

<P>
<PRE>
        init q
</PRE>
<H1><A NAME="SECTION005110000000000000000"></A><A NAME="Managing_data_objects"></A><A NAME="910"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">11</SPAN> Managing data objects
</H1>

<H2><A NAME="SECTION005111000000000000000"></A><A NAME="Revoking_access"></A><A NAME="912"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">11</SPAN>.<SPAN CLASS="arabic">1</SPAN> Revoking access
</H2>

<P>
As with most operating systems, access rights are checked only once,
when the object is first accessed by the process. If the initial
permission check was successful, read and/or write operations are
permitted indefinitely without further checking, even if the access
rights to the object are changed or revoked.

<P>
If this delayed revocation is not acceptable to you and you need to
definitely ensure that no user processes are accessing an object after
you have changed the access rights to that object, you MUST reboot the
system. This ensures that no processes have open descriptors which
could permit continued access.

<P>

<H2><A NAME="SECTION005112000000000000000"></A><A NAME="SYSV_shared_memory_and_IPC_objects"></A><A NAME="914"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">11</SPAN>.<SPAN CLASS="arabic">2</SPAN> SYSV shared memory and IPC objects
</H2>

<P>
The system supports SYSV-compatible shared memory, IPC objects, and message
queues. If programs fail to release resources they have used (for example, due to a
crash), the administrator MAY use the <SPAN  CLASS="textit">ipcs</SPAN>(8) utility to list information
about them, and <SPAN  CLASS="textit">ipcrm</SPAN>(8) to force deletion of unneeded objects. Note that
these resources are also released when the system is rebooted.

<P>
For additional information, please refer to the <SPAN  CLASS="textit">msgctl</SPAN>(2), <SPAN  CLASS="textit">msgget</SPAN>(2),
<SPAN  CLASS="textit">msgrcv</SPAN>(2), <SPAN  CLASS="textit">msgsnd</SPAN>(2), <SPAN  CLASS="textit">semctl</SPAN>(2), <SPAN  CLASS="textit">semget</SPAN>(2), <SPAN  CLASS="textit">semop</SPAN>(2),
<SPAN  CLASS="textit">shmat</SPAN>(2), <SPAN  CLASS="textit">shmctl</SPAN>(2), <SPAN  CLASS="textit">shmdt</SPAN>(2), <SPAN  CLASS="textit">shmget</SPAN>(2) and <SPAN  CLASS="textit">ftok</SPAN>(3) manual
pages.

<P>

<H2><A NAME="SECTION005113000000000000000"></A><A NAME="Posix_Message_Queues"></A><A NAME="930"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">11</SPAN>.<SPAN CLASS="arabic">3</SPAN> Posix Message Queues
</H2>

<P>
POSIX message queues are supported as an alternative to SYSV message
queues. Users and administrators MAY use the system calls and
corresponding library functions documented in the <SPAN  CLASS="textit">mq_overview</SPAN>(7)
man page, such as <SPAN  CLASS="textit">mq_open</SPAN>(2) and <SPAN  CLASS="textit">mq_unlink</SPAN>(2).

<P>
The message queue filesystem (type <SPAN  CLASS="textit">mqueue</SPAN>) MAY be mounted in case
filesystem-based access to POSIX message queues is requested.

<P>

<H1><A NAME="SECTION005120000000000000000"></A><A NAME="Configuring_object_access_rights"></A><A NAME="936"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">12</SPAN> Configuring object access rights
</H1>

<P>
Administrators MAY use the <SPAN  CLASS="textit">chown</SPAN>(1), <SPAN  CLASS="textit">chgrp</SPAN>(1), and <SPAN  CLASS="textit">chmod</SPAN>(1)
tools to configure DAC access rights in Base and MLS mode. You MUST
NOT grant additional access to objects that are part of the evaluated
configuration.

<P>
In MLS mode, administrators MAY use the <SPAN  CLASS="textit">chcon</SPAN>(1) tool to change
the MLS level and SELinux type of objects. You MUST NOT grant
additional access to objects that are part of the evaluated
configuration. The <SPAN  CLASS="textit">chcat</SPAN>(8) tool is unsuitable for MLS mode and
MUST NOT be used.

<P>
Please refer to the respective man pages for more information about
these tools.

<P>

<H1><A NAME="SECTION005130000000000000000"></A><A NAME="Setting_the_system_time_and_date"></A><A NAME="943"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">13</SPAN> Setting the system time and date
</H1>

<P>
You MUST verify periodically that the system clock is sufficiently
accurate, otherwise log and audit files will contain misleading
information.  When starting the system, the time and date are copied
from the computer's hardware clock to the kernel's software clock, and
written back to the hardware clock on system shutdown.

<P>
All internal dates and times used by the kernel, such as file
modification stamps, use universal time (UTC), and do not depend on
the current time zone settings. Userspace utilities usually adjust
these values to the currently active time zone for display. Note that
text log files will contain ASCII time and date representations in
local time, often without explicitly specifying the time zone.

<P>
The <SPAN  CLASS="textit">date</SPAN>(1) command displays the current time and date, and can be
used by administrators to set the software clock, using the argument
<SPAN  CLASS="textit">mmddHHMMyyyy</SPAN> to specify the numeric month, day, hour, minute and
year respectively. For example, the following command sets the clock
to May 1st 2004, 1pm in the local time zone:

<P>
<PRE>
        date 050113002004
</PRE>

<P>
The <SPAN  CLASS="textit">hwclock</SPAN>(8) can query and modify the hardware clock on supported
platforms, but may not available in virtual environments.
The typical use is to copy the current value of the software
clock to the hardware clock. Note that the hardware clock MAY be
running in either local time or universal time, as indicated by the
<SPAN  CLASS="textit">UTC</SPAN> setting in the <SPAN  CLASS="textit">/etc/sysconfig/clock</SPAN> file. The following
command sets the hardware clock to the current time using UTC:

<P>
<PRE>
        hwclock -u -w
</PRE>

<P>
Use the command <SPAN  CLASS="textit">tzselect</SPAN>(8) to change the default time zone for the
entire system. Note that users MAY individually configure a different
time zone by setting the <SPAN  CLASS="textit">TZ</SPAN> environment variable appropriately in
their shell profile, such as the <SPAN  CLASS="textit">$HOME/.bashrc</SPAN> file.

<P>

<H1><A NAME="SECTION005140000000000000000"></A><A NAME="Firewall_configuration"></A><A NAME="957"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">14</SPAN> Firewall configuration
</H1>

<P>
You MAY enable, reconfigure, or disable the builtin network firewall
as required. RHEL allows the following types of firewall configuration
to control traffic:

<P>

<UL>
<LI><P>
The packet filtering of IP, TCP, UDP, ICMP protocols is implemented with the
<TT>iptables</TT> command which uses kernel support for controlling traffic.
Iptables can be used to set up very small and lean packet filter rules. On the
other hand, very complex and sophisiticated filtering rules can be configured
as well to suit the need of the administrator. An elaborate introduction is
given in the Red Hat Enterprise Linux 6 Security Guide section 2.6 accessible
at <SPAN  CLASS="textsf">http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/index.html</SPAN>.
In addition, <SPAN  CLASS="textit">iptables</SPAN>(8) discusses use of the application.

<P>
</LI>
<LI><P>
RHEL allows the configuration of virtual machines using the KVM
functionality and connects the guest software with external networks using
the Linux kernel's bridging functionality. As the bridging functionality is
enforced at Ethernet layer, the Linux kernel does not engage its TCP/IP stack
for packets travelling through the bridge to received by either some KVM
guest software or remote systems. RHEL provides a packet filter mechanism
for filtering packets at the Ethernet layer using the <TT>ebtables</TT> functionality.
The man page <SPAN  CLASS="textit">ebtables</SPAN>(8) discusses the concept as well as the use
of the packet filter.

<P>
</LI>
</UL>
<H2><A NAME="SECTION005141000000000000000"></A><A NAME="iptables_auditing_of_packet_filter_operations"></A><A NAME="966"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">14</SPAN>.<SPAN CLASS="arabic">1</SPAN> iptables auditing of packet filter operations
</H2>

<P>
Iptables is extended by an <SPAN  CLASS="textit">AUDIT</SPAN> target that conceptually works
similar to the <SPAN  CLASS="textit">LOG</SPAN> target documented in <SPAN  CLASS="textit">iptables</SPAN>(8).

<P>
This target allows the logging of matching packets with the audit
facility. When this option is set for a rule, the Linux kernel will
generate an audit entry for each matching packet which holds details
about the packet depending on the protocol of the packet.

<P>
Data that is always logged includes the action applied to the packet
(<SPAN  CLASS="textit">action=</SPAN> audit information), the inbound interface (<SPAN  CLASS="textit">inif=</SPAN>),
and the outbound interface (<SPAN  CLASS="textit">outif=</SPAN>).

<P>
If the matched packet from the ARP layer, the source (<SPAN  CLASS="textit">smac=</SPAN>) and
destination (<SPAN  CLASS="textit">dmac=</SPAN>) MAC address as well as the protocol type
(<SPAN  CLASS="textit">macproto=</SPAN>) is logged.

<P>
When using the target with IPv4 and IPv6 packets, the source (<SPAN  CLASS="textit">saddr=</SPAN>)
and destination (<SPAN  CLASS="textit">daddr=</SPAN>) IP address, as well as the protocol type
(<SPAN  CLASS="textit">proto=</SPAN>) is logged. In addition, the audit trail identifies whether
the packet is truncated (<SPAN  CLASS="textit">truncate=1</SPAN>) or whether it is fragmented
(<SPAN  CLASS="textit">frag=1</SPAN>).

<P>
In case the IP packet encapsulates TCP or UDP data, the source
(<SPAN  CLASS="textit">sport=</SPAN>) and destination (<SPAN  CLASS="textit">dport=</SPAN>) port information is audited.

<P>
If the IP packet encapsulates ICMP data, the ICMP type (<SPAN  CLASS="textit">icmptype=</SPAN>)
and the ICMP code (<SPAN  CLASS="textit">icmpcode=</SPAN>) is logged.

<P>
The following option is allowed with the <SPAN  CLASS="textit">AUDIT</SPAN> target:

<P>

<UL>
<LI><P>
<TT>-type</TT> <SPAN  CLASS="textit">type</SPAN> sets the action type to be audited. Valid options are either <SPAN  CLASS="textit">accept</SPAN>, <SPAN  CLASS="textit">drop</SPAN>, or <SPAN  CLASS="textit">reject</SPAN>.

<P>
</LI>
</UL>
<H2><A NAME="SECTION005142000000000000000"></A><A NAME="ebtables_auditing_of_packet_filter_operations"></A><A NAME="994"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">14</SPAN>.<SPAN CLASS="arabic">2</SPAN> ebtables auditing of packet filter operations
</H2>

<P>
Similarly to iptables, ebtables is extended by an <SPAN  CLASS="textit">AUDIT</SPAN> watcher. The
implementation of the <SPAN  CLASS="textit">AUDIT</SPAN> watcher for ebtables is identical to the
<SPAN  CLASS="textit">AUDIT</SPAN> target of the iptables mechanism.

<P>
This watcher allows the logging of matching frames with the audit
facility. When this option is set for a rule, the Linux kernel will
generate an audit entry for each matching frame which holds details
about the frame depending on the contents of the frame.

<P>
The audit trail generated by the <SPAN  CLASS="textit">AUDIT</SPAN> watcher is identical to the
information specified in &#167;<A HREF="#iptables_auditing_of_packet_filter_operations">4.14.1</A>
"iptables auditing of packet filter operations".

<P>
Also, the options allowed with the <SPAN  CLASS="textit">AUDIT</SPAN> watcher are identical to the
listed options specified in &#167;<A HREF="#iptables_auditing_of_packet_filter_operations">4.14.1</A>
"iptables auditing of packet filter operations".

<P>

<H2><A NAME="SECTION005143000000000000000"></A><A NAME="KVM_ARP_spoofing_and_poisoning_prevention"></A><A NAME="1003"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">14</SPAN>.<SPAN CLASS="arabic">3</SPAN> KVM ARP spoofing and poisoning prevention
</H2>

<P>
The <TT>libvirtd</TT> virtual machine management daemon allows the configuration
of of an ARP spoofing and poisoning prevention schema. When enabling this
configuration for a virtual machine, only outgoing communication with a
source ARP and IP addresses that is configured for the virtual machine is allowed.
Conversely, for inbound communication to a virtual machine, the communication
must have the destination ARP and IP addresses of the virtual machine
as set by <TT>libvirtd</TT>.

<P>
<TT>libvirtd</TT> uses the <TT>ebtables</TT> and <TT>iptables</TT> commands to set up the
protection mechanism.

<P>
The support is enabled with the following XML setting that can either be
set in the XML configuration file for a virtual machine or sent to <TT>libvirtd</TT>:

<P>
<PRE>
    &lt;interface type='network'&gt;
       ...
       &lt;mac address='aa:bb:cc:dd:ee:ff'/&gt;
       &lt;ip address='1.2.3.4'/&gt;
       &lt;filterref filter='clean-traffic'/&gt;
       ...
    &lt;/interface&gt;
</PRE>

<P>
You MUST specify the MAC address and IP address to be assigned to the virtual
machine. <TT>libvirtd</TT> will invoke QEMU with the MAC address which in turn
is handed off to the guest operating system. The IP address is set by either
the <TT>dnsmasq</TT> DNS server or must be manually configured with the guest
operating system.

<P>
To ensure that the virtual machine communication is fully protected against
ARP spoofing and poisoning attacks, the administrator MUST consider the following
requirement. Even when only one virtual machine is deemed critical and
ARP spoofing and poisoning preventioning support shall be configured for
this particular virtual machine only, the following MUST be configured:
All virtual machines that execute on the host must have the above configuration
set. This ensures that the ARP tables of other guest systems cannot be altered
by another virtual machine.

<P>
Background information on the ARP spoofing and poisoning protection schema
can be found at <SPAN  CLASS="textsf">http://berrange.com/posts/2011/10/03/guest-mac-spoofing-denial-of-service-and-preventing-it-with-libvirt-and-kvm/</SPAN>.

<P>

<H1><A NAME="SECTION005150000000000000000"></A><A NAME="Screen_saver_configuration"></A><A NAME="1016"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN> Screen saver configuration
</H1>

<P>
The <TT>screen</TT> application is used to provide a locking mechanism of the
current terminal for every user. The <TT>screen</TT> locking is invoked by
the following means:

<P>

<UL>
<LI><P>
The locking is executed automatically after a period of inactivity on the
terminal defined by a timeout in either <SPAN  CLASS="textit">/etc/screenrc</SPAN> or <SPAN  CLASS="textit"><TT>~</TT>/.screenrc</SPAN>
using the <SPAN  CLASS="textit">lockscreen</SPAN> configuration value.

<P>
</LI>
<LI><P>
Every user can lock his screen by executing the <TT>C-a</TT> <TT>C-x</TT> screen key
binding combination.

<P>
</LI>
</UL>

<P>
You MAY change the timeout value for locking the session in <SPAN  CLASS="textit">/etc/screenrc</SPAN>
with the value for <SPAN  CLASS="textit">lockscreen</SPAN>.

<P>
Please note that users can modify the timeout by providing their own
<SPAN  CLASS="textit"><TT>~</TT>/.screenrc</SPAN>. You can disable the support for per-user configuration files
by invoking screen with the option of <SPAN  CLASS="textit">-c /dev/null</SPAN>.

<P>
To invoke <TT>screen</TT> automatically upon log in, you MAY enter the following
line to either <SPAN  CLASS="textit">/etc/bash_profile</SPAN> for system-wide enforcement or
<SPAN  CLASS="textit"><TT>~</TT>/.bash_profile</SPAN> for a per-user enforcement. Note that a user can change
<SPAN  CLASS="textit"><TT>~</TT>/.bash_profile</SPAN>.

<P>
<PRE>
       exec screen
</PRE>
<H1><A NAME="SECTION005160000000000000000"></A><A NAME="OpenSSH_configuration"></A><A NAME="1037"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">16</SPAN> OpenSSH configuration
</H1>

<P>
The evaluated configuration requires that keys generated for OpenSSH
applications including the <TT>sshd</TT> daemon, the <TT>ssh</TT> client application and
<TT>ssh-keygen</TT> must be generated using a random number generator that is
seeded with at least 48 bits of entropy.

<P>
OpenSSH uses the OpenSSL deterministic random number generator for
generating keys. This deterministic random number generator is
seeded by reading the seed from <SPAN  CLASS="textit">/dev/random</SPAN>. The seeding process is
described in the configuration file <SPAN  CLASS="textit">/etc/sysconfig/sshd</SPAN>.

<P>
Using <SPAN  CLASS="textit">/dev/random</SPAN> in the evaluated configuration deviates from the
default behavior of the OpenSSH applications which per default
employs <SPAN  CLASS="textit">/dev/urandom</SPAN>. The difference is
that <SPAN  CLASS="textit">/dev/random</SPAN> blocks until sufficient entropy is available to
satisfy the request for entropy. This implies that the OpenSSH applications
block when they seed or re-seed until the requested amount of entropy is
delivered.

<P>
The blocking may cause irritation by a user as the application seemingly
stalls without any notification. The administrator is advised to inform
the user base about this blocking behavior.

<P>
The blocking behavior is controlled with the environment variable
<SPAN  CLASS="textit">SSH_USE_STRONG_RNG</SPAN> which must be set according to the following rules:

<P>

<UL>
<LI><P>
For the <TT>sshd</TT>, the environment variable must be set in <SPAN  CLASS="textit">/etc/sysconfig/sshd</SPAN>.
After setting, the <TT>sshd</TT> daemon must be restarted using the start script.

<P>
</LI>
<LI><P>
For applications invoked by users, the file <SPAN  CLASS="textit">/etc/profile/cc-configuration.*sh</SPAN>
contains the setting of this environment variable for Bourne shell and
derivatives as well as C-shells and its derivatives.

<P>
</LI>
</UL>

<P>
In addition to the use of the proper random number generator, the AES-NI
support provided with OpenSSL must be deconfigured for the OpenSSH applications.
The AES-NI support was not subject to this current evaluation and can therefore
not be used to encrypt the communication channel. The AES-NI support is
disabled for OpenSSL by setting the <SPAN  CLASS="textit">OPENSSL_DISABLE_AES_NI</SPAN> environment
variable. The evaluated configuration already sets this environment
variable in <SPAN  CLASS="textit">/etc/sysconfig/sshd</SPAN> for the <TT>sshd</TT> daemon. Also, the
environment variable is set in <SPAN  CLASS="textit">/etc/profile.d/cc-configuration.*sh</SPAN>.

<P>

<H1><A NAME="SECTION005170000000000000000"></A><A NAME="SELinux_configuration"></A><A NAME="1058"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">17</SPAN> SELinux configuration
</H1>

<H2><A NAME="SECTION005171000000000000000"></A><A NAME="General_SELinux_configuration"></A><A NAME="1060"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">17</SPAN>.<SPAN CLASS="arabic">1</SPAN> General SELinux configuration
</H2>

<P>
In MLS mode, SELinux MUST be enabled and in enforcing mode, and MUST
use the "mls" policy. The <SPAN  CLASS="textit">/etc/selinux/config</SPAN> file MUST have the following
content:

<P>
<PRE>
        SELINUX=enforcing
        SELINUXTYPE=mls
</PRE>

<P>
In Base mode, the evaluated configuration keeps the SELinux system
enabled in a static configuration, but does not depend on SELinux for
any security features. You MAY modify the SELinux configuration, for
example to add additional restrictions.

<P>
In Base mode, the <SPAN  CLASS="textit">/etc/selinux/config</SPAN> file has the following
content by default:

<P>
<PRE>
        SELINUX=enforcing
        SELINUXTYPE=targeted
</PRE>

<P>
In Base mode, you MAY disable SELinux by using one of the settings
<TT>SELINUX=disabled</TT> or <TT>SELINUX=permissive</TT> instead, or configure a
different policy, but any additional restrictions added by SELinux are
beyond the scope of the Base configuration. (Note that reconfiguring
the SELinux policy is likely to affect your support contract
status. This is also beyond the scope of this document.)

<P>

<H2><A NAME="SECTION005172000000000000000"></A><A NAME="MLS_mode_specific_policy_module"></A><A NAME="1070"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">17</SPAN>.<SPAN CLASS="arabic">2</SPAN> MLS mode specific policy module
</H2>

<P>
The <SPAN  CLASS="textit">lspp_policy</SPAN> SELinux policy module adds permissions necessary
for correct system operation in MLS mode. You MAY customize some of
the settings in the <SPAN  CLASS="textit">/usr/share/selinux/devel/lspp_policy.te</SPAN> file as
indicated in the file comments:

<P>
<PRE>
        ## Customized SELinux policy for MLS evaluated configuration
</PRE>
<PRE>
        policy_module(cc_mls_policy,1.0)
</PRE>
<PRE>
        #############################################################################
        ### Additional audit
        #############################################################################
</PRE>
<PRE>
        gen_require(`
                attribute domain;
        ')
</PRE>
<PRE>
        # Audit setting of security relevant process attributes
        # These settings are OPTIONAL
        auditallow domain self:process setcurrent;
        auditallow domain self:process setexec;
        auditallow domain self:process setfscreate;
        auditallow domain self:process setsockcreate;
</PRE>

<P>
After any changes to this file, use the following steps to reload the module:

<P>
<PRE>
        cd /usr/share/selinux/devel/
</PRE>
<PRE>
        # as role "sysadm_r":
        make cc_mls_policy.pp
</PRE>
<PRE>
        semodule -i cc_mls_policy.pp
</PRE>
<H2><A NAME="SECTION005173000000000000000"></A><A NAME="Creating_a_custom_role_MLS_mode_only_"></A><A NAME="1090"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">17</SPAN>.<SPAN CLASS="arabic">3</SPAN> Creating a custom role (MLS mode only)
</H2>

<P>
This example shows how to create a "backup admin" role with the
privilege to read all files on the system, but no special write
privileges. This role could be used to perform system backups, but
without the risk of overwriting or modifying any system files.

<P>
The role created in this example is an administrative role. The people
assigned to this role are required to follow the same operational
rules as all administrators, and are also assumed to be fully trusted
not to undermine system security. The root password is needed to use
the role, but the actions available to the backup admin are limited
while using the role. For example, changing roles to "sysadm_r" is
denied when using an interactive ssh session. However, if the backup
admin has direct console access, the root password would permit
a login as "root" directly with unlimited administrative actions.

<P>
As a first step, define a SELinux policy module defining the role and
its privileges. Do the following steps as role "sysadm_r":

<P>
<PRE>
        ## role "sysadm_r"
</PRE>
<PRE>
        # change to the local policy directory
        cd /usr/share/selinux/devel
</PRE>
<PRE>
        # create the new policy module source
        cat &lt;&lt;-'_EOF'_ &gt; backupadm.te
                policy_module(backupadm,1.0)
</PRE>
<PRE>
                gen_require(`
                        role staff_r;
                        type staff_t, staff_devpts_t, staff_tty_device_t;
                ')
</PRE>
<PRE>
                # Define the role and domain
                userdom_unpriv_user_template(backupadm)
                role backupadm_r types backupadm_t;
</PRE>
<PRE>
                # Allow members of staff_r to transition to this role
                userdom_role_change_template(staff, backupadm)
</PRE>
<PRE>
                # grant DAC read override capability
                allow backupadm_t self:capability dac_read_search;
</PRE>
<PRE>
                # grant MLS read override capability
                mls_file_read_up(backupadm_t)
</PRE>
<PRE>
                # grant RBAC file read override capability
                files_read_all_files(backupadm_t)
        _EOF_
</PRE>
<PRE>
        # build binary policy module
        make backupadm.pp
</PRE>
<PRE>
        # Assign the default domain for the role
        echo "backupadm_r:backupadm_t" &gt;&gt;/etc/selinux/mls/contexts/default_type
</PRE>

<P>
If necessary, as "sysadm_r", create an administrative user account for
the user who will be using this role:

<P>
<PRE>
        ## role "sysadm_r"
        useradd -G wheel jdoe
        passwd jdoe
</PRE>

<P>
Insert the new policy module into the active policy:

<P>
<PRE>
        ## role "sysadm_r"
        semodule -i backupadm.pp
</PRE>

<P>
Now create a new SELinux user class with the right to use the new role
(but not any other administrative roles), and assign the user(s) to
this user class to give them the right to use the role:

<P>
<PRE>
        ## role "sysadm_r"
        semanage user -a -R "staff_r backupadm_r" -P backupadm backup_u
        semanage login -a -s backup_u -r SystemLow jdoe
</PRE>

<P>
To test the new role, log in as this user, "su" to root, and enter the new role:

<P>
<PRE>
        ssh jdoe@localhost
                /bin/su -
                newrole -r backupadm_r
</PRE>

<P>
Verify that you can read all files, but not modify any system files:

<P>
<PRE>
        ## user "jdoe", role "backupadm_r"
        cat /etc/shadow     # succeeds
        touch /etc/shadow   # fails
</PRE>

<P>
To delete the new role, first ensure that no users are mapped to this
role (the system will refuse to remove the module from the policy if
the role is in use), and remove the module:

<P>
<PRE>
        ## role "sysadm_r"
        semanage login -d jdoe
        semanage user -d backup_u
        semodule -r backupadm
</PRE>
<H2><A NAME="SECTION005174000000000000000"></A><A NAME="Defining_hierarchical_roles_MLS_mode_only_"></A><A NAME="1126"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">17</SPAN>.<SPAN CLASS="arabic">4</SPAN> Defining hierarchical roles (MLS mode only)
</H2>

<P>
Hierarchical roles MAY be defined using the <SPAN  CLASS="textit">dominates</SPAN> operator.

<P>
This example defines a <SPAN  CLASS="textit">root_r</SPAN> role that combines the rights of
<SPAN  CLASS="textit">sysadm_r</SPAN>, <SPAN  CLASS="textit">secadm_r</SPAN>, and <SPAN  CLASS="textit">auditadm_r</SPAN>:

<P>
<PRE>
        # as role "sysadm_r"
</PRE>
<PRE>
        cd /usr/share/selinux/devel
</PRE>
<PRE>
        ### set up the new policy module
        cat &lt;&lt;'_EOF_' &gt; root_role.te
                policy_module(root_role,1.0)
</PRE>
<PRE>
                gen_require(`
                        role sysadm_r, secadm_r, auditadm_r;
                ')
</PRE>
<PRE>
                # Define the role and domain
                userdom_admin_user_template(rootuser)
</PRE>
<PRE>
                # Allow members of staff_r to transition to this role
                userdom_role_change_template(staff, rootuser)
</PRE>
<PRE>
                # define new role in terms of existing roles
                dominance { role rootuser_r {
                     role sysadm_r;
                     role secadm_r;
                     role auditadm_r;
                } }
        _EOF_
</PRE>
<PRE>
        # build binary policy module
        make root_role.pp
</PRE>

<P>
If necessary, as "sysadm_r", create an administrative user account for
the user who will be using this role:

<P>
<PRE>
        ## role "sysadm_r"
        useradd -G wheel jdoe
        passwd jdoe
</PRE>

<P>
Insert the new policy module into the active policy:

<P>
<PRE>
        ## role "sysadm_r"
        semodule -i root_role.pp
</PRE>

<P>
Now create a new SELinux user class with the right to use the new role
(but not any other administrative roles), and assign the user(s) to
this user class to give them the right to use the role:

<P>
Now assign the new role to a user:

<P>
<PRE>
        ## role "sysadm_r"
        semanage user -a -R "staff_r rootuser_r" -P staff rootuser_u
        semanage login -a -s rootuser_u jdoe
</PRE>

<P>
The new administrative user may then switch freely among the
subsidiary roles without having to list these roles separately in the
login mapping:

<P>
<PRE>
        # as user in "root_u" class:
        newrole -r auditadm_r
</PRE>

<P>
Changes to the <SPAN  CLASS="textit">root_r</SPAN> role definition, such as adding new
subsidiary roles, will automatically change the rights of all users in
this class.

<P>

<H1><A NAME="SECTION005180000000000000000"></A><A NAME="Labeled_networking_MLS_mode_only_"></A><A NAME="1158"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">18</SPAN> Labeled networking (MLS mode only)
</H1>

<P>
In MLS mode, you MUST use one of the two available labeled networking
mechanisms to ensure that the data flow restrictions are properly
enforced when using networking related system call interfaces.

<P>

<H2><A NAME="SECTION005181000000000000000"></A><A NAME="IPSec_labeled_networking"></A><A NAME="1160"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">18</SPAN>.<SPAN CLASS="arabic">1</SPAN> IPSec labeled networking
</H2>

<P>
Setting up IPSec is described in the <SPAN  CLASS="textit">ipsec</SPAN>(8), <SPAN  CLASS="textit">ipsec.conf</SPAN>(5),
and <SPAN  CLASS="textit">ipsec.secrets</SPAN>(5) man pages.

<P>
The encryption and authentication properties of IPSec are beyond the
scope of this guide and evaluation. It is concerned only with the use
of IPSec to transport MLS labels.

<P>
Be aware that the labeled IPSec configuration may result in being
unable to access the system using the network. It is RECOMMENDED to do
this when logged in at the local system console.

<P>
You MUST either define a pre-shared key for each system that will communicate
using labeled IPSec or use certificates as documented in <SPAN  CLASS="textit">ipsec.secrets</SPAN>(5).

<P>
To label a particular IPSec communication channel with one particular label,
the keyword "policy_label=" is to be used in the <TT>pluto</TT> configuration file
of <SPAN  CLASS="textit">/etc/ipsec.d/ipsec.conf</SPAN>. The security label specified in <SPAN  CLASS="textit">ipsec.conf</SPAN>
is associated with IPsec policies in the Security Policy Database (SPD).
This Policy label is not exchanged between IKE peers. Security label
associated with traffic stream is associated with IPsec SAs, and this label
is exchanged in IKE messages. The traffic stream security label obtained
from remote IPsec peer is verified against the local policy label using
SElinux APIs. There can be multiple SA labels (traffic streams each with
its own security label different from others) associated with one policy
label. SA labels should comply with policy label, otherwise SA establishment
will not succeed.

<P>
After the configuration, you MUST enable the configuration by triggering an
SA establishment using the following command:

<P>
<PRE>
        ipsec auto --route &lt;conn-name&gt;
</PRE>

<P>
where <SPAN  CLASS="textit">conn-name</SPAN> is the label of the connection specified in <SPAN  CLASS="textit">ipsec.conf</SPAN>.

<P>
The following example describes how to set up labeled IPSec between
two machines with IP addresses 172.16.2.55 and 172.16.2.66.

<P>
On both systems, create the file <SPAN  CLASS="textit">/etc/ipsec.secrets</SPAN> containing
either pre-shared secret keys, or certificates as discussed in
<SPAN  CLASS="textit">ipsec.secrets</SPAN>(5).

<P>
On the machine with the IP address of 172.16.2.55, create the file
<SPAN  CLASS="textit">/etc/ipsec.d/ipsec.conf</SPAN> with the following contents:

<P>
<PRE>
    conn label
        auto=add
        authby=secret
        type=transport
        left=172.16.2.55
        right=172.16.2.66
        ike=3des-sha1
        phase2=ah
        phase2alg=sha1
        labeled_ipsec=yes
        policy_label=system_u:object_r:ipsec_spd_t:s0-s15:c0.c1023
</PRE>

<P>
Conversely, on the machine with the IP address of 172.16.2.66, create the
file <SPAN  CLASS="textit">/etc/ipsec.d/ipsec.conf</SPAN> with the following contents:

<P>
<PRE>
    conn label
        auto=add
        authby=secret
        type=transport
        left=172.16.2.66
        right=172.16.2.55
        ike=3des-sha1
        phase2=ah
        phase2alg=sha1
        labeled_ipsec=yes
        policy_label=system_u:object_r:ipsec_spd_t:s0-s15:c0.c1023
</PRE>

<P>
Please set the contents of the "policy_label=" configuration value to the
appropriate SELinux label that you want to associate with the connection.

<P>
Then trigger an SA establishment as outlined above. Note, the SA may
be set up at start time of <TT>pluto</TT> when using the configuration of
<SPAN  CLASS="textit">auto=route</SPAN> instead of <SPAN  CLASS="textit">auto=add</SPAN>. For more information, please
see the referenced man pages.

<P>
To disable labeled networking and resume unlabeled networking
operations, disable the <TT>pluto</TT> daemon.

<P>

<H2><A NAME="SECTION005182000000000000000"></A><A NAME="CIPSO_labeled_networking"></A><A NAME="1185"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">18</SPAN>.<SPAN CLASS="arabic">2</SPAN> CIPSO labeled networking
</H2>

<P>
Use the following commands to activate CIPSO labeled networking:

<P>
<PRE>
        netlabelctl cipsov4 add pass doi:1 tags:1
        netlabelctl map del default
        netlabelctl map add default protocol:cipsov4,1
        netlabelctl unlbl accept off
</PRE>

<P>
Be aware that the <TT>unlbl accept off</TT> configuration may result in
being unable to access the system using the network. It is RECOMMENDED
to do this when logged in at the local system console.

<P>
You MAY define other DOI settings as defined in the <SPAN  CLASS="textit">netlabelctl</SPAN>(8)
man page.

<P>
Use the following commands to disable CIPSO labeled networking:

<P>
<PRE>
        netlabelctl unlbl accept on
        netlabelctl map del default
        netlabelctl map add default protocol:unlbl
</PRE>
<H2><A NAME="SECTION005183000000000000000"></A><A NAME="xinetd_configuration_for_labeled_networking"></A><A NAME="1193"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">18</SPAN>.<SPAN CLASS="arabic">3</SPAN> xinetd configuration for labeled networking
</H2>

<P>
When labeled networking is enabled (using either CIPSO or labeled
IPSEC), you MUST disable <SPAN  CLASS="textit">sshd</SPAN> on the default port 22 by issuing the
following command:

<P>
<PRE>
        chkconfig sshd off
</PRE>

<P>
SSH sessions established by users will automatically run at the level
corresponding to the label of the network data. By default, the label
aware <SPAN  CLASS="textit">sshd</SPAN> instance runs on TCP port 222, you MAY change the port
number by editing the <SPAN  CLASS="textit">/etc/xinetd.d/sshd-mls</SPAN> file, for example by
setting <TT>port=22</TT> to replace the disabled non-label-aware
<SPAN  CLASS="textit">sshd</SPAN>. You MUST register the port number using the following
command (using the appropriate port number instead of "222"):

<P>
<PRE>
        semanage port -a -t ssh_port_t -p tcp 222
</PRE>

<P>
The <SPAN  CLASS="textit">sshd</SPAN> server will enforce that the requested level is within the
permitted range for that user, but cannot control any information flow
happening within the <SPAN  CLASS="textit">ssh</SPAN> client itself. You MUST activate labeled
networking to help ensure proper labeling of information across the
system boundary.

<P>
During the configuration of labeled networking you MUST disable the
non-label-aware stand-alone <SPAN  CLASS="textit">sshd</SPAN> daemon. Failure to disable this
daemon implies that users can change labels and therefore establish
a communication path between labels, violating the MLS rules.

<P>

<H1><A NAME="SECTION005190000000000000000"></A><A NAME="Remote_audit_configuration"></A><A NAME="1207"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">19</SPAN> Remote audit configuration
</H1>

<P>
The audit mechanism supports a configuration where audit data is stored
with a remote server. The <TT>auditd</TT> daemon uses the services of the
<TT>audispd</TT> daemon. That daemon in turn uses the services of
<TT>audisp-remote</TT> which handles the offloading of data to a remote server.

<P>
In addition to the support for submitting audit data to remote systems,
the <TT>auditd</TT> daemon can be configured to listen on the network to receive
audit data from a remote <TT>audisp-remote</TT> application.

<P>
Please note that the yet disabled configuration for receiving data shipped
with the evaluated configuration is synchronized with the disabled and
shipped configuration for the submission of audit data. You MAY
use the given configuration examples for a valid configuration of the
sending and receiving endpoints.

<P>

<H2><A NAME="SECTION005191000000000000000"></A><A NAME="Configuration_of_sending_audit_data"></A><A NAME="1214"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">19</SPAN>.<SPAN CLASS="arabic">1</SPAN> Configuration of sending audit data
</H2>

<P>
The configuration for sending audit data to a remote <TT>auditd</TT> daemon
is performed by performing the following configurations:

<P>

<UL>
<LI><P>
Configure the use of the <TT>audispd</TT> daemon by <TT>auditd</TT>: enable the
configuration value <SPAN  CLASS="textit">dispatcher</SPAN> to point to <TT>audispd</TT> in
<SPAN  CLASS="textit">/etc/audit/auditd.conf</SPAN>.

<P>
</LI>
<LI><P>
Enable the <TT>audisp-remote</TT> plugin by changing the configuration variable
<SPAN  CLASS="textit">active</SPAN> to <SPAN  CLASS="textit">yes</SPAN> in <SPAN  CLASS="textit">/etc/audisp/plugins.d/au-remote.conf</SPAN>.

<P>
</LI>
<LI><P>
Ensure that the network settings in <SPAN  CLASS="textit">/etc/audisp/audisp-remote.conf</SPAN>
point to the remote network server with the receiving <TT>auditd</TT>.

<P>
</LI>
<LI><P>
Ensure that the remaining configurations in <SPAN  CLASS="textit">/etc/audisp/audispd.conf</SPAN>
as well as <SPAN  CLASS="textit">/etc/audisp/plugins.d/au-remote.conf</SPAN> are appropriate.

<P>
</LI>
</UL>

<P>
Please restart the <TT>auditd</TT> daemon.

<P>
The configuration of the remote auditing support is independent from 
keeping a local audit trail. Therefore, the local audit trail configuration
can be disabled or enabled while the remote audit configuration is set up.

<P>
Please refer to the man pages of <SPAN  CLASS="textit">auditd.conf</SPAN>(5), <SPAN  CLASS="textit">audisp-remote.conf</SPAN>(5),
and <SPAN  CLASS="textit">audispd.conf</SPAN>(5) for more details.

<P>

<H2><A NAME="SECTION005192000000000000000"></A><A NAME="Configuration_of_receiving_audit_data"></A><A NAME="1236"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">19</SPAN>.<SPAN CLASS="arabic">2</SPAN> Configuration of receiving audit data
</H2>

<P>
The <TT>auditd</TT> daemon implements the support for receiving audit data from
the network. Several configuration options in <SPAN  CLASS="textit">/etc/audit/auditd.conf</SPAN> must
be set to define the networking behavior of <TT>auditd</TT>. Please see the yet
disabled example configuration provided in <SPAN  CLASS="textit">/etc/audit/auditd.conf</SPAN> supported
by <SPAN  CLASS="textit">auditd.conf</SPAN>(5) for details.

<P>

<H1><A NAME="SECTION00600000000000000000"></A><A NAME="Kernel-based_virtual_machine_KVM_management"></A><A NAME="1243"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>. Kernel-based virtual machine (KVM) management
</H1>

<P>
The TOE provides virtual machine environments which allow other operating
systems to execute concurrently with the RHEL host system. Each virtual machine
is represented as a process in the RHEL host system and is subject to the
standard Linux constraints for processes. The virtualization and simulation
logic that supports the operation of a virtual machine executes within the same
process of the respective virtual machine. When operating virtual machines,
the RHEL host kernel acts as the hypervisor for the guest systems.

<P>
Treating each virtual machine as a normal process by the RHEL host system
allows the concurrent execution of standard applications at the same time.
Administrative tools are implemented as standard Linux applications. In
addition, the computing environment provided by the RHEL host system to users
logging into that system does not differ from a standard RHEL system even while
virtual machines execute. Therefore, standard Linux applications and daemons
may operate concurrently with virtual machines. To access the RHEL host system,
the TOE provides console access via OpenSSH as well as access via the virtual
machine management daemon provided by <TT>libvirtd</TT> via OpenSSH. In addition, the
virtual machine consoles can be accessed using VNC using an already established
OpenSSH channel. The VNC server is implemented by the <TT>QEMU</TT> virtualization
and simulation logic. The use of OpenSSH for accessing the <TT>libvirtd</TT>
management daemon as well as VNC is encapsulated in different client
applications which are not part of the TOE, like <TT>virsh</TT> and <TT>virt-manager</TT>.

<P>
When using RHEL as a host system for virtual machines, different UIDs and GIDs
are used to separate different users, services, or virtual machines provided
by the system. In such a case, it is assumed that these processes are
responsible for the safeguarding of their data. Note: the evaluated
configuration permits the use of the host system for regular operation by
normal users at the same time when virtual machines execute. It depends on the
administrator-defined policies whether such a dual use is allowed.

<P>
Hosting virtual machines with guest operating systems increase the availability
requirements on the host system. Without guest systems, a failing RHEL
instance renders the services offered by the RHEL system offline. However,
a failing RHEL system with a number of guest systems terminates the
services offered by RHEL and all hosted guest systems. The impact of such
a discontinuity is increased by a several orders of magnitude. Therefore,
you MUST plan the deployment of RHEL as a host system for other operating
systems carefully to prevent service discontinuities affecting the overall
goals of your IT infrastructure.

<P>
The following sections discuss the configuration of virtual machines
and their resources.

<P>

<H1><A NAME="SECTION00610000000000000000"></A><A NAME="Hardware_configuration"></A><A NAME="1250"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">1</SPAN> Hardware configuration
</H1>

<P>
The hardware covered by this evaluation provides all support needed for KVM.
However, you MUST ensure that the virtualization hardware mechanisms are
enabled. It MAY be possible that they are disabled using BIOS settings. Please
check your hardware manuals or hardware vendor to ensure that the following
hardware support is enabled:

<P>
<DL>
<DT><STRONG>Intel x86_64 bit based systems</STRONG></DT>
<DD>
<UL>
<LI><P>
The processor's Virtualization Technology extensions (VT-x) support must be
enabled. If that support is enabled, the following command returns with a
listing of processor capabilities:

<P>
<PRE>
        cat /proc/cpuinfo | grep vmx
</PRE>

<P>
</LI>
<LI><P>
The processor's Enhanced Page Tables (EPT) support must be enabled. If that
support is enabled, the following command returns with a listing of
processor capabilities:

<P>
<PRE>
        cat /proc/cpuinfo | grep ept
</PRE>
</LI>
</UL>

<P>
</DD>
<DT><STRONG>AMD Opteron based systems</STRONG></DT>
<DD>
<UL>
<LI><P>
The AMD-V processor's support for virtual machines must be
enabled. If that support is enabled, the following command returns with a
listing of processor capabilities:

<P>
<PRE>
        cat /proc/cpuinfo | grep svm
</PRE>

<P>
</LI>
<LI><P>
The processor's Nested Page Tables (NPT) support must be enabled. If that
support is enabled, the following command returns with a listing of
processor capabilities:

<P>
<PRE>
        cat /proc/cpuinfo | grep npt
</PRE>
</LI>
</UL>
</DD>
</DL>
<H1><A NAME="SECTION00620000000000000000"></A><A NAME="Kernel-based_Virtual_Machine_KVM_configuration"></A><A NAME="1270"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">2</SPAN> Kernel-based Virtual Machine (KVM) configuration
</H1>

<P>
The evaluated configuration allows the administration of virtual machines.
The management daemon of <TT>libvirtd</TT> as well as a virtual machine's console
are accessed via SSH.

<P>
The <TT>libvirtd</TT> virtual machine management daemon allows the specification
of virtual machines, and the assignment of resources to these virtual machines.
Once a virtual machine is configured, this daemon also allows the starting and
stopping of a virtual machine.

<P>
Another aspect of <TT>libvirtd</TT> is the configuration of the host system and its
resources which are made available to virtual machines, including the
configuration of networks and storage areas.

<P>
The functionality mentioned for <TT>libvirtd</TT> allows users to define and start
virtual machines. However, access to the virtual machine's console is
established separately. The virtual machines are instantiated as a Linux
process using the <TT>QEMU</TT> virtualization support. <TT>QEMU</TT> emulates various
devices for a virtual machine, including the console devices with keyboard,
mouse and display. These simulated devices are translated into a VNC server
that the owner of the virtual machine can connect to.

<P>
Access to the <TT>libvirtd</TT> management daemon and the VNC server instantiated
for a virtual machine by <TT>QEMU</TT> is established via SSH. Virtual machine
client applications that are distributed with RHEL can be used to access both,
the <TT>libvirtd</TT> management daemon and the VNC server. For example, the
client applications of <TT>virsh</TT> or <TT>virt-manager</TT> allow the access of
both components via SSH. Note that both client applications are not covered
by the evaluation.

<P>
Users managing virtual machines and who are allowed to access the VNC servers
MUST have a local account on the TOE and MUST be members of the <SPAN  CLASS="textit">libvirt</SPAN>
group. These users do not need any other elevated privileges like root
access. Before these users are able to access <TT>libvirtd</TT> and the VNC servers
they must authenticate via SSH using their accounts. To access
the <TT>libvirtd</TT> virtual machine management daemon remotely via SSH, use the
following command:

<P>
<PRE>
        virsh connect qemu+ssh://USER@HOST/system
</PRE>

<P>
Replace the strings USER with the user ID you want to authenticate with and
HOST with the hostname or IP address of the system executing the <TT>libvirtd</TT>
management daemon.

<P>
To access <TT>libvirtd</TT> locally on the TOE system, you MAY use the following
command:

<P>
<PRE>
        virsh connect qemu:///system
</PRE>

<P>
In this case, the <TT>virsh</TT> command directly accesses the Unix domain sockets
provided by <TT>libvirtd</TT> in <SPAN  CLASS="textit">/var/run/libvirt/</SPAN>.

<P>
To manage virtual machines and resource assignments, please see the <SPAN  CLASS="textit">virsh</SPAN>(1)
man page. This command allows the administration of virtual machines, their
resources, and maintaining the life cycle of virtual machines.

<P>

<H2><A NAME="SECTION00621000000000000000"></A><A NAME="Virtual_machines_started_outside_libvirtd"></A><A NAME="1296"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Virtual machines started outside libvirtd
</H2>

<P>
In the TOE version, only virtual machines instantiated with the
<TT>libvirtd</TT> virtual machine management daemon are covered with the separation
mechanisms that were subject to evaluation. Normal users MAY start virtual
machines outside of <TT>libvirtd</TT>. These virtual machines have the same
privileges on the host system as the user that started them.

<P>
Users may invoke the <TT>QEMU</TT> application with similar command line options
as the <TT>libvirtd</TT> daemon. In this case, the virtualization environment starts
and the guest operating system may become active. However, this startup does not
provide any assurance evaluated with the CC evaluation. In particular, the
following support for virtual machines is missing rendering the execution of
such virtual machines less effective:

<P>

<UL>
<LI><P>
The hardware virtualization support MAY not used as the Linux kernel interface
allowing user space to utilize the hardware support MAY not be accessible to
normal users. The device file <SPAN  CLASS="textit">/dev/kvm</SPAN> provides access to the hardware support.

<P>
</LI>
<LI><P>
The separation mechanism between multiple instances of virtual machines as
discussed in &#167;<A HREF="#SELinux_dynamic_labeling">5.3.2</A> "SELinux dynamic labeling"
is not set up and enforced.

<P>
</LI>
</UL>

<P>
To ensure that all support mechanisms for the proper operation and
separation of virtual machines are employed, virtual machines MUST be
configured and managed using the <TT>libvirtd</TT> virtual machine management
daemon.

<P>

<H2><A NAME="SECTION00622000000000000000"></A><A NAME="System_versus_session_instances_of_libvirtd"></A><A NAME="1307"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN> System versus session instances of libvirtd
</H2>

<P>
The <TT>libvirtd</TT> virtual machine management daemon has the capability to provide
unprivileged users (i.e. users not part of the <SPAN  CLASS="textit">libvirt</SPAN> group) to manage
virtual machines. In this scenario, a <TT>libvirtd</TT> instance executes with the
user ID of the user. This operational mode is called <SPAN  CLASS="textit">session</SPAN> mode.

<P>
Contrary, the privileged instance of <TT>libvirtd</TT> is known as <SPAN  CLASS="textit">system</SPAN> instance.

<P>
The operational mode that the connecting user wants to access is supplied
with the URI when connecting to <TT>libvirtd</TT>. The URI listed in
&#167;<A HREF="#Kernel-based_Virtual_Machine_KVM_configuration">5.2</A> "Kernel-based Virtual Machine (KVM) configuration" contains the string <SPAN  CLASS="textit">system</SPAN> and therefore connects
to the privileged instance of <TT>libvirtd</TT>.

<P>
The virtual machines started from the <SPAN  CLASS="textit">session</SPAN> instance of the <TT>libvirtd</TT>
virtual machine management daemon lack the same capabilities as virtual
machines that are started completely outside the <TT>libvirtd</TT> daemon. Therefore,
the capabilities listed in &#167;<A HREF="#Virtual_machines_started_outside_libvirtd">5.2.1</A>
"Virtual machines started outside libvirtd" are missing for virtual machines
started from the <SPAN  CLASS="textit">session</SPAN> instance of <TT>libvirtd</TT> as well.

<P>
This guidance document and all described virtual machine capabilities apply
only to virtual machines controlled by the <SPAN  CLASS="textit">system</SPAN> instance of <TT>libvirtd</TT>.

<P>

<H1><A NAME="SECTION00630000000000000000"></A><A NAME="Separation_of_virtual_machines"></A><A NAME="1327"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">3</SPAN> Separation of virtual machines
</H1>

<P>
The <TT>libvirtd</TT> virtual machine management daemon provided by RHEL ensures that
the execution environment as well as the resources allocated to a specific
virtual machine are separated from other virtual machine instances. Such a
transparent setup aids the administrator in keeping a secure configuration for
the host system as well as the virtual machines.

<P>

<H2><A NAME="SECTION00631000000000000000"></A><A NAME="Unprivileged_user_and_group_IDs"></A><A NAME="1330"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">1</SPAN> Unprivileged user and group IDs
</H2>

<P>
The host system protects its operation against the virtual machines by
executing them with a fully unprivileged user and group ID, the ID <SPAN  CLASS="textit">qemu</SPAN>.
This user ID has equivalent rights to normal unprivileged users and can
therefore not harm the host system even if the guest operating system would be
able to exploit any vulnerabilities in the hardware emulation code provided with
the <TT>QEMU</TT> application. The <TT>libvirtd</TT> virtual machine management daemon
ensures that the processes implementing the virtual machine environment are
started with the <SPAN  CLASS="textit">qemu</SPAN> user and group ID. The specification of
these IDs is given in <SPAN  CLASS="textit">/etc/libvirt/qemu.conf</SPAN>.

<P>
The configuration option option that enables the startup of a virtual machine with
the configured user ID and the modification of the ownership of the file system
resources is found in <SPAN  CLASS="textit">/etc/libvirt/qemu.conf</SPAN> by setting the configuration
value <SPAN  CLASS="textit">dynamic_ownership</SPAN> to 1.

<P>

<H2><A NAME="SECTION00632000000000000000"></A><A NAME="SELinux_dynamic_labeling"></A><A NAME="1339"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">2</SPAN> SELinux dynamic labeling
</H2>

<P>
In addition to the protection of the host system from the virtual machines,
the host system uses another mechanism to ensure full separation between
virtual machines. As all virtual machines execute with the same user ID and
group ID it is possible in theory that these virtual machine processes
may interfere with each other. The SELinux targeted policy distributed with RHEL
implements a strict separation between virtual machines and its resources.

<P>
With the sVirt mechanism implemented with the <TT>libvirtd</TT> virtual machine
management daemon, the SELinux category is automatically generated.
These sVirt-generated unique SELinux categories are assigned to each
virtual machine and its resources. The SELinux policy prevents any access
request by a virtual machine to a resource if the SELinux category does not
match. In the evaluated configuration, the unique SELinux category for each
virtual machine is calculated automatically by the <TT>libvirtd</TT> virtual
machine management daemon during startup of the virtual machine.

<P>
The virtual machine process as well as all resources assigned to the virtual
machine via the <TT>libvirtd</TT> management framework are re-labeled accordingly
by <TT>libvirtd</TT>.

<P>
More information about the dynamic labeling can be found at
<SPAN  CLASS="textit">http://libvirt.org/drvqemu.html#securitysvirt</SPAN>.

<P>

<H2><A NAME="SECTION00633000000000000000"></A><A NAME="SELinux_static_labeling"></A><A NAME="1346"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">3</SPAN> SELinux static labeling
</H2>

<P>
In the evaluated configuration, dynamic labeling is per default activated to
achieve full separation of the virtual machine. However you MAY use
static labeling as documented below in Base mode. Contrary, in MLS mode
you MUST use static labeling as <TT>libvirtd</TT> does not modify the label
on the fly.

<P>
If the administrator wants to set the label of the virtual machine
process and the resources manually, the <SPAN  CLASS="textit">dynamic_ownership</SPAN> must be set to 0.
In this case, the SELinux label is specified in the XML descriptor of the
virtual machine in <SPAN  CLASS="textit">/etc/libvirt/qemu/</SPAN>. The label specification may look
as follows:

<P>
<PRE>
        &lt;seclabel type='static' model='selinux'&gt;
            &lt;label&gt;system_u:system_r:svirt_t:s0:c77,c525&lt;/label&gt;
        &lt;/seclabel&gt;
</PRE>

<P>
The <SPAN  CLASS="textit">label</SPAN> attribute sets the label of the virtual machine process. If
static labeling is used, you MAY only modify the category part (i.e.
the "c77,c525" setting of the example). You MUST NOT modify any other part
of the SELinux label. When changing other parts of the SELinux label, the full
separation of virtual machines cannot be ensured any more.

<P>
In addition, when setting static labels, you MUST ensure that the category
given to a virtual machine is unique and not used by other virtual machines.

<P>
Also, you MUST use the <SPAN  CLASS="textit">selinux</SPAN> security model as given in the above mentioned
example.

<P>
Prior to starting the virtual machine, you MUST manually set the label
on the resources configured for the virtual machine. These labels must ensure
that the virtual machine process can access the resource. The labeling of
these resources must be performed as outlined in
<SPAN  CLASS="textit">http://libvirt.org/drvqemu.html#securitysvirt</SPAN>.

<P>
The static labeling allows the administrator the most flexibility on setting
the permissions on the virtual machine. However, it also places the burden
of ensuring proper virtual machine separation on the administrator.

<P>

<H1><A NAME="SECTION00640000000000000000"></A><A NAME="Networking_considerations"></A><A NAME="1356"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">4</SPAN> Networking considerations
</H1>

<P>
Virtual machines MAY be configured with one or more network interfaces.
The <TT>libvirtd</TT> virtual machine management daemon allows the configuration
of the networking capabilities for virtual machines.

<P>
Two aspects MUST be configured to establish the network connectivity for
virtual machines:

<P>

<OL>
<LI><P>
The <TT>libvirtd</TT> MUST be configured with one or more networks. Each network
configuration results in an automated setup of a bridge network interface
on the host system. That bridge interface is assigned with a physical network
interface on the host. To achieve separation between these networks, each
network MUST be assigned to an individual physical network interface.

<P>
</LI>
<LI><P>
Each virtual machine network configuration must be assigned to belong to
one network defined for <TT>libvirtd</TT>. With this link, the virtual machine
becomes part of the bridge defined for the network interface.

<P>
</LI>
</OL>

<P>
A network bridge provided with the host system can be considered to resemble
a network switch. Each member of the bridge is able to directly communicate
with each other member. Therefore, if virtual machines shall be configured
that must not communicate with each other, separate networks must be specified
with <TT>libvirtd</TT>. These networks must be assigned with different physical
network interfaces on the host. The network interfaces of the virtual machines
that shall be isolated must be assigned different networks.

<P>
When <TT>libvirtd</TT> instantiates a virtual machine, it sets up a TAP device
connected to the bridge the virtual machine is configured to have access to.
The file descriptor of that TAP device is transferred to the <TT>QEMU</TT> process by
the <TT>libvirtd</TT> virtual machine management daemon as the unprivileged <TT>QEMU</TT>
is not allowed to open the TAP device. With this file descriptor, the virtual
machine process is now able to implement all network protocols starting with
OSI-layer 2.

<P>
As <TT>libvirtd</TT> provides virtual machine processes with a TAP device to the
host system's bridge interface, a virtual machine is able to generate full
Ethernet communication including sniffing the network or flooding the network
with data. This implies that although the host system fully
isolates the virtual machines from the host system as well as from each other,
virtual machines have the same network capabilities to the assigned network
as bare-metal systems connected to the same network! Therefore, guest software
executing within the virtual machines must be as trustworthy as individual
physical machines on the same network. KVM does not and is not designed to
stop rogue guest software from misusing access to the networks they are allowed
to access.

<P>

<H2><A NAME="SECTION00641000000000000000"></A><A NAME="Packet_filtering"></A><A NAME="1369"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN> Packet filtering
</H2>

<P>
The host system provides packet filtering functionality for the bridges
implemented with <SPAN  CLASS="textit">ebtables</SPAN>(8). Please see the man pages for details about
setting up packet filters on bridges.

<P>
More information about ebtables is presented in section
&#167;<A HREF="#Firewall_configuration">4.14</A> "Firewall configuration".

<P>

<H1><A NAME="SECTION00650000000000000000"></A><A NAME="Device_assignment"></A><A NAME="1373"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">5</SPAN> Device assignment
</H1>

<P>
Together with the support of the <SPAN  CLASS="textit">libvirtd</SPAN> management daemon, KVM provides 
the functionality of assigning PCI as well as USB devices to virtual machines 
for their exclusive use. A device can only be assigned to one virtual machine 
using this mechanism.

<P>
The following sections discuss the device assignment mechanisms separately for 
PCI and USB devices.

<P>

<H2><A NAME="SECTION00651000000000000000"></A><A NAME="PCI_device_assignment"></A><A NAME="1376"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">1</SPAN> PCI device assignment
</H2>

<P>
PCI device assignment MUST NOT be configured as it is considered to be unsafe
in secure environments.

<P>

<H2><A NAME="SECTION00652000000000000000"></A><A NAME="USB_device_assignment"></A><A NAME="1378"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">2</SPAN> USB device assignment
</H2>

<P>
Unlike the PCI device assignment, USB assignment does not require special
considerations. If one USB device is assigned to a virtual machine, access
is mediated by <SPAN  CLASS="textit">QEMU</SPAN> via the USB device file. The access permissions on
the USB device file are restricted by <SPAN  CLASS="textit">libvirtd</SPAN> modifying the device file
ownership and its SELinux label such that only the virtual machine which
is given access to the device is able to access the device file.

<P>
<SPAN  CLASS="textbf">WARNING</SPAN>: Neither the <SPAN  CLASS="textit">libvirtd</SPAN> management daemon, nor the KVM
functionality implement any constraints in which USB devices can be assigned
to a virtual machine. A virtual machine administrator may assign any device
listed in the <TT>lsusb</TT> output to a virtual machine. This includes devices that
are needed by the host system.
Virtual machine administrators have the ability to disrupt the operation of
the host. The evaluated configuration does not place any constraints
on which USB devices are assigned to virtual machines. This gives the
virtual machine administrator full flexibility over USB device assignment
configuration. However, the administrator MUST be very careful about which
USB devices are assigned.

<P>

<H1><A NAME="SECTION00700000000000000000"></A><A NAME="Monitoring_Logging_Audit"></A><A NAME="1385"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>. Monitoring, Logging &amp; Audit
</H1>

<H1><A NAME="SECTION00710000000000000000"></A><A NAME="Reviewing_the_system_configuration"></A><A NAME="1387"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">1</SPAN> Reviewing the system configuration
</H1>

<P>
It is RECOMMENDED that you review the system's configuration at
regular intervals to verify if it still agrees with the evaluated
configuration. This primarily concerns those processes that run
with root privileges.

<P>
The permissions of the device files <SPAN  CLASS="textit">/dev/*</SPAN> MUST NOT be modified.

<P>
In particular, review settings in the following files and directories to
ensure that the contents and permissions have not been modified:

<P>
<PRE>
        /etc/audit/audit.rules
        /etc/audit/auditd.conf
        /etc/cron.{ weekly hourly daily monthly}
        /etc/cron.allow             
        /etc/cron.d/*
        /etc/cron.deny             
        /etc/crontab
        /etc/group
        /etc/gshadow
        /etc/hosts
        /etc/inittab
        /etc/ipsec.conf
        /etc/ipsec.d/*
        /etc/ipsec.secrets
        /etc/ld.so.conf
        /etc/libvirt/*
        /etc/localtime
        /etc/login.defs
        /etc/modprobe.conf
        /etc/netlabel.rules
        /etc/pam.d/*
        /etc/passwd
        /etc/rc.d/init.d/*
        /etc/rc.d/init.d/auditd
        /etc/securetty
        /etc/security/opasswd
        /etc/selinux/config
        /etc/selinux/mls/contexts/
        /etc/selinux/mls/modules/
        /etc/selinux/mls/policy/
        /etc/selinux/mls/setrans.conf
        /etc/selinux/mls/seusers
        /etc/selinux/semanage.conf
        /etc/shadow
        /etc/ssh/sshd_config
        /etc/sysconfig/*
        /etc/sysctl.conf
        /etc/xinetd.conf
        /etc/xinetd.d/*
        /var/log/lastlog
        /var/run/faillock/*
        /var/spool/cron/root
</PRE>

<P>
Use the commands <TT>lastlog</TT> as well as <TT>last</TT> to detect unusual patterns
of logins.

<P>
Also verify the output of the following commands (run as root):

<P>
<PRE>
        crontab -l
        find / \( -perm -4000 -o -perm -2000 \) -ls
        find / \( -type f -o -type d -o -type b \) -perm -0002 -ls
</PRE>
<PRE>
        find /bin /boot /etc /lib /sbin /usr \
                ! -type l \( ! -uid 0 -o -perm +022 \)
</PRE>
<H1><A NAME="SECTION00720000000000000000"></A><A NAME="System_logging_and_accounting"></A><A NAME="1398"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">2</SPAN> System logging and accounting
</H1>

<P>
System log messages are stored in the <SPAN  CLASS="textit">/var/log/</SPAN> directory tree in plain text
format, most are logged through the <SPAN  CLASS="textit">syslogd</SPAN>(8) and <SPAN  CLASS="textit">klogd</SPAN>(8) programs,
which MAY be configured via the <SPAN  CLASS="textit">/etc/syslog.conf</SPAN> file.

<P>
The <SPAN  CLASS="textit">logrotate</SPAN>(8) utility, launched from <SPAN  CLASS="textit">/etc/cron.daily/logrotate</SPAN>, starts a
fresh log file every week or when they reach a maximum size and automatically
removes or archives old log files. You MAY change the configuration files
<SPAN  CLASS="textit">/etc/logrotate.conf</SPAN> and <SPAN  CLASS="textit">/etc/logrotate.d/*</SPAN> as required.

<P>
In addition to the <SPAN  CLASS="textit">syslog</SPAN> messages, various other log files and status
files are generated in <SPAN  CLASS="textit">/var/log</SPAN> by other programs:

<P>
<PRE>
 File           Source
 -------------+---------------------------------------------------------------
 audit          Default audit log storage
 boot.msg       Messages from system startup
 libvirt        Log maintained by libvirtd
 lastlog        Last successful log in  (see lastlog(8))
 localmessages  Written by syslog
 mail           Written by syslog, contains messages from the MTA (postfix)
 messages       Written by syslog, contains messages from su and ssh
 news/          syslog news entries (not used in the evaluated configuration)
 secure         Security related messages (for example from PAM)
 warn           Written by syslog
 wtmp           Written by the PAM susbystem, see who(1)
</PRE>

<P>
Please see <SPAN  CLASS="textit">syslog</SPAN>(3), <SPAN  CLASS="textit">syslog.conf</SPAN>(5) and <SPAN  CLASS="textit">syslogd</SPAN>(8) man pages for
details on syslog configuration.

<P>
The <SPAN  CLASS="textit">ps</SPAN>(1) command can be used to monitor the currently running
processes. Using <TT>ps faux</TT> will show all currently running processes and
threads.

<P>

<H1><A NAME="SECTION00730000000000000000"></A><A NAME="Configuring_the_audit_subsystem"></A><A NAME="1417"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">3</SPAN> Configuring the audit subsystem
</H1>

<P>
The audit subsystem implements a central monitoring solution to keep track of
security relevant events, such as changes and change attempts to security
critical files.

<P>
This is accomplished through two separate mechanisms. All system calls are
intercepted, and the kernel writes the parameters and return value to the audit
log for those calls that are marked as security relevant in the filter
configuration. In addition, some trusted programs contain audit-specific code
to write audit trails of the actions they are requested to perform.

<P>
Please refer to the <SPAN  CLASS="textit">auditd</SPAN>(8), <SPAN  CLASS="textit">auditd.conf</SPAN>(5), and
<SPAN  CLASS="textit">auditctl</SPAN>(8) man pages for more information.

<P>
Refer to section &#167;<A HREF="#Remote_audit_configuration">4.19</A> "Remote audit configuration"
for details about the configuration of remote auditing.

<P>

<H2><A NAME="SECTION00731000000000000000"></A><A NAME="Intended_usage_of_the_audit_subsystem"></A><A NAME="1423"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">1</SPAN> Intended usage of the audit subsystem
</H2>

<P>
The operational mode of Base and MLS specify the auditing capabilities that
a compliant system must support. The evaluated configuration described here is
based on these requirements.

<P>
<SPAN  CLASS="textbf">WARNING:</SPAN> Some of the protection profile requirements can conflict
with your specific requirements for the system. For example, a
MLS-compliant system MUST disable logins if the audit subsystem is
not working. Please ensure that you are aware of the consequences if
you enable auditing.

<P>
Base and MLS are designed for a multiuser system, with multiple
unique users who maintain both shared and private resources. The
auditing features are intended to support this mode of operation with
a reliable trail of security-relevant operations. It is less useful
for a pure application server with no interactive users.

<P>
Please be aware that the auditing subsystem will, when activated,
cause some slowdown for applications on the server. The impact depends
on what the application is doing and how the audit subsystem is
configured. As a rule of thumb, applications that operate on a large number
of separate files are most affected, and CPU-bound programs should not
be measurably affected. You will need to balance the performance
requirements against your security needs when deciding if and how you
want to use auditing.

<P>

<H2><A NAME="SECTION00732000000000000000"></A><A NAME="Selecting_the_events_to_be_audited"></A><A NAME="1426"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">2</SPAN> Selecting the events to be audited
</H2>

<P>
You MAY make changes to the set of system calls and events that are to
be audited. Base and MLS require that the system has the <SPAN  CLASS="textit">capability</SPAN> to
audit security relevant events, but it is up to you to choose how you
want to use these capabilities. It is acceptable to turn off system
call auditing completely even in an evaluated configuration, for
example on a pure application server with no interactive users on the
system.

<P>
The audit package provides several suggested audit configuration
files, for example the <SPAN  CLASS="textit">/usr/share/doc/audit-*/capp.rules</SPAN> file for
Base systems, and the <SPAN  CLASS="textit">lspp.rules</SPAN> file (in the same location) for
MLS systems. They contain a suggested setup for a typical multiuser
system, all access to security relevant files is audited, along with
other security relevant events such as system reconfiguration. You MAY
copy one of the sample rules files to <SPAN  CLASS="textit">/etc/audit/audit.rules</SPAN> and modify
the configuration according to your local requirements, including the
option of using an empty audit rules file to disable auditing if not
required.

<P>
The man page <SPAN  CLASS="textit">audit.rules</SPAN>(7) provides a number of tips as well as
auditing strategies.

<P>
When using CUPS in MLS mode, it is RECOMMENDED to configure an audit rule to
monitor changes to the printer device MLS level, for example:

<P>
<PRE>
        -w /dev/lp1 -k Printdevice
        -a exit,possible -S setxattr
</PRE>

<P>
You MAY selectively disable and enable auditing for specific events or
users as required by modifying the <SPAN  CLASS="textit">audit.rules</SPAN> file.

<P>
It is RECOMMENDED that you monitor use of the <SPAN  CLASS="textit">semodule</SPAN>(8) tool to
keep track of administrative changes to optional security policy
modules:

<P>
<PRE>
        -w /usr/sbin/semodule
</PRE>

<P>
It is RECOMMENDED that you always reconfigure the audit system
by modifying the <SPAN  CLASS="textit">/etc/audit/audit.rules</SPAN> file and then running the
following command to reload the audit rules:

<P>
<PRE>
        # as role "auditadm_r"
        auditctl -R /etc/audit/audit.rules
</PRE>

<P>
This procedure ensures that the state of the audit system always
matches the content of the <SPAN  CLASS="textit">/etc/audit/audit.rules</SPAN> file. You SHOULD NOT
manually add and remove audit rules and watches on the command line as
those changes are not persistent.

<P>
Note that reloading audit rules involves initially deleting all audit
rules, and for a short time the system will be operating with no or
only a partial set of audit rules. It is RECOMMENDED to make changes
to the audit rules when no users are logged in on the system, for
example by using single user mode or a reboot to activate the changes.

<P>
Please refer to the <SPAN  CLASS="textit">auditctl</SPAN>(8) man page for more details.

<P>
Setting SELinux contexts through library functions such as
<SPAN  CLASS="textit">setexeccon</SPAN>(3), or equivalently by writing information to the
<SPAN  CLASS="textit">/proc/self/attr/{current,exec,fscreate,sockcreate}</SPAN> files, will
generate audit records when enabled in the SELinux policy by
<SPAN  CLASS="textit">auditallow</SPAN> rules.  Please refer to section &#167;<A HREF="#MLS_mode_specific_policy_module">4.17.2</A> "MLS mode specific policy module" of this guide for
more information about configuring this policy. Note that the audit
records will always report success when the open/write operation to
the pseudofile was successful, even if the context that was written
there is invalid. In the case of an invalid context, the following
operation (such as an <SPAN  CLASS="textit">exec</SPAN>(2) system call in the case of
<SPAN  CLASS="textit">setexeccon</SPAN>) will fail, and will generate its own audit record if
configured to do so for that operation.

<P>

<H2><A NAME="SECTION00733000000000000000"></A><A NAME="Reading_and_searching_the_audit_records"></A><A NAME="1450"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">3</SPAN> Reading and searching the audit records
</H2>

<P>
Use the <SPAN  CLASS="textit">ausearch</SPAN>(8) tool to retrieve information
from the audit logs. The information available for retrieval depends
on the active filter configuration. If you modify the filter
configuration, it is RECOMMENDED keeping a datestamped copy of the
applicable configuration with the log files for future reference.

<P>
For example:

<P>
<PRE>
        # search for events with a specific login UID
        ausearch -ul jdoe
</PRE>
<PRE>
        # search for events by process ID
        ausearch -p 4690
</PRE>

<P>
Please refer to the <SPAN  CLASS="textit">ausearch</SPAN>(8) man page for more details. In addition,
the <SPAN  CLASS="textit">audit.rules</SPAN>(7) man page contains additional hints on implementing
effective audit trail searches.

<P>
For some system calls on some platforms, the system call arguments in
the audit record can be slightly different than you may expect from
the program source code due to modifications to the arguments in the C
library or in kernel wrapper functions. For example, the <SPAN  CLASS="textit">mq_open</SPAN>(3)
glibc library function strips the leading '/' character from the path
argument before passing it to the <SPAN  CLASS="textit">mq_open</SPAN>(2) system call, leading
to a one character difference in the audit record data. Similarly,
some system calls such as <SPAN  CLASS="textit">semctl</SPAN>(2), <SPAN  CLASS="textit">getxattr</SPAN>(2), and
<SPAN  CLASS="textit">mknodat</SPAN>(2) can have additional internal flags automatically added
to the flag argument. These minor modifications do not change the
security relevant information in the audit record.

<P>
Of course, you can use other tools such as plain <SPAN  CLASS="textit">grep</SPAN>(1) or
scripting languages such as <SPAN  CLASS="textit">awk</SPAN>(1), <SPAN  CLASS="textit">python</SPAN>(1) or <SPAN  CLASS="textit">perl</SPAN>(1) to
further analyze the text audit log file or output generated by the
low-level <SPAN  CLASS="textit">ausearch</SPAN> tool.

<P>

<H2><A NAME="SECTION00734000000000000000"></A><A NAME="Starting_and_stopping_the_audit_subsystem"></A><A NAME="1469"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">4</SPAN> Starting and stopping the audit subsystem
</H2>

<P>
If the audit daemon is terminated, no audit events are saved until it
is restarted. To avoid lost audit records when you have modified the
filter configuration, you MUST use the command <TT>service auditd
reload</TT> to re-load the filters.

<P>
You MUST NOT use the <SPAN  CLASS="textit">KILL</SPAN> signal (-9) to stop the audit daemon,
doing so would prevent it from cleanly shutting down.

<P>
It is RECOMMENDED that you add the kernel parameter <TT>audit=1</TT> to your
boot loader configuration file to ensure that all processes, including
those launched before the <SPAN  CLASS="textit">auditd</SPAN> service, are properly attached to
the audit subsystem. Please refer to the documentation of your boot
loader and section &#167;<A HREF="#Configuring_the_boot_loader">3.9</A> "Configuring the
boot loader" of this document for more details.

<P>

<H2><A NAME="SECTION00735000000000000000"></A><A NAME="Storage_of_audit_records"></A><A NAME="1476"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">5</SPAN> Storage of audit records
</H2>

<P>
The default audit configuration stores audit records in the
<SPAN  CLASS="textit">/var/log/audit/audit.log</SPAN> file. This is configured in the
<SPAN  CLASS="textit">/etc/audit/auditd.conf</SPAN> file. You MAY change the <SPAN  CLASS="textit">auditd.conf</SPAN> file
to suit your local requirements.

<P>
It is RECOMMENDED that you configure the audit daemon settings
appropriately for your local requirements, for example by changing the
log file retention policy to never delete old audit logs with the
following setting in the <SPAN  CLASS="textit">/etc/audit/auditd.conf</SPAN> file:

<P>
<PRE>
        max_log_file_action = KEEP_LOGS
</PRE>

<P>
The most important settings concern handling situations where the
audit system is at risk of losing audit information, such as due to
lack of disk space or other error conditions. You MAY choose actions
appropriate for your environment, such as switching to single user
mode (action <TT>single</TT>) or shutting down the system (action <TT>halt</TT>)
to prevent auditable actions when the audit records cannot be
stored.

<P>
<SPAN  CLASS="textbf">Warning:</SPAN> Switching to single user mode does not automatically kill
all user processes when using the system default procedure. You MAY
kill processes of users by using <TT>killall -u</TT>. Please note that
system services SHOULD NOT be terminated. Depending on your local
policy, you MAY need to shut down KVM guests. As these KVM guests
act like normal processes on the Linux host system, the same commands
to terminate these processes may be used.

<P>
Halting the system is RECOMMENDED and most certain way to ensure all
user processes are stopped. The following settings are RECOMMENDED in
the <SPAN  CLASS="textit">/etc/audit/auditd.conf</SPAN> file if a fail-secure audit system is
required:

<P>
<PRE>
        admin_space_left_action = SINGLE
        disk_full_action = HALT
        disk_error_action = HALT
</PRE>

<P>
It is RECOMMENDED that you configure appropriate disk space thresholds
and notification methods to receive an advance warning when the space
for audit records is running low.

<P>
It is RECOMMENDED that you use a dedicated partition for the
<SPAN  CLASS="textit">/var/log/audit/</SPAN> directory to ensure that <SPAN  CLASS="textit">auditd</SPAN> has full control
over the disk space usage with no other processes interfering.

<P>
Please refer to the <SPAN  CLASS="textit">auditd.conf</SPAN>(5) man page for more information
about the storage and handling of audit records.

<P>

<H2><A NAME="SECTION00736000000000000000"></A><A NAME="Reliability_of_audit_data"></A><A NAME="1494"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">3</SPAN>.<SPAN CLASS="arabic">6</SPAN> Reliability of audit data
</H2>

<P>
You MAY choose an appropriate balance between availability of the
system and secure failure mode in case of audit system malfunctions
based on your local requirements.

<P>
You MAY configure the system to cease all processing immediately in
case of critical errors in the audit system. When such an error is
detected, the system will then immediately enter "panic" mode and will
need to be manually rebooted. To use this mode, add the following line
to the <SPAN  CLASS="textit">/etc/audit/audit.rules</SPAN> file:

<P>
<PRE>
        -f 2
</PRE>

<P>
Please refer to the <SPAN  CLASS="textit">auditctl</SPAN>(8) man page for more information about
the failure handling modes.

<P>
You MAY edit the <SPAN  CLASS="textit">/etc/libaudit.conf</SPAN> file to configure the desired
action for applications that cannot communicate with the audit
system. Please refer to the <SPAN  CLASS="textit">get_auditfail_action</SPAN>(3) man page for
more information.

<P>
<SPAN  CLASS="textit">auditd</SPAN> writes audit records using the normal Linux filesystem
buffering, which means that information can be lost in a crash because
it has not been written to the physical disk yet. Configuration
options control how <SPAN  CLASS="textit">auditd</SPAN> handles disk writes and allow the
administrator to choose an appropriate balance between performance and
reliability.

<P>
Any applications that read the records while the system is running
will always get the most current data out of the buffer cache, even if
it has not yet been committed to disk, so the buffering settings do
not affect normal operation.

<P>
The default setting is <TT>flush = DATA</TT>, ensuring that record data is
written to disk, but metadata such as the last file time might be
inconsistent.

<P>
The highest performance mode is <TT>flush = none</TT>, but be aware that
this can cause loss of audit records in the event of a system crash.

<P>
If you want to ensure that auditd always forces a disk write for each
record, you MAY set the <TT>flush = SYNC</TT> option in <SPAN  CLASS="textit">/etc/audit/auditd.conf</SPAN>,
but be aware that this will result in significantly reduced
performance and high strain on the disk.

<P>
A compromise between crash reliability and performance is to ensure a
disk sync after writing a specific number of records to provide an
upper limit for the number of records lost in a crash. For this, use a
combination of <TT>flush = INCREMENTAL</TT> and a numeric setting for the
<TT>freq</TT> parameter, for example:

<P>
<PRE>
        flush = INCREMENTAL
        freq = 100
</PRE>

<P>
The audit record files are <SPAN  CLASS="textit">not</SPAN> protected against a malicious
administrator, and are not intended for an environment where the
administrators are not trustworthy.

<P>

<H1><A NAME="SECTION00740000000000000000"></A><A NAME="System_configuration_variables_in_etc_sysconfig"></A><A NAME="1514"></A>
<BR>
<SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">4</SPAN> System configuration variables in <SPAN  CLASS="textit">/etc/sysconfig</SPAN>
</H1>

<P>
The system uses various files in <SPAN  CLASS="textit">/etc/sysconfig</SPAN> to configure the system.
Most files in this directory tree contain variable definitions in the form of
shell variables that are either read by the rc scripts at system boot time or
are evaluated by other commands at runtime. Note that changes will not
take effect until the affected service is restarted or the system is rebooted.

<P>

<H1><A NAME="SECTION00800000000000000000"></A><A NAME="Security_guidelines_for_users"></A><A NAME="1517"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>. Security guidelines for users
</H1>

<H1><A NAME="SECTION00810000000000000000"></A><A NAME="System_Documentation"></A><A NAME="1519"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">1</SPAN> System Documentation
</H1>

<P>
The system provides a large amount of online documentation, usually in text
format. Use the <TT>man</TT> program to read entries in the online manual,
for example:

<P>
<PRE>
        man ls
        man man
</PRE>

<P>
to read information about the <TT>ls</TT> and <TT>man</TT> commands respectively.
You can search for keywords in the online manual with the <SPAN  CLASS="textit">apropos</SPAN>(1)
utility, for example:

<P>
<PRE>
        apropos password
</PRE>

<P>
When this guide refers to manual pages, it uses the syntax
ENTRY(SECTION), for example  <SPAN  CLASS="textit">ls</SPAN>(1). Usually you do not need to provide the section
number, but if there are several entries in different sections, you can use
the optional <TT>-S</TT> switch and pick a specific one.

<P>
Some programs provide additional information GNU 'texinfo' format, use the
<TT>info</TT> program to read it, for example:

<P>
<PRE>
        info diff
</PRE>

<P>
Additional information, sorted by software package, may be found in the
<SPAN  CLASS="textit">/usr/share/doc/*/</SPAN> directories. Use the <SPAN  CLASS="textit">less</SPAN>(1) pager to read it,
for example:

<P>
<PRE>
        /usr/share/doc/pam-*/txts/README*
</PRE>

<P>
Many programs also support a <TT>--help</TT>, <TT>-?</TT> or <TT>-h</TT> switch you can use to
get a usage summary of supported command-line parameters.

<P>
Note that this Configuration Guide has precedence over other documents
in case of conflicting recommendations.

<P>

<H1><A NAME="SECTION00820000000000000000"></A><A NAME="Authentication"></A><A NAME="1542"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">2</SPAN> Authentication
</H1>

<P>
You MUST authenticate (prove your identity) before being permitted to
use the system. When the administrator created your user account,
he or she will have assigned a user name and default password, and provided
that information for you along with instructions how to access the system.

<P>
Logging in to the system will usually be done using the Secure Shell (SSH)
protocol, alternatively a serial terminal can be used. Use the
<TT>ssh</TT> command to connect to the system unless instructed otherwise by
the administrator, for example:

<P>
<PRE>
        ssh jdoe@172.16.0.1
</PRE>

<P>
In case the system administrator has assigned multiple roles for your
use, you can select the desired role by appending it to the username
separated with a slash, for example:

<P>
<PRE>
        ssh jdoe/user_r@172.16.0.1
</PRE>

<P>
The <SPAN  CLASS="textit">ssh</SPAN>(1) manual page provides more information on available options. If
you need to transfer files between systems, use the <SPAN  CLASS="textit">scp</SPAN>(1) or <SPAN  CLASS="textit">sftp</SPAN>(1)
tools.

<P>
If this is the first time you are connecting to the target system, you will
be prompted if you want to accept the host key. If the administrator
has provided a key fingerprint for comparison, verify that they match,
otherwise type <TT>yes</TT> to continue. You MUST immediately change your
initially assigned password with the <SPAN  CLASS="textit">passwd</SPAN>(1) utility.

<P>
You MUST NOT under any circumstances attempt to log in from an
insecure device, such as a public terminal or a computer belonging to
a friend. Even if the <SPAN  CLASS="textit">person</SPAN> owning the computer is trustworthy,
the <SPAN  CLASS="textit">computer</SPAN> might not be due to having been infected with malicious
code. Always remember that the device you are typing your password
into has the ability to save and re-use your authentication
information, so you are in effect giving the computer you are using
the right to do any and all actions in your name. Insecure handling of
authentication information is the leading cause for exploits of
otherwise secure systems, and SSH can only protect the information
during transit, and offers no protection at all against an insecure
end point.

<P>
When you log out from the system and leave the device you have used
for access (such as a terminal or a workstation with terminal
emulation), you MUST ensure that you have not left information on the
screen or within an internal buffer that should not be accessible to
another user. You should be aware that some terminals also store
information not displayed on the terminal (such as passwords, or the
contents of a scrollback buffer). Nevertheless this information can be
extracted by the next user unless the terminal buffer has been
cleared. Safe options include completely shutting down the client
software used for access, powering down a hardware terminal, or
clearing the scrollback buffer by switching among virtual terminals in
addition to clearing the visible screen area.

<P>
If you ever forget your password, contact your administrator who
will be able to assign a new password.

<P>
You MAY use the <SPAN  CLASS="textit">chsh</SPAN>(1) and <SPAN  CLASS="textit">chfn</SPAN>(1) programs to update your
login shell and personal information if necessary. Not all settings
can be changed this way, contact your administrator if you need to
change settings that require additional privileges.

<P>

<H1><A NAME="SECTION00830000000000000000"></A><A NAME="Password_policy"></A><A NAME="1558"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">3</SPAN> Password policy
</H1>

<P>
All users, including the administrators, MUST ensure that their
authentication passwords are strong (hard to guess) and handled with
appropriate security precautions. The password policy described here
is designed to satisfy the requirements of the evaluated
configuration. If your organization already has a password policy
defined, your administrator MAY refer you to that policy if it is
equivalently strong.

<P>
You MUST change the initial password set by the administrator when you
first log into the system. You MUST select your own password in
accordance with the rules defined here. You MUST also change the
password if the administrator has set a new password, for example if you have
forgotten your password and requested the administrator to reset the
password.

<P>
Use the <SPAN  CLASS="textit">passwd</SPAN>(1) program to change passwords. It will first prompt
you for your old password to confirm your identity, then for the new
password. You need to enter the new password twice, to catch mistyped
passwords.

<P>
The <SPAN  CLASS="textit">passwd</SPAN>(1) program will automatically perform some checks on
your new password to help ensure that it is not easily guessable, but
you MUST nevertheless follow the requirements in this chapter.

<P>
Note that the administrators MUST also ensure that their own passwords
comply with this password policy, even in cases where the automatic
checking is not being done, such as when first installing the system.

<P>

<UL>
<LI><P>
Your password MUST be a minimum of 8 characters in length. More than 8
characters MAY be used (it is RECOMMENDED to use more than 8, best is to
use passphrases), and all characters are significant.

<P>
</LI>
<LI><P>
Combine characters from different character classes to construct a
sufficiently strong password, using either 8 total characters
containing at least one character from each class, or alternatively 12
total characters chosen from any three of the classes. The character
classes are defined as follows:

<P>
<PRE>
        Lowercase letters: abcdefghijklmnopqrstuvwxyz
        Uppercase letters: ABCDEFGHIJKLMNOPQRSTUVWXYZ
        Digits:            0123456789
        Punctuation:       !"#$%&amp;'()*+,-./:;&lt;=&gt;?[\]^_`{|}~
</PRE>

<P>
Note that non-7-bit ASCII characters MAY be used for passwords.

<P>
</LI>
<LI><P>
You MUST NOT base the password on a dictionary word, your real name,
login name, or other personal details (such as dates, names of
relatives or pets), or names of real people or fictional
characters.

<P>
</LI>
<LI><P>
Instead of a password, you MAY use a passphrase consisting of multiple
unrelated words (at least three) joined with random punctuation
characters. Such a passphrase MUST have a length of at least 16
characters. (This corresponds to automatically generated pass phrases
constructed by choosing 3 words from a 4096 word dictionary and adding
two punctuation characters from a set of 8, equivalent to 42 bits of entropy.)

<P>
</LI>
<LI><P>
You MUST NOT use a simple alphabetic string, palindrome or combinations of
adjacent keyboard keys.

<P>
</LI>
<LI><P>
When you choose a new password, it MUST NOT be a simple variation or
permutation of a previously used one.

<P>
</LI>
<LI><P>
You MUST NOT write the password on paper or store it on electronic
devices in unprotected form. Storage in a secure location (such as an
envelope in a safety deposit box, or encrypted storage on an
electronic device) MAY be acceptable, contact your administrator first
to ensure that the protection is strong enough to make password
recovery infeasible for the types of attackers the system is intended
to protect against.

<P>
</LI>
<LI><P>
The password is for you and you only.  A password is like a toothbrush - you
do not want to share it with anybody, even your best friend.  You MUST NOT
disclose your password to anybody else, or permit anybody else to use the
system using your identity.

<P>
Note that administrators will never ask you for your password, since
they do not need it even if they are required to modify settings affecting
your user account.

<P>
</LI>
<LI><P>
You MUST NOT use the same password for access to any systems under external
administration, including Internet sites. You MAY however use the same
password for accounts on multiple machines within one administrative unit,
as long as they are all of an equivalent security level and under the
control of the same administrators.

<P>
</LI>
<LI><P>
You MUST inform the administrator and select a new password if you
have reason to believe that your password was accidentally disclosed to a
third party.

<P>
</LI>
<LI><P>
If the system notifies you that your password will expire soon or has
expired, choose a new one as instructed. Contact your administrator
in case of difficulty.

<P>
</LI>
</UL>

<P>
A RECOMMENDED method of generating passwords that fits these criteria while
still being easy to memorize is to base it on letters of words in a sentence
(NOT a famous quotation), including capitalization and punctuation and one
or two variations. Example:

<P>
<PRE>
        "Ask not for whom the bell tolls."
        =&gt; An4wtbt.
</PRE>
<PRE>
        "Password 'P'9tw;ciSd' too weak; contained in RHEL documentation"
        =&gt; P'9tw;ciRd
</PRE>
<H1><A NAME="SECTION00840000000000000000"></A><A NAME="SSH_key-based_authentication"></A><A NAME="1570"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">4</SPAN> SSH key-based authentication
</H1>

<P>
You MAY use the SSH key-based authentication documented in <SPAN  CLASS="textit">sshd</SPAN>(8) section
"AUTHORIZED_KEYS FILE FORMAT". Before the SSH key-based authentication can
be used, you must generate either an RSA or DSA key pair using the
<SPAN  CLASS="textit">ssh-keygen</SPAN>(1) utility.

<P>
As only the <TT>ssh-keygen</TT> utility provided with the TOE was subject to
the security assessment, including the proper key generation support,
it is strongly RECOMMENDED that you use this tool from the TOE.

<P>
You MUST generate either RSA or DSA key pairs for SSHv2 using the <TT>-t rsa</TT>
or <TT>-t dsa</TT> command line switch.

<P>
The <TT>ssh-keygen</TT> utility allows you to specify the key size for RSA with
the default of 2048 bits. If you select a different key size, you MUST
use either 1024 bits or 3072 bits.

<P>
You MUST keep the private key part stored in <SPAN  CLASS="textit"><TT>~</TT>/.ssh/id_dsa</SPAN> or
<SPAN  CLASS="textit"><TT>~</TT>/.ssh/id_rsa</SPAN> inaccessible to any other user. This file must be treated
similarly to a password. It is strongly RECOMMENDED that you protect that
key with a passphrase using <TT>ssh-keygen</TT>.

<P>
The following command line is an example that generates a DSA key
with 1024 bit key size:

<P>
<PRE>
        ssh-keygen -t dsa -C "John Doe's key"
</PRE>

<P>
The command asks you for a passphrase where you SHOULD provide a strong
passphrase.

<P>
After the generation of the key pair, you MAY copy the file <SPAN  CLASS="textit"><TT>~</TT>/.ssh/id_dsa.pub</SPAN>
or <SPAN  CLASS="textit"><TT>~</TT>/.ssh/id_rsa.pub</SPAN> to your server system and append it to the file
<SPAN  CLASS="textit"><TT>~</TT>/.ssh/authorized_keys</SPAN>. Create that file if it does not exist and ensure
that its permission prevents others from accessing this file. More information
can be found in <SPAN  CLASS="textit">sshd</SPAN>(8) section "AUTHORIZED_KEYS FILE FORMAT".

<P>
In case you fail to meet the above mentioned requirements, your account
protection may be weakened. This can be considered similar to choosing
a weak password or fail to keep the password confidential.

<P>
Please note that using the key-based authentication is not subject to the
account locking mechanism enforced for passwords.

<P>

<H1><A NAME="SECTION00850000000000000000"></A><A NAME="Access_control_for_files_and_directories"></A><A NAME="1587"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">5</SPAN> Access control for files and directories
</H1>

<P>
Linux is a multiuser operating system, and it is essential that the
system can enforce confidentiality and integrity of user data. For
this purpose, the operating system implements access control policies
that provide rules for reading and writing data.

<P>
Note that the administrators (root) are able to override these
permissions and access all files on the system. Use of encryption is
RECOMMENDED for additional protection of sensitive data.

<P>

<H2><A NAME="SECTION00851000000000000000"></A><A NAME="Discretionary_Access_Control"></A><A NAME="1589"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">1</SPAN> Discretionary Access Control
</H2>

<P>
You can control which other users will be able to read or modify your
files by setting the Unix permission bits and user/group IDs, or (if
more precise control is needed) by using POSIX-style access control
lists (ACLs). This is referred to as discretionary access control
(DAC).

<P>
The 'umask' setting controls the permissions of newly created files and
directories and specifies the access bits that will be <SPAN  CLASS="textit">removed</SPAN> from new
objects. Ensure that the setting is appropriate, and never grant write access
to others by default. The umask MUST include at least the 002 bit (no write
access for others), and the RECOMMENDED setting is 027 (read-only and execute
access for the group, no access at all for others). The default configuration
is even more strict as it sets 077 (accessible to the owner only).

<P>
Do not set up world-writable areas in the filesystem - if you want to share
files in a controlled manner with a fixed group of other users (such as a project
group), please contact your administrator and request the creation of a user
group for that purpose.

<P>
Programs can be configured to run with the access rights of the
program file's owner and/or group instead of the rights of the calling
user. This is the SUID/SGID mechanism, which utilities such as
<SPAN  CLASS="textit">passwd</SPAN>(1) use to be able to access security-critical files. You
could also create your own SUID/SGID programs via <SPAN  CLASS="textit">chmod</SPAN>(1), but DO
NOT do that unless you fully understand the security implications -
you would be giving away <SPAN  CLASS="textit">your</SPAN> access privileges to whoever launches
the SUID program. Please refer to the "Secure Programming HOWTO" in
the unlikely case that you need to create such a program, there you
will find explanations of the many aspects that must be considered,
such as the risk of unintended shell escapes, buffer overflows,
resource exhaustion attacks and many other factors. Note that SUID
root programs MUST NOT be added to the evaluated configuration, the
only permitted use of the SUID bit is for setting non-root user IDs.

<P>

<H2><A NAME="SECTION00852000000000000000"></A><A NAME="Multilevel_mandatory_access_control_MLS_mode_only_"></A><A NAME="1595"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">2</SPAN> Multilevel mandatory access control (MLS mode only)
</H2>

<P>
The system can enforce additional restrictions on operations. When the
system is in MLS mode, it enforces mandatory access control (MAC) to
ensure that all data and user processes are labeled and that
information flow is possible only according to rules based on these
labels. The rules are "mandatory" since you cannot voluntarily give
read access to other users for data if that would violate the
information flow rules.

<P>
Users can be cleared to operate at multiple different MLS levels, but
each interactive session has a single effective level. A MLS level
consists of a hierarchical component (for example "s0" or "s4") and
zero or more categories separated by commas. Contiguous categories can
be abbreviated with the first and last category separated by a period
("."). A sample MLS level specification is "s2:c2,c5.c7,c9",
equivalent to "s2:c2,c5,c6,c7,c9".

<P>
You MAY use the following methods to select an MLS level and
categories for your interactive session:

<P>

<UL>
<LI><P>
At a login prompt (for example on a serial terminal), you will be
prompted interactively for the desired role and MLS level.

<P>
</LI>
<LI><P>
Run <TT>newrole -l</TT> to launch a new shell running at a different level
from within the current session, for example:

<P>
<PRE>
        newrole -l s2:c1,c3.c5
</PRE>

<P>
This functionality is restricted to secure terminal types listed in
the <SPAN  CLASS="textit">/etc/selinux/mls/contexts/securetty_types</SPAN> file, and is not
supported for pseudoterminals as used in <SPAN  CLASS="textit">ssh</SPAN> sessions.

<P>
</LI>
<LI><P>
When labeled networking is active, you MUST specify the correct port
number for the label aware sshd instance when this number is different
from 22, for example:

<P>
<PRE>
        ssh -p 222 user@rhel5.example.com
</PRE>

<P>
When labeled networking is disabled, <SPAN  CLASS="textit">ssh</SPAN> supports selecting a role
and level when logging in, using the <SPAN  CLASS="textit">user/role/mlslevel@host</SPAN> syntax,
for example:

<P>
<PRE>
        ssh jdoe/staff_r/s2:c0,c1@rhel5.example.com
</PRE>
</LI>
</UL>

<P>
Administrators MAY use the <SPAN  CLASS="textit">chcon -l</SPAN>(1) command to change the MLS
labels for objects, this is NOT permitted for regular users. Please
contact an administrator if you believe that data objects are
incorrectly labeled.

<P>
The <SPAN  CLASS="textit">chcat</SPAN>(8) program is NOT supported in the evaluated
configuration and is disabled. It is intended for use with the
Multi-Category System (MCS) security policy which is distinct from the
MLS policy. The MCS policy is beyond the scope of this guide and
evaluation.

<P>

<H2><A NAME="SECTION00853000000000000000"></A><A NAME="Role-based_access_control_MLS_mode_only_"></A><A NAME="1612"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">3</SPAN> Role-based access control (MLS mode only)
</H2>

<P>
In addition, in MLS mode, the system supports role-based access
control (RBAC) to further restrict access according to
administrator-defined rules. Permissions are based on roles assigned
to users, and you may have the option of choosing from several roles
when logging in to the system, or by using the <SPAN  CLASS="textit">newrole -r ROLE</SPAN>
command. You are only able to choose a role from the set of roles that
the system administrator has assigned for your use, and you will use a
default role when you do not select one explicitly. Please contact
your system administrator for further information about which roles
are available and what the corresponding access rights and
restrictions are.

<P>
Roles are defined via types and access to types. A "type" is a
security attribute given to an object or a process. The type of a
process is commonly called a "domain". Policy rules define how domains
may interact with objects and with other domains.

<P>
Permissions to perform actions are delegated to specific roles. In
addition the system supports types that can be associated with objects
and domains that can be associated with processes. Roles are defined
by the domains they have access to. A predefined policy file, which is
part of the system configuration, defines the rules between domains
and types.

<P>
You MAY use the <SPAN  CLASS="textit">chcon -t</SPAN> command to change the SELinux type of
objects which can grant permission to specific roles to access the
object. You are limited to selecting from a small number of allowed
types for this purpose, the tool will reject attempts to change to
restricted types. Your system administrator will explain the types
available for this purpose. For example, in the default configuration,
you MAY switch between the <SPAN  CLASS="textit">user_home_t</SPAN> and <SPAN  CLASS="textit">user_home_ssh_t</SPAN>
types:

<P>
<PRE>
        chcon -t user_home_t FILE
        chcon -t user_home_ssh_t FILE
</PRE>

<P>
(This example is not useful since the default configuration does not
define user roles with granular permissions. Additional types will be
available when your system administrator has defined additional roles
and the corresponding types.)

<P>

<H2><A NAME="SECTION00854000000000000000"></A><A NAME="General_access_control"></A><A NAME="1620"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">5</SPAN>.<SPAN CLASS="arabic">4</SPAN> General access control
</H2>

<P>
Access is permitted only if all policies (DAC, MAC, and RBAC) agree in
permitting the access.

<P>
Always remember that <SPAN  CLASS="textbf">you</SPAN> are responsible for the security of the data you
create and use. Choose permissions that match the protection goals appropriate
for the content, and that correspond to your organization's security policy.
Access to confidential data MUST be on a need-to-know basis, do not
make data world-readable unless the information is intended to be public.

<P>
Whenever you start a program or script, it will execute with your
access rights. This implies that a malicious program would be able to
read and modify all files that you have access to. Never execute any
code that you have received from untrustworthy sources, and do not run
commands that you do not understand. Be aware that manipulations to
the environment a program is run in can also cause security flaws,
such as leaking sensitive information. Do not use the shell variables
LD_LIBRARY_PATH or LD_PRELOAD that modify the shared library
configuration used by dynamically linked programs unless the specific
settings are approved by the administrator or your organizational
policies.

<P>
Please refer to the <SPAN  CLASS="textit">chmod</SPAN>(1), <SPAN  CLASS="textit">umask</SPAN>(2), <SPAN  CLASS="textit">chown</SPAN>(1), <SPAN  CLASS="textit">chgrp</SPAN>(1),
<SPAN  CLASS="textit">acl</SPAN>(5), <SPAN  CLASS="textit">getfacl</SPAN>(1), and <SPAN  CLASS="textit">setfacl</SPAN>(1) manual pages for information, or
any of the many available books covering Linux security (cf. Appendix
'Literature'), or ask your system administrator for advice.

<P>

<H1><A NAME="SECTION00860000000000000000"></A><A NAME="Data_import_export"></A><A NAME="1630"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">6</SPAN> Data import / export
</H1>

<P>
The system comes with various tools to archive data (<SPAN  CLASS="textit">tar</SPAN>,
<SPAN  CLASS="textit">cpio</SPAN>). If ACLs or file labels are used, then only <SPAN  CLASS="textit">tar</SPAN> MUST be
used to handle the files and directories as the other commands do not
support ACLs.  The options <TT>-acl</TT> for ACLs as well as <TT>-selinux</TT>
for MLS lables must be used with <SPAN  CLASS="textit">tar</SPAN>.

<P>
Please see the <SPAN  CLASS="textit">tar</SPAN>(1) man page for more information.

<P>

<H1><A NAME="SECTION00870000000000000000"></A><A NAME="Screen_saver"></A><A NAME="1639"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">7</SPAN> Screen saver
</H1>

<P>
The system is provided with the possibility to lock your terminal. To
unlock the terminal, you MUST provide your password.

<P>
The locking is established using the <TT>screen</TT> application. Depending on
the system configuration, <TT>screen</TT> MAY already be started during login.
If the <TT>screen</TT> application is not started, you may start it manually.

<P>
The <TT>screen</TT> application allows the following two types of screen locking:

<P>

<UL>
<LI><P>
Automated locking of the screen after a period of inactivity on the
terminal defined by a timeout in either <SPAN  CLASS="textit">/etc/screenrc</SPAN> or <SPAN  CLASS="textit"><TT>~</TT>/.screenrc</SPAN>
using the <SPAN  CLASS="textit">lockscreen</SPAN> configuration value.

<P>
</LI>
<LI><P>
Manual locking by executing the <TT>C-a</TT> <TT>C-x</TT> screen key binding combination.

<P>
</LI>
</UL>

<P>
You MAY change the timeout value for locking the session in <SPAN  CLASS="textit"><TT>~</TT>/.screenrc</SPAN>
with the value for <SPAN  CLASS="textit">lockscreen</SPAN>. Note that the administrator MAY disable
the ability to use the <SPAN  CLASS="textit"><TT>~</TT>/.screenrc</SPAN> configuration file.

<P>
If <TT>screen</TT> is not invoked automatically during startup, you MAY
enter the following line to <SPAN  CLASS="textit"><TT>~</TT>/.bash_profile</SPAN>.

<P>
<PRE>
        exec screen
</PRE>
<H1><A NAME="SECTION00880000000000000000"></A><A NAME="Buffer_overflow_hardening"></A><A NAME="1659"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">8</SPAN> Buffer overflow hardening
</H1>

<P>
The system provides hardening techniques for applications
and shared libraries that raises the bar for exploiting buffer overflows
significantly. The following list enumerates the hardening techniques
which are available including the instructions on how to enable them.

<P>

<UL>
<LI><P>
The memory hosting the process stack is marked as not hosting executable code.
This means that the CPU will not execute instructions that are stored on the
stack memory. To enable the functionality globally, file
<SPAN  CLASS="textit">/proc/sys/kernel/exec-shield</SPAN> must contain either a 1 or 2. Either the value
is written into that file directly or the <TT>sysctl</TT> command is used.

<P>
In addition, the application that tries to be covered by the no-execute
stack must obey the following rules. During standard compilation of applications,
the stack execution protection is enabled. To ensure the presence of the
PT_GNU_STACK ELF program header entry and the absence of the PF_X bit in the
p_flags ELF header flags (i.e. the flags that influence the disabling of the
non-executable stack support for a particular application), the following
considerations must be applied by a programmer as any of the following
operations disable the stack execution protection:

<P>

<UL>
<LI><P>
The following linker option must <SPAN  CLASS="textbf">not</SPAN> be used:
<SPAN  CLASS="textit">"-z execstack"</SPAN> (gcc: <SPAN  CLASS="textit">"-Wl,-z,execstack"</SPAN>).

<P>
</LI>
<LI><P>
The following assembler option must <SPAN  CLASS="textbf">not</SPAN> be used:
<SPAN  CLASS="textit">"-execstack"</SPAN> (gcc: <SPAN  CLASS="textit">"-Wa,-execstack"</SPAN>).

<P>
</LI>
<LI><P>
Modifications of an ELF program header entry in an already compiled binary
which change the PT_GNU_STACK and PF_X flags (like using the
<TT>execstack</TT>(8) application) must <SPAN  CLASS="textbf">not</SPAN> be performed.

<P>
</LI>
<LI><P>
The application or library code must not contain trampolines such as nested
functions pushed onto the stack which passed as pointers to functions as this
would also enable the stack execution support.

<P>
</LI>
</UL>

<P>
</LI>
<LI><P>
The kernel applies the concept of address space randomization to applications.
This implies that the offset addresses of symbols in applications and
shared libraries are different for each application invocation. To enable the
functionality globally, file <SPAN  CLASS="textit">/proc/sys/kernel/exec-shield-randomize</SPAN>
must contain a 1. Again, this file contents can be changed by either writing
directly into it or by using the <TT>sysctl</TT> command.

<P>
</LI>
<LI><P>
During load time of an application and its depending shared libraries, the tables
holding the offset information for objects and functions can be marked
read-only. This functionality can be enabled on an application or shared
library base as it is enforced by the program loader rather than the kernel.
This mechanism is called RELRO/PIE and is usable in two different varieties.
The following sections outline the different flavors of RELRO/PIE and outline
the functional difference.

<P>
</LI>
</UL>
<H2><A NAME="SECTION00881000000000000000"></A><A NAME="Full_RELRO_PIE"></A><A NAME="1677"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">8</SPAN>.<SPAN CLASS="arabic">1</SPAN> Full RELRO/PIE
</H2>

<P>
By enabling full RELRO/PIE for an application or shared library, the data pointed
to by the following ELF sections are loaded into read-only memory before the
application gains control over the process: .tdata, .preinit_array, .init_array,
.fini_array, .ctors, .dtors, .jcr, .data.rel.ro, .dynamic, .got including
.got.plt.

<P>
Full RELRO/PIE implies that the offsets of all symbols of an application and
all its libraries are resolved before the application starts executing. A
performance penalty applies compared to uncovered applications as the concept
of lazy binding which is implemented by the loader cannot be used any more.

<P>
In order to enable full RELRO, the ELF program header entry of PT_GNU_RELRO
must be set such that it covers the proper elf sections. To achieve that,
the application must be linked with the provided RHEL linker using the linker
options of <SPAN  CLASS="textit">"-z relro -z now"</SPAN> (using the GCC compiler using the compiler
options of <SPAN  CLASS="textit">"-Wl,-z,relro,-z,now"</SPAN> can be used which are passed to the linker).
In addition, an application must be compiled as PIE with the gcc option of
"-fPIE". Contrary, a shared library must be compiled as PIC with the gcc option
of "-fPIC".

<P>
The ELF header sections listed above are set read-only using the mprotect
system call by the loader before the application gains control. When
exploiting buffer overruns, the attacker cannot modify information in those
memory sections. These sections store offset tables required for the dynamic
linking mechanism and, if abused, allow attackers to modify the jump addresses
of object accesses. Full protection against this type of attack can only be
achieved if the application and all depending shared libraries are compiled
linked with full protection enabled. When at least one shared library the
application depends on or the application itself is compiled and linked with
partial RELRO/PIE protection as discussed in the following section, only partial
protection against this type of attack is available for the given application.
Also, if at least one shared library the application loads does not have
any RELRO protection enabled, the entire runtime environment of the application
cannot considered to have RELRO protection any more as the logic provided
by the uncovered library may provide an attacker a window into cracking
the entire application.

<P>

<H2><A NAME="SECTION00882000000000000000"></A><A NAME="Partial_RELRO_PIE"></A><A NAME="1681"></A>
<BR>
<SPAN CLASS="arabic">7</SPAN>.<SPAN CLASS="arabic">8</SPAN>.<SPAN CLASS="arabic">2</SPAN> Partial RELRO/PIE
</H2>

<P>
The partial RELRO/PIE protection is almost identical to the full RELRO/PIE
protection. The only difference is that the data covered with the ELF section
of .got.plt (i.e. the Procedure Loading Table - PLT) is left in read/write
memory. The user-visible difference is that lazy binding is still available.
Therefore, the linker can employ the concept of lazy binding. On the other hand,
the function offsets maintained with the PLT are not protected against
modification by determined attackers.

<P>
In order to enable partial RELRO, the ELF program header entry of PT_GNU_RELRO
must be set such that it covers the proper elf sections. To achieve that,
the application must be linked with the provided RHEL linker using the linker 
options of <SPAN  CLASS="textit">"-z relro"</SPAN> (using the GCC compiler using the compiler 
options of <SPAN  CLASS="textit">"-Wl,-z,relro"</SPAN> can be used which are passed to the linker). 
In addition, an application must be compiled as PIE with the gcc option of 
"-fPIE". Contrary, a shared library must be compiled as PIC with the gcc option 
of "-fPIC".

<P>

<H1><A NAME="SECTION00900000000000000000"></A><A NAME="Appendix"></A><A NAME="1685"></A>
<BR>
<SPAN CLASS="arabic">8</SPAN>. Appendix
</H1>

<H1><A NAME="SECTION00910000000000000000"></A><A NAME="Online_Documentation"></A><A NAME="1687"></A>
<BR>
<SPAN CLASS="arabic">8</SPAN>.<SPAN CLASS="arabic">1</SPAN> Online Documentation
</H1>

<P>
If there are conflicting recommendations in this guide and in one of the
sources listed here, the Configuration Guide has precedence concerning the evaluated
configuration.

<P>
RHEL6 Guidance: <SPAN  CLASS="textit">http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/index.html</SPAN>

<P>
David A. Wheeler, "Secure Programming for Linux and Unix HOWTO",
<SPAN  CLASS="textit">http://tldp.org/HOWTO/Secure-Programs-HOWTO/</SPAN>

<P>
Kevin Fenzi, Dave Wreski, "Linux Security HOWTO",
<SPAN  CLASS="textit">http://tldp.org/HOWTO/Security-HOWTO/</SPAN>

<P>

<H1><A NAME="SECTION00920000000000000000"></A><A NAME="Literature"></A><A NAME="1692"></A>
<BR>
<SPAN CLASS="arabic">8</SPAN>.<SPAN CLASS="arabic">2</SPAN> Literature
</H1>

<P>
Frank Mayer, Karl MacMillan, David Caplan, "SELinux by Example: Using Security Enhanced Linux", Prentice Hall 2006, ISBN 0131963694

<P>
Ellen Siever, Stephen Spainhour, Stephen Figgins, &amp; Jessica P. Hekman,
"Linux in a Nutshell, 6rd Edition", O'Reilly 2009, ISBN 978-0596154486

<P>
W. Richard Stevens, "Advanced Programming in the UNIX(R) Environment",
Addison-Wesley 1992, ISBN 0201563177

<P>
<BR><HR>
<ADDRESS>
Stephan Mueller
2012-07-06
</ADDRESS>
</BODY>
</HTML>
